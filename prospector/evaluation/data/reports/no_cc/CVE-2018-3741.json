{
    "advisory_record": {
        "cve_id": "CVE-2018-3741",
        "description": "There is a possible XSS vulnerability in all rails-html-sanitizer gem versions below 1.0.4 for Ruby. The gem allows non-whitelisted attributes to be present in sanitized output when input with specially-crafted HTML fragments, and these attributes can lead to an XSS attack on target applications. This issue is similar to CVE-2018-8048 in Loofah. All users running an affected release should either upgrade or use one of the workarounds immediately.",
        "reserved_timestamp": 1514419200,
        "published_timestamp": 1522436400,
        "updated_timestamp": 1522436221,
        "repository_url": null,
        "references": {
            "": 27,
            "https://access.redhat.com/support/": 10,
            "https://access.redhat.com/downloads/": 8,
            "commit::f3ba1a839a35f2ba7f941c15e239a1cb379d56ae": 6,
            "https://access.redhat.com/errata/": 6,
            "https://access.redhat.com/labs/": 6,
            "https://access.redhat.com/security/security-updates/#/cve": 5,
            "https://access.redhat.com/management/": 4,
            "https://access.redhat.com/": 4,
            "https://access.redhat.com/documentation": 4,
            "https://access.redhat.com/product-life-cycles/": 4,
            "https://access.redhat.com/security": 4,
            "https://access.redhat.com/security/security-updates/#/security-advisories": 4,
            "https://access.redhat.com/support/contact/": 4,
            "https://status.redhat.com": 4,
            "https://access.redhat.com/products/red-hat-enterprise-linux/": 3,
            "https://access.redhat.com/products/red-hat-openshift-container-platform": 3,
            "https://access.redhat.com/products/red-hat-ansible-automation-platform/": 3,
            "https://access.redhat.com/products/": 3,
            "https://access.redhat.com/security/cve/CVE-2018-8048": 2,
            "https://access.redhat.com/security/updates/classification/": 2,
            "https://access.redhat.com/downloads/content/package-browser": 2,
            "https://catalog.redhat.com/software/containers/explore/": 2,
            "https://access.redhat.com/articles/1202803": 2,
            "https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution": 2,
            "https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article": 2,
            "https://access.redhat.com/documentation/en/red_hat_enterprise_linux": 2,
            "https://access.redhat.com/documentation/en/openshift_container_platform": 2,
            "https://access.redhat.com/documentation/en/red_hat_ansible_automation_platform": 2,
            "https://access.redhat.com/documentation/": 2,
            "https://access.redhat.com/security/": 2,
            "https://access.redhat.com/security/vulnerabilities": 2,
            "https://access.redhat.com/security/data": 2,
            "https://access.redhat.com/security/security-updates/#/security-labs": 2,
            "https://access.redhat.com/security/updates/backporting/": 2,
            "https://access.redhat.com/support/cases/": 2,
            "https://access.redhat.com/support/cases/#/troubleshoot": 2,
            "https://access.redhat.com/community": 2,
            "https://access.redhat.com/community/": 2,
            "https://access.redhat.com/discussions/": 2,
            "https://access.redhat.com/announcements/": 2,
            "https://access.redhat.com/accelerators/": 2,
            "https://access.redhat.com/jbossnetwork/restricted/listSoftware.html": 2,
            "https://cloud.redhat.com/insights": 2,
            "https://access.redhat.com/changeLanguage?language=en": 2,
            "https://access.redhat.com/changeLanguage?language=ko": 2,
            "https://access.redhat.com/changeLanguage?language=ja": 2,
            "https://access.redhat.com/changeLanguage?language=zh_CN": 2,
            "https://redhat.com/en": 2,
            "https://twitter.com/RedHat": 2,
            "https://access.redhat.com/management": 2,
            "https://access.redhat.com/support": 2,
            "https://access.redhat.com/support/customer-service": 2,
            "https://access.redhat.com/articles/33844": 2,
            "https://access.redhat.com/help/login_assistance": 2,
            "https://www.redhat.com/en/trust": 2,
            "https://www.redhat.com/en/about/browser-support": 2,
            "https://www.redhat.com/en/about/digital-accessibility": 2,
            "https://access.redhat.com/recognition/": 2,
            "https://access.redhat.com/help/colophon/": 2,
            "https://www.redhat.com/": 2,
            "http://developers.redhat.com/": 2,
            "https://connect.redhat.com/": 2,
            "https://cloud.redhat.com/": 2,
            "https://access.redhat.com/subscription-value": 2,
            "https://www.redhat.com/about/": 2,
            "http://jobs.redhat.com": 2,
            "https://redhat.com/en/about/company": 2,
            "https://redhat.com/en/jobs": 2,
            "https://redhat.com/en/events": 2,
            "https://redhat.com/en/about/office-locations": 2,
            "https://redhat.com/en/contact": 2,
            "https://redhat.com/en/blog": 2,
            "https://redhat.com/en/about/our-culture/diversity-equity-inclusion": 2,
            "https://coolstuff.redhat.com/": 2,
            "https://www.redhat.com/en/summit": 2,
            "https://redhat.com/en/about/privacy-policy": 2,
            "https://redhat.com/en/about/terms-use": 2,
            "https://redhat.com/en/about/all-policies-guidelines": 2,
            "https://redhat.com/en/about/digital-accessibility": 2,
            "https://access.redhat.com/changeLanguage?language=fr": 1,
            "https://access.redhat.com/products/red-hat-satellite/": 1,
            "https://access.redhat.com/products/red-hat-subscription-management/": 1,
            "https://access.redhat.com/products/red-hat-insights/": 1,
            "https://access.redhat.com/products/red-hat-openstack-platform/": 1,
            "https://access.redhat.com/products/red-hat-openshift-container-platform/": 1,
            "https://access.redhat.com/products/red-hat-openshift-ai/": 1,
            "https://access.redhat.com/products/openshift-dedicated-red-hat/": 1,
            "https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/": 1,
            "https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/": 1,
            "https://access.redhat.com/products/red-hat-quay/": 1,
            "https://access.redhat.com/products/red-hat-openshift-dev-spaces": 1,
            "https://access.redhat.com/products/red-hat-openshift-service-aws": 1,
            "https://access.redhat.com/products/red-hat-storage/": 1,
            "https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/": 1,
            "https://access.redhat.com/products/red-hat-ceph-storage/": 1,
            "https://access.redhat.com/products/red-hat-openshift-data-foundation": 1,
            "https://access.redhat.com/products/red-hat-runtimes/": 1,
            "https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/": 1,
            "https://access.redhat.com/products/red-hat-data-grid/": 1,
            "https://access.redhat.com/products/red-hat-jboss-web-server/": 1,
            "https://access.redhat.com/products/red-hat-build-of-keycloak/": 1,
            "https://access.redhat.com/products/spring-boot/": 1,
            "https://access.redhat.com/products/nodejs/": 1,
            "https://access.redhat.com/products/quarkus/": 1,
            "https://access.redhat.com/products/red-hat-application-foundations/": 1,
            "https://access.redhat.com/products/red-hat-fuse/": 1,
            "https://access.redhat.com/products/red-hat-amq/": 1,
            "https://access.redhat.com/products/red-hat-3scale/": 1,
            "https://www.first.org/cvss/user-guide": 1,
            "https://access.redhat.com/security/cve/CVE-2019-9213": 1,
            "https://access.redhat.com/security/cve/CVE-2019-18634": 1,
            "https://access.redhat.com/security/cve/CVE-2020-11023": 1,
            "https://access.redhat.com/security/cve/CVE-2019-15031": 1,
            "https://access.redhat.com/security/cve/CVE-2018-1125": 1,
            "https://access.redhat.com/security/cve/CVE-2020-14060": 1,
            "https://nvd.nist.gov/vuln-metrics/cvss": 1,
            "https://access.redhat.com/site/security/team/contact/": 1
        },
        "affected_products": [
            "Loofah",
            "rails-html-sanitizer",
            "XSS",
            "Ruby"
        ],
        "versions": {
            "status": "affected",
            "version": "<= 1.0.3"
        },
        "files": [
            "HTML",
            "rails-html-sanitizer",
            "CVE-2018-8048",
            "non-whitelisted",
            "XSS",
            "specially-crafted"
        ],
        "keywords": [
            "workaround",
            "attribute",
            "issue",
            "attack",
            "loofah",
            "release",
            "ruby",
            "lead",
            "craft",
            "input",
            "vulnerability",
            "target",
            "user",
            "html",
            "sanitizer",
            "upgrade",
            "allow",
            "sanitize",
            "fragment",
            "application",
            "output",
            "rail",
            "version"
        ],
        "files_extension": [],
        "has_fixing_commit": true
    },
    "commits": [
        {
            "commit_id": "f3ba1a839a35f2ba7f941c15e239a1cb379d56ae",
            "repository": "https://github.com/rails/rails-html-sanitizer",
            "timestamp": 1521660236,
            "hunks": 5,
            "message": "Make sure we address CVE-2018-8048 Even that the issue was fixed on loofah we have our own logic to scrub attributes so when the whitelist serializer is used the issue was still present. Fix CVE-2018-3741.",
            "diff": [
                "diff --git a/lib/rails/html/scrubbers.rb b/lib/rails/html/scrubbers.rb",
                "index 57c4034..42436f4 100644",
                "--- a/lib/rails/html/scrubbers.rb",
                "+++ b/lib/rails/html/scrubbers.rb",
                "@@ -155,2 +155,4 @@ module Rails",
                "         node.remove_attribute(attr_node.name) if attr_name == 'src' && attr_node.value !~ /[^[:space:]]/",
                "+",
                "+        Loofah::HTML5::Scrub.force_correct_attribute_escaping! node",
                "       end",
                "diff --git a/rails-html-sanitizer.gemspec b/rails-html-sanitizer.gemspec",
                "index 698ff4b..e774244 100644",
                "--- a/rails-html-sanitizer.gemspec",
                "+++ b/rails-html-sanitizer.gemspec",
                "@@ -19,3 +19,3 @@ Gem::Specification.new do |spec|",
                "-  spec.add_dependency \"loofah\", \"~> 2.0\"",
                "+  spec.add_dependency \"loofah\", \"~> 2.2\", \">= 2.2.2\"",
                "diff --git a/test/sanitizer_test.rb b/test/sanitizer_test.rb",
                "index 9651c94..7bcab6f 100644",
                "--- a/test/sanitizer_test.rb",
                "+++ b/test/sanitizer_test.rb",
                "@@ -387,3 +387,3 @@ class SanitizersTest < Minitest::Test",
                "     raw      = %(display:block; position:absolute; left:0; top:0; width:100%; height:100%; z-index:1; background-color:black; background-image:url(http://www.ragingplatypus.com/i/cam-full.jpg); background-x:center; background-y:center; background-repeat:repeat;)",
                "-    expected = %(display: block; width: 100%; height: 100%; background-color: black; background-x: center; background-y: center;)",
                "+    expected = %(display:block;width:100%;height:100%;background-color:black;background-x:center;background-y:center;)",
                "     assert_equal expected, sanitize_css(raw)",
                "@@ -393,3 +393,3 @@ class SanitizersTest < Minitest::Test",
                "     raw = \"display:block; \"",
                "-    expected = \"display: block;\"",
                "+    expected = \"display:block;\"",
                "     assert_equal expected, sanitize_css(raw)",
                "@@ -486,2 +486,34 @@ class SanitizersTest < Minitest::Test",
                "+  def test_uri_escaping_of_href_attr_in_a_tag_in_white_list_sanitizer",
                "+    html = %{<a href='examp<!--\" unsafeattr=foo()>-->le.com'>test</a>}",
                "+",
                "+    text = white_list_sanitize(html)",
                "+",
                "+    assert_equal %{<a href=\"examp<!--%22%20unsafeattr=foo()>-->le.com\">test</a>}, text",
                "+  end",
                "+",
                "+  def test_uri_escaping_of_src_attr_in_a_tag_in_white_list_sanitizer",
                "+    html = %{<a src='examp<!--\" unsafeattr=foo()>-->le.com'>test</a>}",
                "+",
                "+    text = white_list_sanitize(html)",
                "+",
                "+    assert_equal %{<a src=\"examp<!--%22%20unsafeattr=foo()>-->le.com\">test</a>}, text",
                "+  end",
                "+",
                "+  def test_uri_escaping_of_name_attr_in_a_tag_in_white_list_sanitizer",
                "+    html = %{<a name='examp<!--\" unsafeattr=foo()>-->le.com'>test</a>}",
                "+",
                "+    text = white_list_sanitize(html)",
                "+",
                "+    assert_equal %{<a name=\"examp<!--%22%20unsafeattr=foo()>-->le.com\">test</a>}, text",
                "+  end",
                "+",
                "+  def test_uri_escaping_of_name_action_in_a_tag_in_white_list_sanitizer",
                "+    html = %{<a action='examp<!--\" unsafeattr=foo()>-->le.com'>test</a>}",
                "+",
                "+    text = white_list_sanitize(html, attributes: ['action'])",
                "+",
                "+    assert_equal %{<a action=\"examp<!--%22%20unsafeattr=foo()>-->le.com\">test</a>}, text",
                "+  end",
                "+",
                " protected"
            ],
            "changed_files": [
                "lib/rails/html/scrubbers.rb",
                "rails-html-sanitizer.gemspec",
                "test/sanitizer_test.rb"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [
                "CVE-2018-8048",
                "CVE-2018-3741"
            ],
            "twins": [],
            "tags": [
                "v1.0.4",
                "v1.1.0",
                "v1.2.0",
                "v1.3.0",
                "v1.4.0",
                "v1.4.1",
                "v1.4.2",
                "v1.4.3",
                "v1.4.4",
                "v1.5.0",
                "v1.6.0",
                "v1.6.0.rc1",
                "v1.6.0.rc2"
            ],
            "matched_rules": [
                {
                    "id": "COMMIT_IN_REFERENCE",
                    "message": "This commit is mentioned 6 times in the references.",
                    "relevance": 64
                },
                {
                    "id": "RELEVANT_WORDS_IN_MESSAGE",
                    "message": "The commit message contains some relevant words: CVE-2018-8048",
                    "relevance": 8
                },
                {
                    "id": "CHANGES_RELEVANT_CODE",
                    "message": "The commit modifies code containing relevant filename or methods: HTML",
                    "relevance": 8
                },
                {
                    "id": "CHANGES_RELEVANT_FILES",
                    "message": "The commit changes some relevant files: rails-html-sanitizer.gemspec, lib/rails/html/scrubbers.rb",
                    "relevance": 8
                },
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: loofah, attribute, issue",
                    "relevance": 4
                }
            ]
        },
        {
            "commit_id": "53bf066ac3a163546a9c7c44c30998c21068c42d",
            "repository": "https://github.com/rails/rails-html-sanitizer",
            "timestamp": 1521744814,
            "hunks": 1,
            "message": "Prepare to 1.0.4 release",
            "diff": [
                "diff --git a/lib/rails/html/sanitizer/version.rb b/lib/rails/html/sanitizer/version.rb",
                "index 4ee6184..9a815d6 100644",
                "--- a/lib/rails/html/sanitizer/version.rb",
                "+++ b/lib/rails/html/sanitizer/version.rb",
                "@@ -3,3 +3,3 @@ module Rails",
                "     class Sanitizer",
                "-      VERSION = \"1.0.3\"",
                "+      VERSION = \"1.0.4\"",
                "     end"
            ],
            "changed_files": [
                "lib/rails/html/sanitizer/version.rb"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "v1.0.4",
                "v1.1.0",
                "v1.2.0",
                "v1.3.0",
                "v1.4.0",
                "v1.4.1",
                "v1.4.2",
                "v1.4.3",
                "v1.4.4",
                "v1.5.0",
                "v1.6.0",
                "v1.6.0.rc1",
                "v1.6.0.rc2"
            ],
            "matched_rules": [
                {
                    "id": "CHANGES_RELEVANT_FILES",
                    "message": "The commit changes some relevant files: lib/rails/html/sanitizer/version.rb",
                    "relevance": 8
                },
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: release",
                    "relevance": 4
                },
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: version",
                    "relevance": 4
                }
            ]
        },
        {
            "commit_id": "fc5fd28cc74ad525243f4fe464e8089c99db7d83",
            "repository": "https://github.com/rails/rails-html-sanitizer",
            "timestamp": 1522174235,
            "hunks": 0,
            "message": "Merge pull request #71 from nicolasleger/patch-1 [CI] Test against Ruby 2.5",
            "diff": [],
            "changed_files": [],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "71": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "v1.1.0",
                "v1.2.0",
                "v1.3.0",
                "v1.4.0",
                "v1.4.1",
                "v1.4.2",
                "v1.4.3",
                "v1.4.4",
                "v1.5.0",
                "v1.6.0",
                "v1.6.0.rc1",
                "v1.6.0.rc2"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: ruby",
                    "relevance": 4
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 71",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "e4e6cabeafa2a032e24f06e251d127d10d2cf9fa",
            "repository": "https://github.com/rails/rails-html-sanitizer",
            "timestamp": 1522148555,
            "hunks": 1,
            "message": "[CI] Allow failure with ruby head",
            "diff": [
                "diff --git a/.travis.yml b/.travis.yml",
                "index 7c5da59..be7c3d2 100644",
                "--- a/.travis.yml",
                "+++ b/.travis.yml",
                "@@ -17,2 +17,3 @@ matrix:",
                "   allow_failures:",
                "+  - rvm: ruby-head",
                "   - rvm: jruby"
            ],
            "changed_files": [
                ".travis.yml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "v1.1.0",
                "v1.2.0",
                "v1.3.0",
                "v1.4.0",
                "v1.4.1",
                "v1.4.2",
                "v1.4.3",
                "v1.4.4",
                "v1.5.0",
                "v1.6.0",
                "v1.6.0.rc1",
                "v1.6.0.rc2"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: ruby, allow",
                    "relevance": 4
                }
            ]
        },
        {
            "commit_id": "4ccc7742d8cbd95e620887d60b802a1d9a83d424",
            "repository": "https://github.com/rails/rails-html-sanitizer",
            "timestamp": 1522147431,
            "hunks": 1,
            "message": "[CI] Test against Ruby 2.5",
            "diff": [
                "diff --git a/.travis.yml b/.travis.yml",
                "index d514f0f..7c5da59 100644",
                "--- a/.travis.yml",
                "+++ b/.travis.yml",
                "@@ -8,5 +8,6 @@ rvm:",
                "   - 2.1.10",
                "-  - 2.2.6",
                "-  - 2.3.3",
                "-  - 2.4.0",
                "+  - 2.2.9",
                "+  - 2.3.6",
                "+  - 2.4.3",
                "+  - 2.5.0",
                "   - ruby-head"
            ],
            "changed_files": [
                ".travis.yml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "v1.1.0",
                "v1.2.0",
                "v1.3.0",
                "v1.4.0",
                "v1.4.1",
                "v1.4.2",
                "v1.4.3",
                "v1.4.4",
                "v1.5.0",
                "v1.6.0",
                "v1.6.0.rc1",
                "v1.6.0.rc2"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: ruby",
                    "relevance": 4
                }
            ]
        }
    ]
}
