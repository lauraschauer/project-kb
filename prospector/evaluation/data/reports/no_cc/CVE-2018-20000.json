{
    "advisory_record": {
        "cve_id": "CVE-2018-20000",
        "description": "Apereo Bedework bw-webdav before 4.0.3 allows XXE attacks, as demonstrated by an invite-reply document that reads a local file, related to webdav/servlet/common/MethodBase.java and webdav/servlet/common/PostRequestPars.java.",
        "reserved_timestamp": 1664755200,
        "published_timestamp": 1664814125,
        "updated_timestamp": 1664814125,
        "repository_url": null,
        "references": {
            "": 209,
            "commit::00409c8b99900fbb55d64db570323d65879239c1": 7,
            "https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax": 4,
            "https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment": 4,
            "https://github.com/Bedework/bw-webdav/pull/1": 3,
            "https://github.com/Bedework/bw-webdav/compare/bw-webdav-4.0.2...bw-webdav-4.0.3": 2,
            "https://github.com/features/actions": 2,
            "https://github.com/features/packages": 2,
            "https://github.com/features/security": 2,
            "https://github.com/features/codespaces": 2,
            "https://github.com/features/copilot": 2,
            "https://github.com/features/code-review": 2,
            "https://github.com/features/issues": 2,
            "https://github.com/features/discussions": 2,
            "https://github.com/features": 2,
            "https://docs.github.com": 2,
            "https://skills.github.com": 2,
            "https://github.blog": 2,
            "https://github.com/enterprise": 2,
            "https://github.com/team": 2,
            "https://github.com/enterprise/startups": 2,
            "https://github.com/solutions/industries/healthcare": 2,
            "https://github.com/solutions/industries/financial-services": 2,
            "https://github.com/solutions/industries/manufacturing": 2,
            "https://github.com/solutions/ci-cd": 2,
            "https://github.com/solutions/devops": 2,
            "https://github.com/solutions/devsecops": 2,
            "https://resources.github.com/learn/pathways": 2,
            "https://resources.github.com": 2,
            "https://github.com/customer-stories": 2,
            "https://partner.github.com": 2,
            "https://github.com/readme": 2,
            "https://github.com/topics": 2,
            "https://github.com/trending": 2,
            "https://github.com/collections": 2,
            "https://github.com/enterprise/advanced-security": 2,
            "https://github.com/pricing": 2,
            "https://github.com": 2,
            "https://docs.github.com/site-policy/github-terms/github-terms-of-service": 2,
            "https://docs.github.com/site-policy/privacy-policies/github-privacy-statement": 2,
            "https://github.com/security": 2,
            "https://www.githubstatus.com/": 2,
            "https://docs.github.com/": 2,
            "https://support.github.com?tags=dotcom-footer": 2,
            "https://docs.github.com/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons": 2,
            "https://docs.github.com/terms": 1,
            "https://docs.github.com/privacy": 1,
            "https://github.co/hiddenchars": 1,
            "http://mvnvm.org/": 1,
            "https://github.com/Bedework/bw-webdav/pull/1#event-1992762045": 1,
            "https://github.com/Bedework/bw-webdav/compare/Bedework:b2c8997...Bedework:72daff7": 1
        },
        "affected_products": [
            "n/a",
            "Apereo",
            "Bedework",
            "XXE"
        ],
        "versions": {
            "status": "affected",
            "version": "n/a"
        },
        "files": [
            "bw-webdav",
            "invite-reply",
            "MethodBase",
            "PostRequestPars",
            "XXE"
        ],
        "keywords": [
            "servlet",
            "demonstrate",
            "document",
            "relate",
            "reply",
            "read",
            "file",
            "bedework",
            "webdav",
            "invite",
            "attack",
            "allow",
            "apereo"
        ],
        "files_extension": [
            "java"
        ],
        "has_fixing_commit": true
    },
    "commits": [
        {
            "commit_id": "00409c8b99900fbb55d64db570323d65879239c1",
            "repository": "https://github.com/Bedework/bw-webdav",
            "timestamp": 1542838872,
            "hunks": 1,
            "message": "ignore intellij idea files",
            "diff": [
                "diff --git a/.gitignore b/.gitignore",
                "index a3e764a..1be54bc 100644",
                "--- a/.gitignore",
                "+++ b/.gitignore",
                "@@ -4 +4,3 @@",
                " target",
                "+.idea",
                "+*.iml"
            ],
            "changed_files": [
                ".gitignore"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "5.0.0",
                "5.0.1",
                "bw-webdav-4.0.10",
                "bw-webdav-4.0.11",
                "bw-webdav-4.0.12",
                "bw-webdav-4.0.13",
                "bw-webdav-4.0.3",
                "bw-webdav-4.0.4",
                "bw-webdav-4.0.5",
                "bw-webdav-4.0.6",
                "bw-webdav-4.0.7",
                "bw-webdav-4.0.8",
                "bw-webdav-4.0.9"
            ],
            "matched_rules": [
                {
                    "id": "COMMIT_IN_REFERENCE",
                    "message": "This commit is mentioned 7 times in the references.",
                    "relevance": 64
                },
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: file",
                    "relevance": 4
                }
            ]
        },
        {
            "commit_id": "ccb87c2757bab531c53faf0637ee342a378caa7f",
            "repository": "https://github.com/Bedework/bw-webdav",
            "timestamp": 1543419061,
            "hunks": 0,
            "message": "Merge pull request #1 from viqueen/secure-xml secure xml",
            "diff": [],
            "changed_files": [],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "1": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "5.0.0",
                "5.0.1",
                "bw-webdav-4.0.10",
                "bw-webdav-4.0.11",
                "bw-webdav-4.0.12",
                "bw-webdav-4.0.13",
                "bw-webdav-4.0.3",
                "bw-webdav-4.0.4",
                "bw-webdav-4.0.5",
                "bw-webdav-4.0.6",
                "bw-webdav-4.0.7",
                "bw-webdav-4.0.8",
                "bw-webdav-4.0.9"
            ],
            "matched_rules": [
                {
                    "id": "XREF_GH",
                    "message": "The commit and the advisory (including referenced pages) mention the same github issue: 1",
                    "relevance": 32
                },
                {
                    "id": "SEC_KEYWORDS_IN_MESSAGE",
                    "message": "The commit message contains some security-related keywords: secure",
                    "relevance": 4
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 1",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "cd51e67093ef7f01003878a44f31bc0b2a0d73d1",
            "repository": "https://github.com/Bedework/bw-webdav",
            "timestamp": 1542840927,
            "hunks": 3,
            "message": "secure-xml: update method base to rely on secure xml parser",
            "diff": [
                "diff --git a/src/main/java/org/bedework/webdav/servlet/common/MethodBase.java b/src/main/java/org/bedework/webdav/servlet/common/MethodBase.java",
                "index 547b402..0a7b780 100644",
                "--- a/src/main/java/org/bedework/webdav/servlet/common/MethodBase.java",
                "+++ b/src/main/java/org/bedework/webdav/servlet/common/MethodBase.java",
                "@@ -58,3 +58,3 @@ import javax.xml.ws.Holder;",
                "  */",
                "-public abstract class MethodBase extends Logged {",
                "+public abstract class MethodBase extends Logged implements SecureXml {",
                "   protected boolean dumpContent;",
                "@@ -360,4 +360,4 @@ public abstract class MethodBase extends Logged {",
                "    *",
                "-   * @param len        Content length",
                "-   * @param rdr        Reader",
                "+   * @param contentLength        Content length",
                "+   * @param reader        Reader",
                "    * @return Document  Parsed body or null for no body",
                "@@ -365,25 +365,4 @@ public abstract class MethodBase extends Logged {",
                "    */",
                "-  protected Document parseContent(final int len,",
                "-                                  final Reader rdr) throws WebdavException{",
                "-    if (len == 0) {",
                "-      return null;",
                "-    }",
                "-",
                "-    if (rdr == null) {",
                "-      // No content?",
                "-      return null;",
                "-    }",
                "-",
                "-    try {",
                "-      DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();",
                "-      factory.setNamespaceAware(true);",
                "-",
                "-      DocumentBuilder builder = factory.newDocumentBuilder();",
                "-",
                "-      return builder.parse(new InputSource(rdr));",
                "-    } catch (SAXException e) {",
                "-      throw new WebdavBadRequest();",
                "-    } catch (Throwable t) {",
                "-      throw new WebdavException(t);",
                "-    }",
                "+  protected Document parseContent(final int contentLength, final Reader reader) throws WebdavException{",
                "+    return parseXmlSafely(contentLength, reader);",
                "   }"
            ],
            "changed_files": [
                "src/main/java/org/bedework/webdav/servlet/common/MethodBase.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "5.0.0",
                "5.0.1",
                "bw-webdav-4.0.10",
                "bw-webdav-4.0.11",
                "bw-webdav-4.0.12",
                "bw-webdav-4.0.13",
                "bw-webdav-4.0.3",
                "bw-webdav-4.0.4",
                "bw-webdav-4.0.5",
                "bw-webdav-4.0.6",
                "bw-webdav-4.0.7",
                "bw-webdav-4.0.8",
                "bw-webdav-4.0.9"
            ],
            "matched_rules": [
                {
                    "id": "CHANGES_RELEVANT_CODE",
                    "message": "The commit modifies code containing relevant filename or methods: MethodBase",
                    "relevance": 8
                },
                {
                    "id": "CHANGES_RELEVANT_FILES",
                    "message": "The commit changes some relevant files: src/main/java/org/bedework/webdav/servlet/common/MethodBase.java",
                    "relevance": 8
                },
                {
                    "id": "SEC_KEYWORDS_IN_MESSAGE",
                    "message": "The commit message contains some security-related keywords: secure",
                    "relevance": 4
                },
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: servlet, bedework",
                    "relevance": 4
                }
            ]
        },
        {
            "commit_id": "67283fb8b9609acdb1a8d2e7fefe195b4a261062",
            "repository": "https://github.com/Bedework/bw-webdav",
            "timestamp": 1542840380,
            "hunks": 7,
            "message": "secure-xml: welcome secure xml interface providing a safe parser",
            "diff": [
                "diff --git a/src/main/java/org/bedework/webdav/servlet/common/PostRequestPars.java b/src/main/java/org/bedework/webdav/servlet/common/PostRequestPars.java",
                "index 77574fb..5d9f753 100644",
                "--- a/src/main/java/org/bedework/webdav/servlet/common/PostRequestPars.java",
                "+++ b/src/main/java/org/bedework/webdav/servlet/common/PostRequestPars.java",
                "@@ -21,3 +21,2 @@ package org.bedework.webdav.servlet.common;",
                " import org.bedework.util.misc.Util;",
                "-import org.bedework.webdav.servlet.shared.WebdavBadRequest;",
                " import org.bedework.webdav.servlet.shared.WebdavException;",
                "@@ -26,4 +25,2 @@ import org.bedework.webdav.servlet.shared.WebdavNsIntf;",
                " import org.w3c.dom.Document;",
                "-import org.xml.sax.InputSource;",
                "-import org.xml.sax.SAXException;",
                "@@ -32,4 +29,2 @@ import java.io.Reader;",
                " import javax.servlet.http.HttpServletRequest;",
                "-import javax.xml.parsers.DocumentBuilder;",
                "-import javax.xml.parsers.DocumentBuilderFactory;",
                "@@ -37,3 +32,3 @@ import javax.xml.parsers.DocumentBuilderFactory;",
                "  */",
                "-public class PostRequestPars {",
                "+public class PostRequestPars implements SecureXml {",
                "   private final HttpServletRequest req;",
                "@@ -128,3 +123,3 @@ public class PostRequestPars {",
                "-    xmlDoc = parseXml(reqRdr);",
                "+    xmlDoc = parseXmlSafely(req.getContentLength(), reqRdr);",
                "     getTheReader = false;",
                "@@ -218,27 +213,3 @@ public class PostRequestPars {",
                "   }",
                "-",
                "-  /**",
                "-   * @param rdr for xml content",
                "-   * @return parsed Document",
                "-   * @throws WebdavException",
                "-   */",
                "-  private Document parseXml(final Reader rdr) throws WebdavException{",
                "-    if (rdr == null) {",
                "-      return null;",
                "-    }",
                "-",
                "-    try {",
                "-      final DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();",
                "-      factory.setNamespaceAware(true);",
                "-",
                "-      final DocumentBuilder builder = factory.newDocumentBuilder();",
                "-",
                "-      return builder.parse(new InputSource(rdr));",
                "-    } catch (final SAXException e) {",
                "-      throw new WebdavBadRequest();",
                "-    } catch (final Throwable t) {",
                "-      throw new WebdavException(t);",
                "-    }",
                "-  }",
                "-",
                "+  ",
                "   /**",
                "diff --git a/src/main/java/org/bedework/webdav/servlet/common/SecureXml.java b/src/main/java/org/bedework/webdav/servlet/common/SecureXml.java",
                "new file mode 100644",
                "index 0000000..a188a16",
                "--- /dev/null",
                "+++ b/src/main/java/org/bedework/webdav/servlet/common/SecureXml.java",
                "@@ -0,0 +1,42 @@",
                "+package org.bedework.webdav.servlet.common;",
                "+",
                "+import org.bedework.webdav.servlet.shared.WebdavBadRequest;",
                "+import org.bedework.webdav.servlet.shared.WebdavException;",
                "+import org.w3c.dom.Document;",
                "+import org.xml.sax.InputSource;",
                "+import org.xml.sax.SAXException;",
                "+",
                "+import javax.xml.parsers.DocumentBuilder;",
                "+import javax.xml.parsers.DocumentBuilderFactory;",
                "+import java.io.Reader;",
                "+",
                "+public interface SecureXml {",
                "+",
                "+    default Document parseXmlSafely(final int contentLength, final Reader reader) throws WebdavException {",
                "+        if (contentLength == 0) {",
                "+            return null;",
                "+        }",
                "+",
                "+        if (reader == null) {",
                "+            // No content?",
                "+            return null;",
                "+        }",
                "+",
                "+        try {",
                "+            DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();",
                "+            factory.setNamespaceAware(false);",
                "+            factory.setFeature(\"http://javax.xml.XMLConstants/feature/secure-processing\", true);",
                "+            factory.setFeature(\"http://xml.org/sax/features/external-general-entities\", false);",
                "+            factory.setFeature(\"http://xml.org/sax/features/external-parameter-entities\", false);",
                "+            factory.setAttribute(\"http://apache.org/xml/features/nonvalidating/load-external-dtd\", false);",
                "+",
                "+            DocumentBuilder builder = factory.newDocumentBuilder();",
                "+",
                "+            return builder.parse(new InputSource(reader));",
                "+        } catch (SAXException exception) {",
                "+            throw new WebdavBadRequest(exception.getMessage());",
                "+        } catch (Throwable t) {",
                "+            throw new WebdavException(t);",
                "+        }",
                "+    }",
                "+}"
            ],
            "changed_files": [
                "src/main/java/org/bedework/webdav/servlet/common/PostRequestPars.java",
                "src/main/java/org/bedework/webdav/servlet/common/SecureXml.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "5.0.0",
                "5.0.1",
                "bw-webdav-4.0.10",
                "bw-webdav-4.0.11",
                "bw-webdav-4.0.12",
                "bw-webdav-4.0.13",
                "bw-webdav-4.0.3",
                "bw-webdav-4.0.4",
                "bw-webdav-4.0.5",
                "bw-webdav-4.0.6",
                "bw-webdav-4.0.7",
                "bw-webdav-4.0.8",
                "bw-webdav-4.0.9"
            ],
            "matched_rules": [
                {
                    "id": "CHANGES_RELEVANT_CODE",
                    "message": "The commit modifies code containing relevant filename or methods: PostRequestPars",
                    "relevance": 8
                },
                {
                    "id": "CHANGES_RELEVANT_FILES",
                    "message": "The commit changes some relevant files: src/main/java/org/bedework/webdav/servlet/common/PostRequestPars.java",
                    "relevance": 8
                },
                {
                    "id": "SEC_KEYWORDS_IN_MESSAGE",
                    "message": "The commit message contains some security-related keywords: secure",
                    "relevance": 4
                },
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: servlet, bedework",
                    "relevance": 4
                }
            ]
        },
        {
            "commit_id": "f5bfca62523884a8b5fd56e9c4d257c1797670fd",
            "repository": "https://github.com/Bedework/bw-webdav",
            "timestamp": 1543419862,
            "hunks": 10,
            "message": "Update pom dependencies to prepare for release. Add attribution.",
            "diff": [
                "diff --git a/bw-webdav.iml b/bw-webdav.iml",
                "index 6b303e2..7608b2b 100644",
                "--- a/bw-webdav.iml",
                "+++ b/bw-webdav.iml",
                "@@ -17,10 +17,10 @@",
                "     <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: org.objenesis:objenesis:2.1\" level=\"project\" />",
                "-    <orderEntry type=\"library\" name=\"Maven: org.bedework:bw-util-misc:4.0.18\" level=\"project\" />",
                "-    <orderEntry type=\"library\" name=\"Maven: org.bedework:bw-util-xml:4.0.18\" level=\"project\" />",
                "-    <orderEntry type=\"library\" name=\"Maven: org.bedework:bw-util-servlet:4.0.18\" level=\"project\" />",
                "-    <orderEntry type=\"library\" name=\"Maven: org.bedework:bw-util-config:4.0.18\" level=\"project\" />",
                "-    <orderEntry type=\"library\" name=\"Maven: org.bedework:bw-util-jmx:4.0.18\" level=\"project\" />",
                "-    <orderEntry type=\"library\" name=\"Maven: com.fasterxml.jackson.core:jackson-databind:2.3.1\" level=\"project\" />",
                "-    <orderEntry type=\"library\" name=\"Maven: com.fasterxml.jackson.core:jackson-annotations:2.3.0\" level=\"project\" />",
                "-    <orderEntry type=\"library\" name=\"Maven: com.fasterxml.jackson.core:jackson-core:2.3.1\" level=\"project\" />",
                "+    <orderEntry type=\"library\" name=\"Maven: org.bedework:bw-util-misc:4.0.19\" level=\"project\" />",
                "+    <orderEntry type=\"library\" name=\"Maven: org.bedework:bw-util-xml:4.0.19\" level=\"project\" />",
                "+    <orderEntry type=\"library\" name=\"Maven: org.bedework:bw-util-servlet:4.0.19\" level=\"project\" />",
                "+    <orderEntry type=\"library\" name=\"Maven: org.bedework:bw-util-config:4.0.19\" level=\"project\" />",
                "+    <orderEntry type=\"library\" name=\"Maven: org.bedework:bw-util-jmx:4.0.19\" level=\"project\" />",
                "+    <orderEntry type=\"library\" name=\"Maven: com.fasterxml.jackson.core:jackson-databind:2.9.6\" level=\"project\" />",
                "+    <orderEntry type=\"library\" name=\"Maven: com.fasterxml.jackson.core:jackson-annotations:2.9.0\" level=\"project\" />",
                "+    <orderEntry type=\"library\" name=\"Maven: com.fasterxml.jackson.core:jackson-core:2.9.6\" level=\"project\" />",
                "     <orderEntry type=\"library\" name=\"Maven: org.bedework:bw-access:4.0.2\" level=\"project\" />",
                "diff --git a/pom.xml b/pom.xml",
                "index 41d8320..1a25207 100644",
                "--- a/pom.xml",
                "+++ b/pom.xml",
                "@@ -17,3 +17,3 @@",
                "     <bw-access.version>4.0.2</bw-access.version>",
                "-    <bw-util.version>4.0.18</bw-util.version>",
                "+    <bw-util.version>4.0.19</bw-util.version>",
                "@@ -22,10 +22,4 @@",
                " \t\t<apache-http.version>4.2.2</apache-http.version>",
                "-\t\t<hibernate.version>3.6.9.Final</hibernate.version>",
                "-\t\t<derby.version>10.8.2.2</derby.version>",
                "-\t\t<h2.version>1.2.130</h2.version>",
                " \t\t<servlet-api.version>2.5</servlet-api.version>",
                "-\t\t<jtidy.version>4aug2000r7-dev</jtidy.version>",
                "-\t\t<struts.version>1.3.10</struts.version>",
                " \t\t<junit.version>4.8.2</junit.version>",
                "-\t\t<ical4j.version>head-20100601</ical4j.version>",
                " \t\t<log4j.version>1.2.15</log4j.version>",
                "@@ -86,16 +80,16 @@",
                "-\t<dependencies>",
                "-        <dependency>",
                "-            <groupId>junit</groupId>",
                "-            <artifactId>junit</artifactId>",
                "-            <version>4.12</version>",
                "-            <scope>test</scope>",
                "-        </dependency>",
                "-        <dependency>",
                "-            <groupId>org.mockito</groupId>",
                "-            <artifactId>mockito-core</artifactId>",
                "-            <version>1.10.19</version>",
                "-            <scope>test</scope>",
                "-        </dependency>",
                "-\t\t<!-- Bedework Dependencies -->",
                "+  <dependencies>",
                "+    <dependency>",
                "+      <groupId>junit</groupId>",
                "+      <artifactId>junit</artifactId>",
                "+      <version>4.12</version>",
                "+      <scope>test</scope>",
                "+    </dependency>",
                "+    <dependency>",
                "+      <groupId>org.mockito</groupId>",
                "+      <artifactId>mockito-core</artifactId>",
                "+      <version>1.10.19</version>",
                "+      <scope>test</scope>",
                "+    </dependency>",
                "+    <!-- Bedework Dependencies -->",
                "     <dependency>",
                "diff --git a/src/main/java/org/bedework/webdav/servlet/common/SecureXml.java b/src/main/java/org/bedework/webdav/servlet/common/SecureXml.java",
                "index 0fea29a..23ae156 100644",
                "--- a/src/main/java/org/bedework/webdav/servlet/common/SecureXml.java",
                "+++ b/src/main/java/org/bedework/webdav/servlet/common/SecureXml.java",
                "@@ -4,2 +4,3 @@ import org.bedework.webdav.servlet.shared.WebdavBadRequest;",
                " import org.bedework.webdav.servlet.shared.WebdavException;",
                "+",
                " import org.w3c.dom.Document;",
                "@@ -8,8 +9,11 @@ import org.xml.sax.SAXException;",
                "+import java.io.Reader;",
                "+",
                " import javax.xml.parsers.DocumentBuilder;",
                " import javax.xml.parsers.DocumentBuilderFactory;",
                "-import java.io.Reader;",
                "+/**",
                "+ * Contributed by https://github.com/viqueen",
                "+ */",
                " public interface SecureXml {",
                "-",
                "   default Document parseXmlSafely(final int contentLength, final Reader reader) throws WebdavException {"
            ],
            "changed_files": [
                "bw-webdav.iml",
                "pom.xml",
                "src/main/java/org/bedework/webdav/servlet/common/SecureXml.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "5.0.0",
                "5.0.1",
                "bw-webdav-4.0.10",
                "bw-webdav-4.0.11",
                "bw-webdav-4.0.12",
                "bw-webdav-4.0.13",
                "bw-webdav-4.0.3",
                "bw-webdav-4.0.4",
                "bw-webdav-4.0.5",
                "bw-webdav-4.0.6",
                "bw-webdav-4.0.7",
                "bw-webdav-4.0.8",
                "bw-webdav-4.0.9"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: servlet, bedework",
                    "relevance": 4
                }
            ]
        },
        {
            "commit_id": "ae4469faacd00db5708c81ea273883cb526475b9",
            "repository": "https://github.com/Bedework/bw-webdav",
            "timestamp": 1543407338,
            "hunks": 1,
            "message": "Revert \"ignore intellij idea files\" This reverts commit 00409c8b99900fbb55d64db570323d65879239c1.",
            "diff": [
                "diff --git a/.gitignore b/.gitignore",
                "index 1be54bc..a3e764a 100644",
                "--- a/.gitignore",
                "+++ b/.gitignore",
                "@@ -4,3 +4 @@",
                " target",
                "-.idea",
                "-*.iml"
            ],
            "changed_files": [
                ".gitignore"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "5.0.0",
                "5.0.1",
                "bw-webdav-4.0.10",
                "bw-webdav-4.0.11",
                "bw-webdav-4.0.12",
                "bw-webdav-4.0.13",
                "bw-webdav-4.0.3",
                "bw-webdav-4.0.4",
                "bw-webdav-4.0.5",
                "bw-webdav-4.0.6",
                "bw-webdav-4.0.7",
                "bw-webdav-4.0.8",
                "bw-webdav-4.0.9"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: file",
                    "relevance": 4
                }
            ]
        },
        {
            "commit_id": "d2ab4d586e8f31fa6ef6d124d909c5e6735bbf75",
            "repository": "https://github.com/Bedework/bw-webdav",
            "timestamp": 1542840197,
            "hunks": 4,
            "message": "secure-xml: welcome test to highlight the xxe vulnerability",
            "diff": [
                "diff --git a/bw-webdav.iml b/bw-webdav.iml",
                "index cd1d001..6b303e2 100644",
                "--- a/bw-webdav.iml",
                "+++ b/bw-webdav.iml",
                "@@ -7,2 +7,4 @@",
                "       <sourceFolder url=\"file://$MODULE_DIR$/src/main/java\" isTestSource=\"false\" />",
                "+      <sourceFolder url=\"file://$MODULE_DIR$/src/test/java\" isTestSource=\"true\" />",
                "+      <sourceFolder url=\"file://$MODULE_DIR$/src/test/resources\" type=\"java-test-resource\" />",
                "       <excludeFolder url=\"file://$MODULE_DIR$/target\" />",
                "@@ -11,2 +13,6 @@",
                "     <orderEntry type=\"sourceFolder\" forTests=\"false\" />",
                "+    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: junit:junit:4.12\" level=\"project\" />",
                "+    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: org.hamcrest:hamcrest-core:1.3\" level=\"project\" />",
                "+    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: org.mockito:mockito-core:1.10.19\" level=\"project\" />",
                "+    <orderEntry type=\"library\" scope=\"TEST\" name=\"Maven: org.objenesis:objenesis:2.1\" level=\"project\" />",
                "     <orderEntry type=\"library\" name=\"Maven: org.bedework:bw-util-misc:4.0.18\" level=\"project\" />",
                "@@ -21,3 +27,2 @@",
                "     <orderEntry type=\"library\" name=\"Maven: org.bedework:bw-util-caching:4.0.18\" level=\"project\" />",
                "-    <orderEntry type=\"library\" name=\"Maven: junit:junit:4.8.2\" level=\"project\" />",
                "     <orderEntry type=\"library\" name=\"Maven: log4j:log4j:1.2.15\" level=\"project\" />",
                "diff --git a/pom.xml b/pom.xml",
                "index 914140f..41d8320 100644",
                "--- a/pom.xml",
                "+++ b/pom.xml",
                "@@ -87,2 +87,14 @@",
                " \t<dependencies>",
                "+        <dependency>",
                "+            <groupId>junit</groupId>",
                "+            <artifactId>junit</artifactId>",
                "+            <version>4.12</version>",
                "+            <scope>test</scope>",
                "+        </dependency>",
                "+        <dependency>",
                "+            <groupId>org.mockito</groupId>",
                "+            <artifactId>mockito-core</artifactId>",
                "+            <version>1.10.19</version>",
                "+            <scope>test</scope>",
                "+        </dependency>",
                " \t\t<!-- Bedework Dependencies -->"
            ],
            "changed_files": [
                "bw-webdav.iml",
                "pom.xml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "5.0.0",
                "5.0.1",
                "bw-webdav-4.0.10",
                "bw-webdav-4.0.11",
                "bw-webdav-4.0.12",
                "bw-webdav-4.0.13",
                "bw-webdav-4.0.3",
                "bw-webdav-4.0.4",
                "bw-webdav-4.0.5",
                "bw-webdav-4.0.6",
                "bw-webdav-4.0.7",
                "bw-webdav-4.0.8",
                "bw-webdav-4.0.9"
            ],
            "matched_rules": [
                {
                    "id": "SEC_KEYWORDS_IN_MESSAGE",
                    "message": "The commit message contains some security-related keywords: vulnerability, xxe",
                    "relevance": 4
                }
            ]
        },
        {
            "commit_id": "0ce2007b3515a23b5f287ef521300bcb1f748edc",
            "repository": "https://github.com/Bedework/bw-webdav",
            "timestamp": 1543407634,
            "hunks": 3,
            "message": "format: follow the repo code style, and welcome mvnvm props to manage maven versions",
            "diff": [
                "diff --git a/mvnvm.properties b/mvnvm.properties",
                "new file mode 100644",
                "index 0000000..f6c4228",
                "--- /dev/null",
                "+++ b/mvnvm.properties",
                "@@ -0,0 +1 @@",
                "+mvn_version=3.5.4",
                "diff --git a/src/main/java/org/bedework/webdav/servlet/common/SecureXml.java b/src/main/java/org/bedework/webdav/servlet/common/SecureXml.java",
                "index a188a16..0fea29a 100644",
                "--- a/src/main/java/org/bedework/webdav/servlet/common/SecureXml.java",
                "+++ b/src/main/java/org/bedework/webdav/servlet/common/SecureXml.java",
                "@@ -14,29 +14,29 @@ public interface SecureXml {",
                "-    default Document parseXmlSafely(final int contentLength, final Reader reader) throws WebdavException {",
                "-        if (contentLength == 0) {",
                "-            return null;",
                "-        }",
                "-",
                "-        if (reader == null) {",
                "-            // No content?",
                "-            return null;",
                "-        }",
                "-",
                "-        try {",
                "-            DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();",
                "-            factory.setNamespaceAware(false);",
                "-            factory.setFeature(\"http://javax.xml.XMLConstants/feature/secure-processing\", true);",
                "-            factory.setFeature(\"http://xml.org/sax/features/external-general-entities\", false);",
                "-            factory.setFeature(\"http://xml.org/sax/features/external-parameter-entities\", false);",
                "-            factory.setAttribute(\"http://apache.org/xml/features/nonvalidating/load-external-dtd\", false);",
                "-",
                "-            DocumentBuilder builder = factory.newDocumentBuilder();",
                "-",
                "-            return builder.parse(new InputSource(reader));",
                "-        } catch (SAXException exception) {",
                "-            throw new WebdavBadRequest(exception.getMessage());",
                "-        } catch (Throwable t) {",
                "-            throw new WebdavException(t);",
                "-        }",
                "+  default Document parseXmlSafely(final int contentLength, final Reader reader) throws WebdavException {",
                "+    if (contentLength == 0) {",
                "+      return null;",
                "     }",
                "+",
                "+    if (reader == null) {",
                "+      // No content?",
                "+      return null;",
                "+    }",
                "+",
                "+    try {",
                "+      DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();",
                "+      factory.setNamespaceAware(false);",
                "+      factory.setFeature(\"http://javax.xml.XMLConstants/feature/secure-processing\", true);",
                "+      factory.setFeature(\"http://xml.org/sax/features/external-general-entities\", false);",
                "+      factory.setFeature(\"http://xml.org/sax/features/external-parameter-entities\", false);",
                "+      factory.setAttribute(\"http://apache.org/xml/features/nonvalidating/load-external-dtd\", false);",
                "+",
                "+      DocumentBuilder builder = factory.newDocumentBuilder();",
                "+",
                "+      return builder.parse(new InputSource(reader));",
                "+    } catch (SAXException exception) {",
                "+      throw new WebdavBadRequest(exception.getMessage());",
                "+    } catch (Throwable t) {",
                "+      throw new WebdavException(t);",
                "+    }",
                "+  }",
                " }"
            ],
            "changed_files": [
                "mvnvm.properties",
                "src/main/java/org/bedework/webdav/servlet/common/SecureXml.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "5.0.0",
                "5.0.1",
                "bw-webdav-4.0.10",
                "bw-webdav-4.0.11",
                "bw-webdav-4.0.12",
                "bw-webdav-4.0.13",
                "bw-webdav-4.0.3",
                "bw-webdav-4.0.4",
                "bw-webdav-4.0.5",
                "bw-webdav-4.0.6",
                "bw-webdav-4.0.7",
                "bw-webdav-4.0.8",
                "bw-webdav-4.0.9"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: servlet, bedework",
                    "relevance": 4
                }
            ]
        },
        {
            "commit_id": "72daff7601766346a29f8f5183e226b4996ee897",
            "repository": "https://github.com/Bedework/bw-webdav",
            "timestamp": 1543419902,
            "hunks": 2,
            "message": "[maven-release-plugin] prepare release bw-webdav-4.0.3",
            "diff": [
                "diff --git a/pom.xml b/pom.xml",
                "index 1a25207..1a1876d 100644",
                "--- a/pom.xml",
                "+++ b/pom.xml",
                "@@ -4,3 +4,3 @@",
                " \t<artifactId>bw-webdav</artifactId>",
                "-\t<version>4.0.3-SNAPSHOT</version>",
                "+\t<version>4.0.3</version>",
                " \t<name>bw-webdav</name>",
                "@@ -43,3 +43,3 @@",
                "     <url>https://github.com/Bedework/bw-webdav</url>",
                "-    <tag>HEAD</tag>",
                "+    <tag>bw-webdav-4.0.3</tag>",
                "   </scm>"
            ],
            "changed_files": [
                "pom.xml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [
                [
                    "no-tag",
                    "3682c15badaaf28150f2812b8df53159a6271ab6"
                ],
                [
                    "no-tag",
                    "25634dd8a60763a4fbe9716baa628b40a595b785"
                ],
                [
                    "no-tag",
                    "577c3c1331ec9d9bc645142afe293bd4b1a6d2d4"
                ]
            ],
            "tags": [
                "5.0.0",
                "5.0.1",
                "bw-webdav-4.0.10",
                "bw-webdav-4.0.11",
                "bw-webdav-4.0.12",
                "bw-webdav-4.0.13",
                "bw-webdav-4.0.3",
                "bw-webdav-4.0.4",
                "bw-webdav-4.0.5",
                "bw-webdav-4.0.6",
                "bw-webdav-4.0.7",
                "bw-webdav-4.0.8",
                "bw-webdav-4.0.9"
            ],
            "matched_rules": [
                {
                    "id": "COMMIT_HAS_TWINS",
                    "message": "This commit has one or more twins.",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "5b948a1eb33426d47d5afdada7033b2c6cdf9310",
            "repository": "https://github.com/Bedework/bw-webdav",
            "timestamp": 1543435877,
            "hunks": 2,
            "message": "[maven-release-plugin] prepare for next development iteration",
            "diff": [
                "diff --git a/pom.xml b/pom.xml",
                "index 5be3960..bfcc5d5 100644",
                "--- a/pom.xml",
                "+++ b/pom.xml",
                "@@ -4,3 +4,3 @@",
                " \t<artifactId>bw-webdav</artifactId>",
                "-\t<version>4.0.4</version>",
                "+\t<version>4.0.5-SNAPSHOT</version>",
                " \t<name>bw-webdav</name>",
                "@@ -43,3 +43,3 @@",
                "     <url>https://github.com/Bedework/bw-webdav</url>",
                "-    <tag>bw-webdav-4.0.4</tag>",
                "+    <tag>bw-webdav-4.0.3</tag>",
                "   </scm>"
            ],
            "changed_files": [
                "pom.xml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [
                [
                    "no-tag",
                    "245afe8a92d9a4e727ac40a06bcf1e72ea78dd23"
                ]
            ],
            "tags": [
                "5.0.0",
                "5.0.1",
                "bw-webdav-4.0.10",
                "bw-webdav-4.0.11",
                "bw-webdav-4.0.12",
                "bw-webdav-4.0.13",
                "bw-webdav-4.0.5",
                "bw-webdav-4.0.6",
                "bw-webdav-4.0.7",
                "bw-webdav-4.0.8",
                "bw-webdav-4.0.9"
            ],
            "matched_rules": [
                {
                    "id": "COMMIT_HAS_TWINS",
                    "message": "This commit has one or more twins.",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "f8643b85363232ec9b97ca62791da81bc12a39dd",
            "repository": "https://github.com/Bedework/bw-webdav",
            "timestamp": 1543435852,
            "hunks": 1,
            "message": "Increment version because release failed",
            "diff": [
                "diff --git a/pom.xml b/pom.xml",
                "index 1a1876d..ec561c7 100644",
                "--- a/pom.xml",
                "+++ b/pom.xml",
                "@@ -4,3 +4,3 @@",
                " \t<artifactId>bw-webdav</artifactId>",
                "-\t<version>4.0.3</version>",
                "+\t<version>4.0.4-SNAPSHOT</version>",
                " \t<name>bw-webdav</name>"
            ],
            "changed_files": [
                "pom.xml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [
                [
                    "no-tag",
                    "42efcb20f93adc23545ca371c403167266be404d"
                ]
            ],
            "tags": [
                "5.0.0",
                "5.0.1",
                "bw-webdav-4.0.10",
                "bw-webdav-4.0.11",
                "bw-webdav-4.0.12",
                "bw-webdav-4.0.13",
                "bw-webdav-4.0.4",
                "bw-webdav-4.0.5",
                "bw-webdav-4.0.6",
                "bw-webdav-4.0.7",
                "bw-webdav-4.0.8",
                "bw-webdav-4.0.9"
            ],
            "matched_rules": [
                {
                    "id": "COMMIT_HAS_TWINS",
                    "message": "This commit has one or more twins.",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "84162ce0b073e415d8605a4c14f39a9da6b83cd4",
            "repository": "https://github.com/Bedework/bw-webdav",
            "timestamp": 1543420481,
            "hunks": 1,
            "message": "[maven-release-plugin] rollback the release of bw-webdav-4.0.3",
            "diff": [
                "diff --git a/pom.xml b/pom.xml",
                "index 6a2b110..1a25207 100644",
                "--- a/pom.xml",
                "+++ b/pom.xml",
                "@@ -4,3 +4,3 @@",
                " \t<artifactId>bw-webdav</artifactId>",
                "-\t<version>4.0.4-SNAPSHOT</version>",
                "+\t<version>4.0.3-SNAPSHOT</version>",
                " \t<name>bw-webdav</name>"
            ],
            "changed_files": [
                "pom.xml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "5.0.0",
                "5.0.1",
                "bw-webdav-4.0.10",
                "bw-webdav-4.0.11",
                "bw-webdav-4.0.12",
                "bw-webdav-4.0.13",
                "bw-webdav-4.0.4",
                "bw-webdav-4.0.5",
                "bw-webdav-4.0.6",
                "bw-webdav-4.0.7",
                "bw-webdav-4.0.8",
                "bw-webdav-4.0.9"
            ],
            "matched_rules": []
        }
    ]
}
