{
    "advisory_record": {
        "cve_id": "CVE-2018-14840",
        "description": "uploads/.htaccess in Subrion CMS 4.2.1 allows XSS because it does not block .html file uploads (but does block, for example, .htm file uploads).",
        "reserved_timestamp": 1533081600,
        "published_timestamp": 1533171600,
        "updated_timestamp": 1533722221,
        "repository_url": null,
        "references": {
            "": 65,
            "commit::cb10ac2294cb2c3a6d2159f9a2bb8c58a2a10a47": 4,
            "https://github.com/intelliants/subrion/issues/773": 3,
            "https://www.exploit-db.com/exploits/45150/": 2,
            "https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax": 2,
            "https://github.com/features/actions": 1,
            "https://github.com/features/packages": 1,
            "https://github.com/features/security": 1,
            "https://github.com/features/codespaces": 1,
            "https://github.com/features/copilot": 1,
            "https://github.com/features/code-review": 1,
            "https://github.com/features/issues": 1,
            "https://github.com/features/discussions": 1,
            "https://github.com/features": 1,
            "https://docs.github.com": 1,
            "https://skills.github.com": 1,
            "https://github.blog": 1,
            "https://github.com/enterprise": 1,
            "https://github.com/team": 1,
            "https://github.com/enterprise/startups": 1,
            "https://github.com/solutions/industries/healthcare": 1,
            "https://github.com/solutions/industries/financial-services": 1,
            "https://github.com/solutions/industries/manufacturing": 1,
            "https://github.com/solutions/ci-cd": 1,
            "https://github.com/solutions/devops": 1,
            "https://github.com/solutions/devsecops": 1,
            "https://resources.github.com/learn/pathways": 1,
            "https://resources.github.com": 1,
            "https://github.com/customer-stories": 1,
            "https://partner.github.com": 1,
            "https://github.com/readme": 1,
            "https://github.com/topics": 1,
            "https://github.com/trending": 1,
            "https://github.com/collections": 1,
            "https://github.com/enterprise/advanced-security": 1,
            "https://github.com/pricing": 1,
            "https://docs.github.com/terms": 1,
            "https://docs.github.com/privacy": 1,
            "commit::b12e287d3814c0f2d0b1892f95fc0190972d2ba5": 1,
            "https://github.com": 1,
            "https://docs.github.com/site-policy/github-terms/github-terms-of-service": 1,
            "https://docs.github.com/site-policy/privacy-policies/github-privacy-statement": 1,
            "https://github.com/security": 1,
            "https://www.githubstatus.com/": 1,
            "https://docs.github.com/": 1,
            "https://support.github.com?tags=dotcom-footer": 1
        },
        "affected_products": [
            "n/a",
            "XSS",
            "Subrion",
            "CMS"
        ],
        "versions": {
            "status": "affected",
            "version": "n/a"
        },
        "files": [
            "XSS",
            "CMS"
        ],
        "keywords": [
            "file",
            "example",
            "upload",
            "block",
            "allow",
            "subrion"
        ],
        "files_extension": [],
        "has_fixing_commit": true
    },
    "commits": [
        {
            "commit_id": "b12e287d3814c0f2d0b1892f95fc0190972d2ba5",
            "repository": "https://github.com/intelliants/subrion",
            "timestamp": 1533110438,
            "hunks": 3,
            "message": "Resolves #773",
            "diff": [
                "diff --git a/uploads/.htaccess b/uploads/.htaccess",
                "index bb5c70fb..52358fd5 100644",
                "--- a/uploads/.htaccess",
                "+++ b/uploads/.htaccess",
                "@@ -10,3 +10,3 @@ Options -ExecCGI",
                " # Deny files access for some file extensions",
                "-<FilesMatch \"(?i)\\.(php|php5|php4|php3|php2|phtml|pl|py|jsp|asp|htm|shtml|sh|cgi)$\">",
                "+<FilesMatch \"(?i)\\.(php|php5|php4|php3|php2|phtml|pl|py|jsp|asp|htm|html|shtml|sh|cgi)$\">",
                "     ForceType text/plain",
                "@@ -17,2 +17,2 @@ Options -ExecCGI",
                " # Process script files as plain text",
                "-AddHandler default-handler .php .php5 .php4 .php3 .php2 .phtml .pl .py .jsp .asp .htm .shtml .sh .cgi",
                "\\ No newline at end of file",
                "+AddHandler default-handler .php .php5 .php4 .php3 .php2 .phtml .pl .py .jsp .asp .htm .shtml .sh .cgi"
            ],
            "changed_files": [
                "uploads/.htaccess"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "773": "Subrion allows to upload malicious file with 'xhtml' extension. #840"
            },
            "cve_refs": [],
            "twins": [],
            "tags": [],
            "matched_rules": [
                {
                    "id": "XREF_GH",
                    "message": "The commit and the advisory (including referenced pages) mention the same github issue: 773",
                    "relevance": 32
                },
                {
                    "id": "COMMIT_IN_REFERENCE",
                    "message": "This commit is mentioned 1 times in the references.",
                    "relevance": 64
                },
                {
                    "id": "SEC_KEYWORDS_IN_LINKED_GH",
                    "message": "The github issue 773 contains some security-related terms: malicious",
                    "relevance": 4
                },
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: upload",
                    "relevance": 4
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 773",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "a33a224c6c9e25144d828f92f6141c719215094b",
            "repository": "https://github.com/intelliants/subrion",
            "timestamp": 1531739587,
            "hunks": 2,
            "message": "Resolves #760. XSS prevented - tooltips are escaped",
            "diff": [
                "diff --git a/admin/templates/default/field-type-content-manage.tpl b/admin/templates/default/field-type-content-manage.tpl",
                "index c7a8ff3a..3901233f 100644",
                "--- a/admin/templates/default/field-type-content-manage.tpl",
                "+++ b/admin/templates/default/field-type-content-manage.tpl",
                "@@ -23,3 +23,3 @@",
                "         {$tooltip = {lang key=\"field_tooltip_{$field.item}_{$field.name}\" default=''}}",
                "-        {if $tooltip}<div class=\"help-block\">{$tooltip}</div>{/if}",
                "+        {if $tooltip}<div class=\"help-block\">{$tooltip|escape}</div>{/if}",
                "     </div>",
                "diff --git a/templates/_common/field-type-content-manage.tpl b/templates/_common/field-type-content-manage.tpl",
                "index 00aeca66..fd2db290 100644",
                "--- a/templates/_common/field-type-content-manage.tpl",
                "+++ b/templates/_common/field-type-content-manage.tpl",
                "@@ -370,3 +370,3 @@ $(function() {",
                "         {assign tooltip {lang key=\"field_tooltip_{$field.item}_{$field.name}\" default=''}}",
                "-        {if $tooltip}<p class=\"help-block help-block--tooltip\">{$tooltip}</p>{/if}",
                "+        {if $tooltip}<p class=\"help-block help-block--tooltip\">{$tooltip|escape}</p>{/if}",
                " </div>"
            ],
            "changed_files": [
                "admin/templates/default/field-type-content-manage.tpl",
                "templates/_common/field-type-content-manage.tpl"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "760": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [],
            "matched_rules": [
                {
                    "id": "RELEVANT_WORDS_IN_MESSAGE",
                    "message": "The commit message contains some relevant words: XSS",
                    "relevance": 8
                },
                {
                    "id": "SEC_KEYWORDS_IN_MESSAGE",
                    "message": "The commit message contains some security-related keywords: xss",
                    "relevance": 4
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 760",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "409a666aee2564f2036af5d7fd0fd163e538c97a",
            "repository": "https://github.com/intelliants/subrion",
            "timestamp": 1531131397,
            "hunks": 7,
            "message": "Added Notification/Tooltip for Admin. Close #723 Added Tooltip and Notification for Admin : in case of configuration enabled(Keep member uploaded images after his removal), Admin will see confirmation messages. ![image](https://user-images.githubusercontent.com/30542757/42444885-23bf6fe8-8393-11e8-8cfe-bdd31af8bf51.png) ![image](https://user-images.githubusercontent.com/30542757/42444838-fded4fb0-8392-11e8-8ed5-bca3391463a3.png) ![image](https://user-images.githubusercontent.com/30542757/42444858-0b9e5bf4-8393-11e8-967d-3e909b4d2f47.png)",
            "diff": [
                "diff --git a/install/dump/install.sql b/install/dump/install.sql",
                "index a81793af..b86a8e2a 100644",
                "--- a/install/dump/install.sql",
                "+++ b/install/dump/install.sql",
                "@@ -948,3 +948,3 @@ INSERT INTO `{install:prefix}config` (`config_group`, `name`, `value`, `multiple",
                " ('members', 'members_per_page', '20', '0', 'text', 4, 1, 0, '{\"wysiwyg\":0,\"code_editor\":0,\"show\":\"members_enabled|1\",\"multilingual\":0}'),",
                "-('members', 'members_keep_uploads', '1', '\\'1\\',\\'0\\'', 'radio', 2, 1, 0, '{\"wysiwyg\":0,\"code_editor\":0,\"show\":\"\",\"multilingual\":0}'),",
                "+('members', 'members_keep_uploads', '1', '\\'1\\',\\'0\\'', 'radio', 2, 0, 0, '{\"wysiwyg\":0,\"code_editor\":0,\"show\":\"\",\"multilingual\":0}'),",
                "@@ -1374,2 +1374,3 @@ INSERT INTO `{install:prefix}language` (`key`,`value`,`category`) VALUES",
                " ('are_you_sure_to_delete_selected_members','Are you sure you want to delete selected members?','admin'),",
                "+('are_you_sure_to_delete_selected_members_and_uploads','<b class = \"text-danger\">All uploaded by selected users files (images, and etc.) will be removed too!</b> <br/> Are you sure you want to delete selected members?','admin'),",
                " ('are_you_sure_to_delete_selected_menus','Are you sure you want to delete selected menus?','admin'),",
                "@@ -1380,2 +1381,3 @@ INSERT INTO `{install:prefix}language` (`key`,`value`,`category`) VALUES",
                " ('are_you_sure_to_delete_this_member','Are you sure you want to delete this member?','admin'),",
                "+('are_you_sure_to_delete_this_member_and_uploads','<b class = \"text-danger\">All uploaded by him files (images, pdfs and etc.) will be removed too!</b> <br/> Are you sure you want to delete this member?','admin'),",
                " ('are_you_sure_to_delete_this_menu','Are you sure you want to delete this menu?','admin'),",
                "@@ -2741,2 +2743,3 @@ INSERT INTO `{install:prefix}language` (`key`,`value`,`category`) VALUES",
                " ('members_autoapproval','Members are activated automatically without administrator confirmation (email confirmation is still needed).','tooltip'),",
                "+('members_keep_uploads','If you enable this configuration, after member removal all uploaded by him content would be saved in /uploads/ folder.','tooltip'),",
                " ('multilingual_field','Allows to have field value in different languages.','tooltip'),",
                "diff --git a/js/admin/members.js b/js/admin/members.js",
                "index 59e0f35d..ec2d15c7 100644",
                "--- a/js/admin/members.js",
                "+++ b/js/admin/members.js",
                "@@ -1,2 +1,11 @@",
                " Ext.onReady(function () {",
                "+",
                "+    if (intelli.config.members_keep_uploads == 0) {",
                "+        var delete_single = 'are_you_sure_to_delete_this_member_and_uploads',",
                "+            delete_multiple = 'are_you_sure_to_delete_selected_members_and_uploads';",
                "+    } else {",
                "+        var delete_single = 'are_you_sure_to_delete_this_member',",
                "+            delete_multiple = 'are_you_sure_to_delete_selected_members';",
                "+    }",
                "+",
                "     var grid = new IntelliGrid(",
                "@@ -54,5 +63,6 @@ Ext.onReady(function () {",
                "             texts: {",
                "-                delete_single: _t('are_you_sure_to_delete_this_member'),",
                "-                delete_multiple: _t('are_you_sure_to_delete_selected_members')",
                "+                delete_single: _t(delete_single),",
                "+                delete_multiple: _t(delete_multiple)",
                "             }",
                "+",
                "         }, false);"
            ],
            "changed_files": [
                "install/dump/install.sql",
                "js/admin/members.js"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "723": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: upload",
                    "relevance": 4
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 723",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "dad111f45fd4341b357c1100b18c01214e177c03",
            "repository": "https://github.com/intelliants/subrion",
            "timestamp": 1533891061,
            "hunks": 1,
            "message": "#776 correct tooltip added for config",
            "diff": [
                "diff --git a/install/dump/install.sql b/install/dump/install.sql",
                "index f4882b17..2810fe59 100644",
                "--- a/install/dump/install.sql",
                "+++ b/install/dump/install.sql",
                "@@ -2733,3 +2733,3 @@ INSERT INTO `{install:prefix}language` (`key`,`value`,`category`) VALUES",
                " ('frontend_footer_code','Injected before closing BODY tag. HTML/JS code allowed.','tooltip'),",
                "-('frontend_show_multilingual_inputs','If enabled inputs will be displayed for each language.','tooltip'),",
                "+('show_multilingual_inputs','If enabled inputs will be displayed for each language.','tooltip'),"
            ],
            "changed_files": [
                "install/dump/install.sql"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "776": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [],
            "matched_rules": [
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 776",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "e0d12d4fd497cd875f5a39c7a5467a7e5fe47c66",
            "repository": "https://github.com/intelliants/subrion",
            "timestamp": 1530526917,
            "hunks": 14,
            "message": "Resolves #721",
            "diff": [
                "diff --git a/includes/classes/ia.core.cache.php b/includes/classes/ia.core.cache.php",
                "index 161a7e50..fd32f940 100644",
                "--- a/includes/classes/ia.core.cache.php",
                "+++ b/includes/classes/ia.core.cache.php",
                "@@ -56,2 +56,3 @@ class iaCache extends abstractUtil",
                "      * @param bool $isObject true - return an object, false - return an array",
                "+     * @param bool $isMultilingual flag for multilingual cache",
                "      *",
                "@@ -59,4 +60,5 @@ class iaCache extends abstractUtil",
                "      */",
                "-    public function get($fileName, $seconds = 0, $isObject = false)",
                "+    public function get($fileName, $seconds = 0, $isObject = false, $isMultilingual = false)",
                "     {",
                "+        $fileName .= ($isMultilingual ? '_' . $this->iaCore->iaView->language : '');",
                "         $this->_setFileName($fileName);",
                "@@ -73,3 +75,3 @@ class iaCache extends abstractUtil",
                "             } else {",
                "-                $this->remove($fileName);",
                "+                $this->remove($fileName, $isMultilingual);",
                "@@ -90,2 +92,3 @@ class iaCache extends abstractUtil",
                "      * @param string $Data data to be written",
                "+     * @param bool $isMultilingual flag for multilingual cache",
                "      *",
                "@@ -93,3 +96,3 @@ class iaCache extends abstractUtil",
                "      */",
                "-    public function write($fileName, $Data)",
                "+    public function write($fileName, $Data, $isMultilingual = false)",
                "     {",
                "@@ -102,2 +105,3 @@ class iaCache extends abstractUtil",
                "+        $fileName .= ($isMultilingual ? '_' . $this->iaCore->iaView->language : '');",
                "         $this->_setFileName($fileName);",
                "@@ -128,2 +132,3 @@ class iaCache extends abstractUtil",
                "      * @param string $fileName file name to be deleted",
                "+     * @param bool $isMultilingual flag for multilingual cache",
                "      *",
                "@@ -131,4 +136,5 @@ class iaCache extends abstractUtil",
                "      */",
                "-    public function remove($fileName)",
                "+    public function remove($fileName, $isMultilingual = false)",
                "     {",
                "+        $fileName .= ($isMultilingual ? '_' . $this->iaCore->iaView->language : '');",
                "         $this->_setFileName($fileName);",
                "diff --git a/includes/classes/ia.core.php b/includes/classes/ia.core.php",
                "index 407178fc..1ad08c6e 100644",
                "--- a/includes/classes/ia.core.php",
                "+++ b/includes/classes/ia.core.php",
                "@@ -375,5 +375,4 @@ final class iaCore",
                "         if (empty($this->config) || $reloadRequired) {",
                "-            $key = 'config_' . $this->iaView->language;",
                "-",
                "-            $this->config = $this->iaCache->get($key, 604800, true);",
                "+            $key = 'config';",
                "+            $this->config = $this->iaCache->get($key, 604800, true, true);",
                "             iaSystem::renderTime('config', 'Cached Configuration Loaded');",
                "@@ -390,3 +389,3 @@ final class iaCore",
                "-                $this->iaCache->write($key, $this->config);",
                "+                $this->iaCache->write($key, $this->config, true);",
                "                 iaSystem::renderTime('config', 'Configuration written to cache file');",
                "diff --git a/includes/classes/ia.front.search.php b/includes/classes/ia.front.search.php",
                "index 71b5fc62..08640c3c 100644",
                "--- a/includes/classes/ia.front.search.php",
                "+++ b/includes/classes/ia.front.search.php",
                "@@ -885,5 +885,5 @@ SQL;",
                "-        $key = 'filter_tree_' . md5($packedNodes) . '_' . $this->iaView->language;",
                "+        $key = 'filter_tree_' . md5($packedNodes);",
                "-        if ($result = $this->iaCore->iaCache->get($key, 25920000, true)) { // 30 days",
                "+        if ($result = $this->iaCore->iaCache->get($key, 25920000, true, true)) { // 30 days",
                "             return $result;",
                "@@ -891,3 +891,3 @@ SQL;",
                "             $result = $this->_parseTreeNodes($itemName, $fieldName, $packedNodes, $this->iaView->language);",
                "-            $this->iaCore->iaCache->write($key, $result);",
                "+            $this->iaCore->iaCache->write($key, $result, true);"
            ],
            "changed_files": [
                "includes/classes/ia.core.cache.php",
                "includes/classes/ia.core.php",
                "includes/classes/ia.front.search.php"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "721": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [],
            "matched_rules": [
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 721",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "cc5e25e2f2c361892fe62a3a36df370257eae329",
            "repository": "https://github.com/intelliants/subrion",
            "timestamp": 1532077258,
            "hunks": 2,
            "message": "Resolves #765",
            "diff": [
                "diff --git a/includes/classes/ia.core.smarty.php b/includes/classes/ia.core.smarty.php",
                "index 11ae96ab..f7d2ed24 100644",
                "--- a/includes/classes/ia.core.smarty.php",
                "+++ b/includes/classes/ia.core.smarty.php",
                "@@ -191,3 +191,3 @@ class iaSmarty extends Smarty",
                "             case 'menu':",
                "-                if ($block['contents']) {",
                "+                if ($block['contents'] || 'account' == $block['name']) {",
                "                     $smarty->assign('menu', $block);",
                "diff --git a/includes/smarty/intelli_plugins/function.ia_menu.php b/includes/smarty/intelli_plugins/function.ia_menu.php",
                "index 7c647782..06f010ad 100644",
                "--- a/includes/smarty/intelli_plugins/function.ia_menu.php",
                "+++ b/includes/smarty/intelli_plugins/function.ia_menu.php",
                "@@ -4,3 +4,3 @@ function smarty_function_ia_menu($params, Smarty_Internal_Template &$smarty)",
                " {",
                "-    if (!isset($params['menus']) || empty($params['menus'])) {",
                "+    if (empty($params['menus']) && empty($params['loginout'])) {",
                "         return '';"
            ],
            "changed_files": [
                "includes/classes/ia.core.smarty.php",
                "includes/smarty/intelli_plugins/function.ia_menu.php"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "765": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [],
            "matched_rules": [
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 765",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "cf2e0cb933e2cd195a6c1a5b487cf7ad9b8dda8e",
            "repository": "https://github.com/intelliants/subrion",
            "timestamp": 1530599676,
            "hunks": 2,
            "message": "Added Status in Search Filter Bar  in Pages (Admin Panel). Close #703 Please, check and merge.",
            "diff": [
                "diff --git a/admin/pages.php b/admin/pages.php",
                "index e396545d..8b5298da 100644",
                "--- a/admin/pages.php",
                "+++ b/admin/pages.php",
                "@@ -33,3 +33,3 @@ class iaBackendController extends iaAbstractControllerBackend",
                "     protected $_gridColumns = ['name', 'status', 'last_updated'];",
                "-    protected $_gridFilters = ['name' => self::LIKE, 'module' => self::EQUAL];",
                "+    protected $_gridFilters = ['name' => self::LIKE, 'module' => self::EQUAL, 'status' => self::EQUAL];",
                "     protected $_gridQueryMainTableAlias = 'p';",
                "diff --git a/js/admin/pages.js b/js/admin/pages.js",
                "index 24fbc3e1..a7a6b148 100644",
                "--- a/js/admin/pages.js",
                "+++ b/js/admin/pages.js",
                "@@ -84,2 +84,12 @@ Ext.onReady(function () {",
                "                     valueField: 'value'",
                "+                },  {",
                "+                    emptyText: _t('status'),",
                "+                    name: 'status',",
                "+                    xtype: 'combo',",
                "+                    typeAhead: true,",
                "+                    editable: false,",
                "+                    store: grid.stores.statuses,",
                "+                    displayField: 'title',",
                "+                    valueField: 'value',",
                "+                    width: 90",
                "                 }, {"
            ],
            "changed_files": [
                "admin/pages.php",
                "js/admin/pages.js"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "703": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [],
            "matched_rules": [
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 703",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "9c18deef32c7e08e23a8bb81874821235257ca0c",
            "repository": "https://github.com/intelliants/subrion",
            "timestamp": 1530111031,
            "hunks": 9,
            "message": "Resolves #738. PHPDoc fixed in iaMailer class. Transaction emails fixed",
            "diff": [
                "diff --git a/includes/classes/ia.core.mailer.php b/includes/classes/ia.core.mailer.php",
                "index 34ac0b6e..2179d924 100644",
                "--- a/includes/classes/ia.core.mailer.php",
                "+++ b/includes/classes/ia.core.mailer.php",
                "@@ -247,2 +247,3 @@ class iaMailer extends PHPMailer",
                "      * @return bool",
                "+     * @throws \\PHPMailer\\PHPMailer\\Exception",
                "      */",
                "@@ -292,2 +293,3 @@ class iaMailer extends PHPMailer",
                "      * @return bool",
                "+     * @throws \\PHPMailer\\PHPMailer\\Exception",
                "      */",
                "diff --git a/includes/classes/ia.core.transaction.php b/includes/classes/ia.core.transaction.php",
                "index a5b77ecf..5fdbc662 100644",
                "--- a/includes/classes/ia.core.transaction.php",
                "+++ b/includes/classes/ia.core.transaction.php",
                "@@ -345,2 +345,4 @@ SQL;",
                "     {",
                "+        $iaMailer = $this->iaCore->factory('mailer');",
                "+",
                "         // first, do check if gateway has its own email submission",
                "@@ -351,8 +353,5 @@ SQL;",
                "         $result1 = true;",
                "-",
                "         $notification = 'transaction_paid';",
                "-        if ($this->iaCore->get($notification)) {",
                "-            $iaUsers = $this->iaCore->factory('users');",
                "-",
                "-            $member = $iaUsers->getById($transaction['member_id']);",
                "+        if ($iaMailer->loadTemplate($notification)) {",
                "+            $member = $this->iaCore->factory('users')->getById($transaction['member_id']);",
                "@@ -362,5 +361,2 @@ SQL;",
                "-            $iaMailer = $this->iaCore->factory('mailer');",
                "-",
                "-            $iaMailer->loadTemplate('transaction_paid');",
                "             $iaMailer->addAddress($member['email']);",
                "@@ -379,6 +375,4 @@ SQL;",
                "         $result2 = true;",
                "-",
                "-        $notification.= '_admin';",
                "-        if ($this->iaCore->get($notification)) {",
                "-            $iaMailer->loadTemplate($notification);",
                "+        $notification .= '_admin';",
                "+        if ($iaMailer->loadTemplate($notification)) {",
                "             $iaMailer->addAddress($this->iaCore->get('site_email'));",
                "diff --git a/includes/classes/ia.core.users.php b/includes/classes/ia.core.users.php",
                "index d7deb925..0b0718c9 100644",
                "--- a/includes/classes/ia.core.users.php",
                "+++ b/includes/classes/ia.core.users.php",
                "@@ -299,3 +299,3 @@ SQL;",
                "-        if ($action && $this->iaCore->get($action)) {",
                "+        if ($action) {",
                "             $condition = $condition ? $condition : \"`id`='{$values['id']}'\";",
                "@@ -304,11 +304,10 @@ SQL;",
                "-            $iaMailer->loadTemplate($action);",
                "-            $body = $iaMailer->Body;",
                "+            if ($iaMailer->loadTemplate($action)) {",
                "+                $members = $this->iaDb->all(['email', 'fullname'], $condition);",
                "+                foreach ($members as $member) {",
                "+                    $iaMailer->addAddress($member['email']);",
                "+                    $iaMailer->setReplacements('fullname', $member['fullname']);",
                "-            $members = $this->iaDb->all(['email', 'fullname'], $condition);",
                "-            foreach ($members as $member) {",
                "-                $iaMailer->addAddress($member['email']);",
                "-                $iaMailer->Body = str_replace('{%FULLNAME%}', $member['fullname'], $body);",
                "-",
                "-                $iaMailer->send();",
                "+                    $iaMailer->send();",
                "+                }",
                "             }"
            ],
            "changed_files": [
                "includes/classes/ia.core.mailer.php",
                "includes/classes/ia.core.transaction.php",
                "includes/classes/ia.core.users.php"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "738": "Resolves #738. PHPDoc fixed in iaMailer class. Transaction emails fixed #740"
            },
            "cve_refs": [],
            "twins": [],
            "tags": [],
            "matched_rules": [
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 738",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "ad70bef6718dd919b6beafadd9094c2511699bce",
            "repository": "https://github.com/intelliants/subrion",
            "timestamp": 1533816244,
            "hunks": 11,
            "message": "Resolves #776",
            "diff": [
                "diff --git a/includes/classes/ia.core.field.php b/includes/classes/ia.core.field.php",
                "index 62ef5442..e8637a1f 100644",
                "--- a/includes/classes/ia.core.field.php",
                "+++ b/includes/classes/ia.core.field.php",
                "@@ -517,5 +517,6 @@ SQL;",
                "                     if ($field['multilingual']) {",
                "-                        $langCode = (iaCore::ACCESS_FRONT == $this->iaCore->getAccessType())",
                "-                            ? $this->iaView->language",
                "-                            : iaLanguage::getMasterLanguage()->code;",
                "+                        $langCode = $this->iaView->language;",
                "+                        if (iaCore::ACCESS_FRONT == $this->iaCore->getAccessType() && $this->iaCore->get('show_multilingual_inputs')) {",
                "+                            $langCode = iaLanguage::getMasterLanguage()->code;",
                "+                        }",
                "@@ -525,3 +526,3 @@ SQL;",
                "-                        if ($field['required'] && !$value) {",
                "+                        if ($field['required'] && empty($value)) {",
                "                             $errors[$fieldName] = iaLanguage::getf('field_is_empty', ['field' => self::getFieldTitle($field['item'], $fieldName)]);",
                "@@ -529,9 +530,5 @@ SQL;",
                "                             foreach ($this->iaCore->languages as $code => $language) {",
                "-                                if (iaCore::ACCESS_FRONT == $this->iaCore->getAccessType()) {",
                "-                                    $string = $value;",
                "-                                } else {",
                "-                                    $string = empty($data[$fieldName][$code]) // copy the master language value if empty",
                "-                                        ? $value",
                "-                                        : $data[$fieldName][$code];",
                "-                                }",
                "+                                $string = empty($data[$fieldName][$code]) // copy the master language value if empty",
                "+                                    ? $value",
                "+                                    : $data[$fieldName][$code];",
                "diff --git a/install/dump/install.sql b/install/dump/install.sql",
                "index 693bbe96..f4882b17 100644",
                "--- a/install/dump/install.sql",
                "+++ b/install/dump/install.sql",
                "@@ -1036,2 +1036,4 @@ INSERT INTO `{install:prefix}config` (`config_group`, `name`, `value`, `multiple",
                " ('miscellaneous', 'maps_api_key', '', '', 'text', 16, 0, 0, '{\"wysiwyg\":0,\"code_editor\":0,\"show\":\"\",\"multilingual\":0}'),",
                "+('miscellaneous', '', 'Content', '', 'divider', 17, 1, 1, ''),",
                "+('miscellaneous', 'show_multilingual_inputs', '0', '\\'1\\',\\'0\\'', 'radio', 18, 0, 1,'{\"wysiwyg\":0,\"code_editor\":0,\"show\":\"\",\"multilingual\":0}'),",
                "@@ -1529,2 +1531,3 @@ INSERT INTO `{install:prefix}language` (`key`,`value`,`category`) VALUES",
                " ('config_maps_api_key', 'Maps API key', 'admin'),",
                "+('config_show_multilingual_inputs', 'Show multilingual inputs', 'admin'),",
                " ('config_currency_switch', 'Currency switching', 'admin'),",
                "@@ -2730,2 +2733,3 @@ INSERT INTO `{install:prefix}language` (`key`,`value`,`category`) VALUES",
                " ('frontend_footer_code','Injected before closing BODY tag. HTML/JS code allowed.','tooltip'),",
                "+('frontend_show_multilingual_inputs','If enabled inputs will be displayed for each language.','tooltip'),",
                "diff --git a/js/frontend/footer.js b/js/frontend/footer.js",
                "index 71ebd9a0..209979aa 100644",
                "--- a/js/frontend/footer.js",
                "+++ b/js/frontend/footer.js",
                "@@ -276,2 +276,31 @@ $(function () {",
                "     });",
                "+",
                "+    $('.js-edit-lang-group').on('click', function () {",
                "+        var $parent = $($(this).data('group')),",
                "+            $group = $parent.find('.translate-group__langs');",
                "+",
                "+        $parent.toggleClass('is-opened').hasClass('is-opened') ? $group.slideDown('fast') : $group.slideUp('fast');",
                "+    });",
                "+",
                "+    $('.js-copy-lang-group').on('click', function () {",
                "+        var $this = $(this);",
                "+",
                "+        if ($this.data('wysiwygEnabled')) {",
                "+            var name = $this.data('name');",
                "+                value = CKEDITOR.instances[name].getData();",
                "+",
                "+            for (var iso in intelli.languages) {",
                "+                if (iso !== intelli.config.lang) {",
                "+                    var ckInstance = CKEDITOR.instances[name + '-' + iso];",
                "+",
                "+                    ckInstance.setData(value);",
                "+                    ckInstance.updateElement();",
                "+                }",
                "+            }",
                "+        } else {",
                "+            var $parent = $($this.data('group')),",
                "+                value = $parent.find('input:first, textarea:first').val();",
                "+            $parent.find('.translate-group__langs input, .translate-group__langs textarea').val(value);",
                "+        }",
                "+    });",
                " });",
                "diff --git a/templates/_common/field-type-content-manage.tpl b/templates/_common/field-type-content-manage.tpl",
                "index 051fd4a2..2233ecff 100644",
                "--- a/templates/_common/field-type-content-manage.tpl",
                "+++ b/templates/_common/field-type-content-manage.tpl",
                "@@ -24,2 +24,8 @@",
                "         {if $field.required}<span class=\"is-required\">*</span>{/if}",
                "+        {if $core.config.show_multilingual_inputs && $field.multilingual && count($core.languages) > 1}",
                "+            <div class=\"btn-group btn-group-xs translate-group-actions\">",
                "+                <button type=\"button\" class=\"btn btn-default js-edit-lang-group\" data-group=\"#language-group-{$fieldName}\"><span class=\"fa fa-globe\"></span></button>",
                "+                <button type=\"button\" class=\"btn btn-default js-copy-lang-group\" data-group=\"#language-group-{$fieldName}\"{if $field.use_editor} data-wysiwyg-enabled=\"true\" data-name=\"{$name}\"{/if}><span class=\"fa fa-copy\"></span></button>",
                "+            </div>",
                "+        {/if}",
                "     </label>",
                "@@ -28,4 +34,43 @@",
                "         {case iaField::TEXT break}",
                "-            {if $field.multilingual && isset($item[\"{$fieldName}_{$core.language.iso}\"])}{$value = $item[\"{$fieldName}_{$core.language.iso}\"]}{/if}",
                "-            <input class=\"form-control\" type=\"text\" name=\"{$fieldName}{if $field.multilingual}[{$core.language.iso}]{/if}\" value=\"{if $value}{$value|escape}{else}{$field.default|escape}{/if}\" id=\"{$name}\" maxlength=\"{$field.length}\">",
                "+            {if $field.multilingual && $core.config.show_multilingual_inputs}",
                "+                {if empty($item[\"{$fieldName}_{$core.masterLanguage.iso}\"])}",
                "+                    {$value = $field.default}",
                "+                {else}",
                "+                    {$value = $item[\"{$fieldName}_{$core.masterLanguage.iso}\"]}",
                "+                {/if}",
                "+                <div class=\"translate-group\" id=\"language-group-{$fieldName}\">",
                "+                    <div class=\"translate-group__default\">",
                "+                        <div class=\"translate-group__item\">",
                "+                            {if count($core.languages) > 1}",
                "+                                <div class=\"translate-group__item__code\">{$core.masterLanguage.title|escape}</div>",
                "+                            {/if}",
                "+                            <input type=\"text\" name=\"{$fieldName}[{$core.masterLanguage.iso}]\" id=\"{$name}\" class=\"form-control\"",
                "+                                value=\"{$value|escape}\" maxlength=\"{$field.length}\">",
                "+                        </div>",
                "+                    </div>",
                "+                    <div class=\"translate-group__langs\">",
                "+                        {foreach $core.languages as $iso => $language}",
                "+                            {if $iso == $core.masterLanguage.code}",
                "+                                {continue}",
                "+                            {/if}",
                "+",
                "+                            {if empty($item[\"{$fieldName}_{$iso}\"])}",
                "+                                {$value = $field.default}",
                "+                            {else}",
                "+                                {$value = $item[\"{$fieldName}_{$iso}\"]}",
                "+                            {/if}",
                "+                            <div class=\"translate-group__item\">",
                "+                                <span class=\"translate-group__item__code\">{$language.title|escape}</span>",
                "+                                <input type=\"text\" name=\"{$fieldName}[{$iso}]\" id=\"{$name}-{$iso}\" class=\"form-control\"",
                "+                                    value=\"{$value|escape}\" maxlength=\"{$field.length}\">",
                "+                            </div>",
                "+                        {/foreach}",
                "+                    </div>",
                "+                </div>",
                "+            {else}",
                "+                {if $field.multilingual && isset($item[\"{$fieldName}_{$core.language.iso}\"])}",
                "+                    {$value = $item[\"{$fieldName}_{$core.language.iso}\"]}",
                "+                {/if}",
                "+                <input class=\"form-control\" type=\"text\" name=\"{$fieldName}{if $field.multilingual}[{$core.language.iso}]{/if}\" value=\"{if $value}{$value|escape}{else}{$field.default|escape}{/if}\" id=\"{$name}\" maxlength=\"{$field.length}\">",
                "+            {/if}",
                "@@ -41,5 +86,81 @@",
                "         {case iaField::TEXTAREA break}",
                "-            {if $field.multilingual && isset($item[\"{$fieldName}_{$core.language.iso}\"])}{$value = $item[\"{$fieldName}_{$core.language.iso}\"]}{/if}",
                "-            {if !$field.use_editor}",
                "-                <textarea class=\"form-control\" name=\"{$fieldName}{if $field.multilingual}[{$core.language.iso}]{/if}\" rows=\"8\" id=\"{$name}\">{$value|escape}</textarea>",
                "+            {if $field.multilingual && isset($item[\"{$fieldName}_{$core.language.iso}\"])}",
                "+                {$value = $item[\"{$fieldName}_{$core.language.iso}\"]}",
                "+            {/if}",
                "+            {if $field.use_editor}",
                "+                {if $field.multilingual && $core.config.show_multilingual_inputs}",
                "+                    <div class=\"translate-group\" id=\"language-group-{$fieldName}\">",
                "+                        <div class=\"translate-group__default\">",
                "+                            <div class=\"translate-group__item\">",
                "+                                {if empty($item[\"{$fieldName}_{$core.masterLanguage.iso}\"])}",
                "+                                    {$value = $field.default}",
                "+                                {else}",
                "+                                    {$value = $item[\"{$fieldName}_{$core.masterLanguage.iso}\"]}",
                "+                                {/if}",
                "+                                {if count($core.languages) > 1}",
                "+                                    <div class=\"translate-group__item__code\">{$core.masterLanguage.title|escape}</div>",
                "+                                {/if}",
                "+                                {ia_wysiwyg value=$value name=\"{$fieldName}[{$core.masterLanguage.iso}]\" id=\"{$name}\"}",
                "+                            </div>",
                "+                        </div>",
                "+                        <div class=\"translate-group__langs\">",
                "+                            {foreach $core.languages as $iso => $language}",
                "+                                {if $iso == $core.masterLanguage.iso}",
                "+                                    {continue}",
                "+                                {/if}",
                "+",
                "+                                {if empty($item[\"{$fieldName}_{$iso}\"])}",
                "+                                    {$value = $field.default}",
                "+                                {else}",
                "+                                    {$value = $item[\"{$fieldName}_{$iso}\"]}",
                "+                                {/if}",
                "+                                <div class=\"translate-group__item\">",
                "+                                    <span class=\"translate-group__item__code\">{$language.title|escape}</span>",
                "+                                    {ia_wysiwyg value=$value name=\"{$fieldName}[{$iso}]\" id=\"{$name}-{$iso}\"}",
                "+                                </div>",
                "+                            {/foreach}",
                "+                        </div>",
                "+                    </div>",
                "+                {else}",
                "+                    {ia_wysiwyg value=$value name=\"{$field.name}{if $field.multilingual}[{$core.language.iso}]{/if}\"}",
                "+                {/if}",
                "+            {else}",
                "+                {if $field.multilingual && $core.config.show_multilingual_inputs}",
                "+                    {if empty($item[\"{$fieldName}_{$core.masterLanguage.iso}\"])}",
                "+                        {$value = $field.default}",
                "+                    {else}",
                "+                        {$value = $item[\"{$fieldName}_{$core.masterLanguage.iso}\"]}",
                "+                    {/if}",
                "+                    <div class=\"translate-group\" id=\"language-group-{$fieldName}\">",
                "+                        <div class=\"translate-group__default\">",
                "+                            <div class=\"translate-group__item\">",
                "+                                {if count($core.languages) > 1}",
                "+                                    <div class=\"translate-group__item__code\">{$core.masterLanguage.title|escape}</div>",
                "+                                {/if}",
                "+                                <textarea name=\"{$fieldName}[{$core.masterLanguage.iso}]\" id=\"{$name}\" ",
                "+                                    class=\"form-control\" rows=\"5\">{$value|escape}</textarea>",
                "+                            </div>",
                "+                        </div>",
                "+                        <div class=\"translate-group__langs\">",
                "+                            {foreach $core.languages as $iso => $language}",
                "+                                {if $iso == $core.masterLanguage.iso}",
                "+                                    {continue}",
                "+                                {/if}",
                "+",
                "+                                {if empty($item[\"{$fieldName}_{$iso}\"])}",
                "+                                    {$value = $field.default}",
                "+                                {else}",
                "+                                    {$value = $item[\"{$fieldName}_{$iso}\"]}",
                "+                                {/if}",
                "+                                <div class=\"translate-group__item\">",
                "+                                    <span class=\"translate-group__item__code\">{$language.title|escape}</span>",
                "+                                    <textarea name=\"{$fieldName}[{$iso}]\" id=\"{$name}-{$iso}\" ",
                "+                                        class=\"form-control\" rows=\"5\">{$value|escape}</textarea>",
                "+                                </div>",
                "+                            {/foreach}",
                "+                        </div>",
                "+                    </div>",
                "+                {else}",
                "+                    <textarea class=\"form-control\" name=\"{$fieldName}{if $field.multilingual}[{$core.language.iso}]{/if}\" rows=\"8\" id=\"{$name}\">{$value|escape}</textarea>",
                "+                {/if}",
                "                 {if $field.length > 0}",
                "@@ -56,4 +177,2 @@ $(function() {",
                "                 {/if}",
                "-            {else}",
                "-                {ia_wysiwyg value=$value name=\"{$field.name}{if $field.multilingual}[{$core.language.iso}]{/if}\"}",
                "             {/if}"
            ],
            "changed_files": [
                "includes/classes/ia.core.field.php",
                "install/dump/install.sql",
                "js/frontend/footer.js",
                "templates/_common/field-type-content-manage.tpl"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "776": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [],
            "matched_rules": [
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 776",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "44f96b9e3e10622d34929ef783985d11590ba561",
            "repository": "https://github.com/intelliants/subrion",
            "timestamp": 1533893982,
            "hunks": 2,
            "message": "#776 config moved to more appropriate place",
            "diff": [
                "diff --git a/install/dump/install.sql b/install/dump/install.sql",
                "index 2810fe59..57034e86 100644",
                "--- a/install/dump/install.sql",
                "+++ b/install/dump/install.sql",
                "@@ -941,4 +941,5 @@ INSERT INTO `{install:prefix}config` (`config_group`, `name`, `value`, `multiple",
                " ('general', 'lang', 'en', '1', 'select', 33, 0, 1,'{\"wysiwyg\":0,\"code_editor\":0,\"show\":\"\",\"multilingual\":0}'),",
                "-('general', 'language_switch', '1', '\\'1\\',\\'0\\'', 'radio', 36, 0, 1,'{\"wysiwyg\":0,\"code_editor\":0,\"show\":\"\",\"multilingual\":0}'),",
                "-('general', 'timezone', 'America/New_York', '', 'select', 45, 0, 0, '{\"wysiwyg\":0,\"code_editor\":0,\"show\":\"\",\"multilingual\":0}'),",
                "+('general', 'timezone', 'America/New_York', '', 'select', 34, 0, 0, '{\"wysiwyg\":0,\"code_editor\":0,\"show\":\"\",\"multilingual\":0}'),",
                "+('general', 'language_switch', '1', '\\'1\\',\\'0\\'', 'radio', 35, 0, 1,'{\"wysiwyg\":0,\"code_editor\":0,\"show\":\"\",\"multilingual\":0}'),",
                "+('general', 'show_multilingual_inputs', '0', '\\'1\\',\\'0\\'', 'radio', 36, 0, 1,'{\"wysiwyg\":0,\"code_editor\":0,\"show\":\"\",\"multilingual\":0}'),",
                "@@ -1036,4 +1037,2 @@ INSERT INTO `{install:prefix}config` (`config_group`, `name`, `value`, `multiple",
                " ('miscellaneous', 'maps_api_key', '', '', 'text', 16, 0, 0, '{\"wysiwyg\":0,\"code_editor\":0,\"show\":\"\",\"multilingual\":0}'),",
                "-('miscellaneous', '', 'Content', '', 'divider', 17, 1, 1, ''),",
                "-('miscellaneous', 'show_multilingual_inputs', '0', '\\'1\\',\\'0\\'', 'radio', 18, 0, 1,'{\"wysiwyg\":0,\"code_editor\":0,\"show\":\"\",\"multilingual\":0}'),"
            ],
            "changed_files": [
                "install/dump/install.sql"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "776": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [],
            "matched_rules": [
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 776",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "9413a83950cee86aedc103f125648c234ea7974b",
            "repository": "https://github.com/intelliants/subrion",
            "timestamp": 1530185469,
            "hunks": 1,
            "message": "Resolves #732",
            "diff": [
                "diff --git a/js/utils/zeroclipboard/ZeroClipboard.min.js b/js/utils/zeroclipboard/ZeroClipboard.min.js",
                "deleted file mode 100644",
                "index 0ae8244d..00000000",
                "--- a/js/utils/zeroclipboard/ZeroClipboard.min.js",
                "+++ /dev/null",
                "@@ -1,9 +0,0 @@",
                "-/*!",
                "- * ZeroClipboard",
                "- * The ZeroClipboard library provides an easy way to copy text to the clipboard using an invisible Adobe Flash movie and a JavaScript interface",
                "- * Copyright (c) 2009-2016 Jon Rohan, James M. Greene",
                "- * Licensed MIT",
                "- * http://zeroclipboard.org/",
                "- * v2.4.0-beta.1",
                "- */",
                "-!function(a,b){\"use strict\";var c,d,e,f=a,g=f.document,h=f.navigator,i=f.setTimeout,j=f.clearTimeout,k=f.setInterval,l=f.clearInterval,m=f.getComputedStyle,n=f.encodeURIComponent,o=f.ActiveXObject,p=f.Error,q=f.Number.parseInt||f.parseInt,r=f.Number.parseFloat||f.parseFloat,s=f.Number.isNaN||f.isNaN,t=f.Date.now,u=f.Object.keys,v=f.Object.prototype.hasOwnProperty,w=f.Array.prototype.slice,x=function(){var a=function(a){return a};if(\"function\"==typeof f.wrap&&\"function\"==typeof f.unwrap)try{var b=g.createElement(\"div\"),c=f.unwrap(b);1===b.nodeType&&c&&1===c.nodeType&&(a=f.unwrap)}catch(d){}return a}(),y=function(a){return w.call(a,0)},z=function(){var a,c,d,e,f,g,h=y(arguments),i=h[0]||{};for(a=1,c=h.length;c>a;a++)if(null!=(d=h[a]))for(e in d)v.call(d,e)&&(f=i[e],g=d[e],i!==g&&g!==b&&(i[e]=g));return i},A=function(a){var b,c,d,e;if(\"object\"!=typeof a||null==a||\"number\"==typeof a.nodeType)b=a;else if(\"number\"==typeof a.length)for(b=[],c=0,d=a.length;d>c;c++)v.call(a,c)&&(b[c]=A(a[c]));else{b={};for(e in a)v.call(a,e)&&(b[e]=A(a[e]))}return b},B=function(a,b){for(var c={},d=0,e=b.length;e>d;d++)b[d]in a&&(c[b[d]]=a[b[d]]);return c},C=function(a,b){var c={};for(var d in a)-1===b.indexOf(d)&&(c[d]=a[d]);return c},D=function(a){if(a)for(var b in a)v.call(a,b)&&delete a[b];return a},E=function(a,b){if(a&&1===a.nodeType&&a.ownerDocument&&b&&(1===b.nodeType&&b.ownerDocument&&b.ownerDocument===a.ownerDocument||9===b.nodeType&&!b.ownerDocument&&b===a.ownerDocument))do{if(a===b)return!0;a=a.parentNode}while(a);return!1},F=function(a){var b;return\"string\"==typeof a&&a&&(b=a.split(\"#\")[0].split(\"?\")[0],b=a.slice(0,a.lastIndexOf(\"/\")+1)),b},G=function(a){var b,c;return\"string\"==typeof a&&a&&(c=a.match(/^(?:|[^:@]*@|.+\\)@(?=http[s]?|file)|.+?\\s+(?: at |@)(?:[^:\\(]+ )*[\\(]?)((?:http[s]?|file):\\/\\/[\\/]?.+?\\/[^:\\)]*?)(?::\\d+)(?::\\d+)?/),c&&c[1]?b=c[1]:(c=a.match(/\\)@((?:http[s]?|file):\\/\\/[\\/]?.+?\\/[^:\\)]*?)(?::\\d+)(?::\\d+)?/),c&&c[1]&&(b=c[1]))),b},H=function(){var a,b;try{throw new p}catch(c){b=c}return b&&(a=b.sourceURL||b.fileName||G(b.stack)),a},I=function(){var a,c,d;if(g.currentScript&&(a=g.currentScript.src))return a;if(c=g.getElementsByTagName(\"script\"),1===c.length)return c[0].src||b;if(\"readyState\"in(c[0]||document.createElement(\"script\")))for(d=c.length;d--;)if(\"interactive\"===c[d].readyState&&(a=c[d].src))return a;return\"loading\"===g.readyState&&(a=c[c.length-1].src)?a:(a=H())?a:b},J=function(){var a,c,d,e=g.getElementsByTagName(\"script\");for(a=e.length;a--;){if(!(d=e[a].src)){c=null;break}if(d=F(d),null==c)c=d;else if(c!==d){c=null;break}}return c||b},K=function(){var a=F(I())||J()||\"\";return a+\"ZeroClipboard.swf\"},L=function(){var a=/win(dows|[\\s]?(nt|me|ce|xp|vista|[\\d]+))/i;return!!h&&(a.test(h.appVersion||\"\")||a.test(h.platform||\"\")||-1!==(h.userAgent||\"\").indexOf(\"Windows\"))},M=function(){return null==f.opener&&(!!f.top&&f!=f.top||!!f.parent&&f!=f.parent)}(),N=\"html\"===g.documentElement.nodeName,O={bridge:null,version:\"0.0.0\",pluginType:\"unknown\",sandboxed:null,disabled:null,outdated:null,insecure:null,unavailable:null,degraded:null,deactivated:null,overdue:null,ready:null},P=\"11.0.0\",Q={},R={},S=null,T=0,U=0,V={ready:\"Flash communication is established\",error:{\"flash-sandboxed\":\"Attempting to run Flash in a sandboxed iframe, which is impossible\",\"flash-disabled\":\"Flash is disabled or not installed. May also be attempting to run Flash in a sandboxed iframe, which is impossible.\",\"flash-outdated\":\"Flash is too outdated to support ZeroClipboard\",\"flash-insecure\":\"Flash will be unable to communicate due to a protocol mismatch between your `swfPath` configuration and the page\",\"flash-unavailable\":\"Flash is unable to communicate bidirectionally with JavaScript\",\"flash-degraded\":\"Flash is unable to preserve data fidelity when communicating with JavaScript\",\"flash-deactivated\":\"Flash is too outdated for your browser and/or is configured as click-to-activate.\\nThis may also mean that the ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity.\\nMay also be attempting to run Flash in a sandboxed iframe, which is impossible.\",\"flash-overdue\":\"Flash communication was established but NOT within the acceptable time limit\",\"version-mismatch\":\"ZeroClipboard JS version number does not match ZeroClipboard SWF version number\",\"clipboard-error\":\"At least one error was thrown while ZeroClipboard was attempting to inject your data into the clipboard\",\"config-mismatch\":\"ZeroClipboard configuration does not match Flash's reality\",\"swf-not-found\":\"The ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity\",\"browser-unsupported\":\"The browser does not support the required HTML DOM and JavaScript features\"}},W=[\"flash-unavailable\",\"flash-degraded\",\"flash-overdue\",\"version-mismatch\",\"config-mismatch\",\"clipboard-error\"],X=[\"flash-sandboxed\",\"flash-disabled\",\"flash-outdated\",\"flash-insecure\",\"flash-unavailable\",\"flash-degraded\",\"flash-deactivated\",\"flash-overdue\"],Y=new RegExp(\"^flash-(\"+X.map(function(a){return a.replace(/^flash-/,\"\")}).join(\"|\")+\")$\"),Z=new RegExp(\"^flash-(\"+X.filter(function(a){return\"flash-disabled\"!==a}).map(function(a){return a.replace(/^flash-/,\"\")}).join(\"|\")+\")$\"),$={swfPath:K(),trustedDomains:f.location.host?[f.location.host]:[],cacheBust:!0,forceEnhancedClipboard:!1,flashLoadTimeout:3e4,autoActivate:!0,bubbleEvents:!0,fixLineEndings:!0,containerId:\"global-zeroclipboard-html-bridge\",containerClass:\"global-zeroclipboard-container\",swfObjectId:\"global-zeroclipboard-flash-bridge\",hoverClass:\"zeroclipboard-is-hover\",activeClass:\"zeroclipboard-is-active\",forceHandCursor:!1,title:null,zIndex:999999999},_=function(a){\"object\"!=typeof a||!a||\"length\"in a||u(a).forEach(function(b){if(/^(?:forceHandCursor|title|zIndex|bubbleEvents|fixLineEndings)$/.test(b))$[b]=a[b];else if(null==O.bridge)if(\"containerId\"===b||\"swfObjectId\"===b){if(!qa(a[b]))throw new Error(\"The specified `\"+b+\"` value is not valid as an HTML4 Element ID\");$[b]=a[b]}else $[b]=a[b]});{if(\"string\"!=typeof a||!a)return A($);if(v.call($,a))return $[a]}},aa=function(){return Ya(),{browser:z(B(h,[\"userAgent\",\"platform\",\"appName\",\"appVersion\"]),{isSupported:ba()}),flash:C(O,[\"bridge\"]),zeroclipboard:{version:$a.version,config:$a.config()}}},ba=function(){return!!(g.addEventListener&&f.Object.keys&&f.Array.prototype.map)},ca=function(){return!!(O.sandboxed||O.disabled||O.outdated||O.unavailable||O.degraded||O.deactivated)},da=function(a,d){var e,f,g,h={};if(\"string\"==typeof a&&a?g=a.toLowerCase().split(/\\s+/):\"object\"!=typeof a||!a||\"length\"in a||\"undefined\"!=typeof d||u(a).forEach(function(b){var c=a[b];\"function\"==typeof c&&$a.on(b,c)}),g&&g.length&&d){for(e=0,f=g.length;f>e;e++)a=g[e].replace(/^on/,\"\"),h[a]=!0,Q[a]||(Q[a]=[]),Q[a].push(d);if(h.ready&&O.ready&&$a.emit({type:\"ready\"}),h.error){for(ba()||$a.emit({type:\"error\",name:\"browser-unsupported\"}),e=0,f=X.length;f>e;e++)if(O[X[e].replace(/^flash-/,\"\")]===!0){$a.emit({type:\"error\",name:X[e]});break}c!==b&&$a.version!==c&&$a.emit({type:\"error\",name:\"version-mismatch\",jsVersion:$a.version,swfVersion:c})}}return $a},ea=function(a,b){var c,d,e,f,g;if(0===arguments.length?f=u(Q):\"string\"==typeof a&&a?f=a.toLowerCase().split(/\\s+/):\"object\"!=typeof a||!a||\"length\"in a||\"undefined\"!=typeof b||u(a).forEach(function(b){var c=a[b];\"function\"==typeof c&&$a.off(b,c)}),f&&f.length)for(c=0,d=f.length;d>c;c++)if(a=f[c].replace(/^on/,\"\"),g=Q[a],g&&g.length)if(b)for(e=g.indexOf(b);-1!==e;)g.splice(e,1),e=g.indexOf(b,e);else g.length=0;return $a},fa=function(a){var b;return b=\"string\"==typeof a&&a?A(Q[a])||null:A(Q)},ga=function(a){var b,c,d;return a=ra(a),a&&!ya(a)?\"ready\"===a.type&&O.overdue===!0?$a.emit({type:\"error\",name:\"flash-overdue\"}):(b=z({},a),wa.call(this,b),\"copy\"===a.type&&(d=Ha(R),c=d.data,S=d.formatMap),c):void 0},ha=function(){var a=$.swfPath||\"\",b=a.slice(0,2),c=a.slice(0,a.indexOf(\"://\")+1);return\"\\\\\\\\\"===b?\"file:\":\"//\"===b||\"\"===c?f.location.protocol:c},ia=function(){var a,b,c=O.sandboxed;return ba()?(Ya(),\"boolean\"!=typeof O.ready&&(O.ready=!1),void(O.sandboxed!==c&&O.sandboxed===!0?(O.ready=!1,$a.emit({type:\"error\",name:\"flash-sandboxed\"})):$a.isFlashUnusable()||null!==O.bridge||(b=ha(),b&&b!==f.location.protocol?$a.emit({type:\"error\",name:\"flash-insecure\"}):(a=$.flashLoadTimeout,\"number\"==typeof a&&a>=0&&(T=i(function(){\"boolean\"!=typeof O.deactivated&&(O.deactivated=!0),O.deactivated===!0&&$a.emit({type:\"error\",name:\"flash-deactivated\"})},a)),O.overdue=!1,Fa())))):(O.ready=!1,void $a.emit({type:\"error\",name:\"browser-unsupported\"}))},ja=function(){$a.clearData(),$a.blur(),$a.emit(\"destroy\"),Ga(),$a.off()},ka=function(a,b){var c;if(\"object\"==typeof a&&a&&\"undefined\"==typeof b)c=a,$a.clearData();else{if(\"string\"!=typeof a||!a)return;c={},c[a]=b}for(var d in c)\"string\"==typeof d&&d&&v.call(c,d)&&\"string\"==typeof c[d]&&c[d]&&(R[d]=Xa(c[d]))},la=function(a){\"undefined\"==typeof a?(D(R),S=null):\"string\"==typeof a&&v.call(R,a)&&delete R[a]},ma=function(a){return\"undefined\"==typeof a?A(R):\"string\"==typeof a&&v.call(R,a)?R[a]:void 0},na=function(a){if(a&&1===a.nodeType){d&&(Pa(d,$.activeClass),d!==a&&Pa(d,$.hoverClass)),d=a,Oa(a,$.hoverClass);var b=a.getAttribute(\"title\")||$.title;if(\"string\"==typeof b&&b){var c=Da(O.bridge);c&&c.setAttribute(\"title\",b)}var e=$.forceHandCursor===!0||\"pointer\"===Qa(a,\"cursor\");Va(e),Ua()}},oa=function(){var a=Da(O.bridge);a&&(a.removeAttribute(\"title\"),a.style.left=\"0px\",a.style.top=\"-9999px\",a.style.width=\"1px\",a.style.height=\"1px\"),d&&(Pa(d,$.hoverClass),Pa(d,$.activeClass),d=null)},pa=function(){return d||null},qa=function(a){return\"string\"==typeof a&&a&&/^[A-Za-z][A-Za-z0-9_:\\-\\.]*$/.test(a)},ra=function(a){var b;if(\"string\"==typeof a&&a?(b=a,a={}):\"object\"==typeof a&&a&&\"string\"==typeof a.type&&a.type&&(b=a.type),b){b=b.toLowerCase(),!a.target&&(/^(copy|aftercopy|_click)$/.test(b)||\"error\"===b&&\"clipboard-error\"===a.name)&&(a.target=e),z(a,{type:b,target:a.target||d||null,relatedTarget:a.relatedTarget||null,currentTarget:O&&O.bridge||null,timeStamp:a.timeStamp||t()||null});var c=V[a.type];return\"error\"===a.type&&a.name&&c&&(c=c[a.name]),c&&(a.message=c),\"ready\"===a.type&&z(a,{target:null,version:O.version}),\"error\"===a.type&&(Y.test(a.name)&&z(a,{target:null,minimumVersion:P}),Z.test(a.name)&&z(a,{version:O.version}),\"flash-insecure\"===a.name&&z(a,{pageProtocol:f.location.protocol,swfProtocol:ha()})),\"copy\"===a.type&&(a.clipboardData={setData:$a.setData,clearData:$a.clearData}),\"aftercopy\"===a.type&&(a=Ia(a,S)),a.target&&!a.relatedTarget&&(a.relatedTarget=sa(a.target)),ta(a)}},sa=function(a){var b=a&&a.getAttribute&&a.getAttribute(\"data-clipboard-target\");return b?g.getElementById(b):null},ta=function(a){if(a&&/^_(?:click|mouse(?:over|out|down|up|move))$/.test(a.type)){var c=a.target,d=\"_mouseover\"===a.type&&a.relatedTarget?a.relatedTarget:b,e=\"_mouseout\"===a.type&&a.relatedTarget?a.relatedTarget:b,h=Ra(c),i=f.screenLeft||f.screenX||0,j=f.screenTop||f.screenY||0,k=g.body.scrollLeft+g.documentElement.scrollLeft,l=g.body.scrollTop+g.documentElement.scrollTop,m=h.left+(\"number\"==typeof a._stageX?a._stageX:0),n=h.top+(\"number\"==typeof a._stageY?a._stageY:0),o=m-k,p=n-l,q=i+o,r=j+p,s=\"number\"==typeof a.movementX?a.movementX:0,t=\"number\"==typeof a.movementY?a.movementY:0;delete a._stageX,delete a._stageY,z(a,{srcElement:c,fromElement:d,toElement:e,screenX:q,screenY:r,pageX:m,pageY:n,clientX:o,clientY:p,x:o,y:p,movementX:s,movementY:t,offsetX:0,offsetY:0,layerX:0,layerY:0})}return a},ua=function(a){var b=a&&\"string\"==typeof a.type&&a.type||\"\";return!/^(?:(?:before)?copy|destroy)$/.test(b)},va=function(a,b,c,d){d?i(function(){a.apply(b,c)},0):a.apply(b,c)},wa=function(a){if(\"object\"==typeof a&&a&&a.type){var b=ua(a),c=Q[\"*\"]||[],d=Q[a.type]||[],e=c.concat(d);if(e&&e.length){var g,h,i,j,k,l=this;for(g=0,h=e.length;h>g;g++)i=e[g],j=l,\"string\"==typeof i&&\"function\"==typeof f[i]&&(i=f[i]),\"object\"==typeof i&&i&&\"function\"==typeof i.handleEvent&&(j=i,i=i.handleEvent),\"function\"==typeof i&&(k=z({},a),va(i,j,[k],b))}return this}},xa=function(a){var b=null;return(M===!1||a&&\"error\"===a.type&&a.name&&-1!==W.indexOf(a.name))&&(b=!1),b},ya=function(a){var b=a.target||d||null,f=\"swf\"===a._source;switch(delete a._source,a.type){case\"error\":var g=\"flash-sandboxed\"===a.name||xa(a);\"boolean\"==typeof g&&(O.sandboxed=g),\"browser-unsupported\"===a.name?z(O,{disabled:!1,outdated:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:!1,ready:!1}):-1!==X.indexOf(a.name)?z(O,{disabled:\"flash-disabled\"===a.name,outdated:\"flash-outdated\"===a.name,insecure:\"flash-insecure\"===a.name,unavailable:\"flash-unavailable\"===a.name,degraded:\"flash-degraded\"===a.name,deactivated:\"flash-deactivated\"===a.name,overdue:\"flash-overdue\"===a.name,ready:!1}):\"version-mismatch\"===a.name&&(c=a.swfVersion,z(O,{disabled:!1,outdated:!1,insecure:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:!1,ready:!1})),Ta();break;case\"ready\":c=a.swfVersion;var h=O.deactivated===!0;z(O,{sandboxed:!1,disabled:!1,outdated:!1,insecure:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:h,ready:!h}),Ta();break;case\"beforecopy\":e=b;break;case\"copy\":var i,j,k=a.relatedTarget;!R[\"text/html\"]&&!R[\"text/plain\"]&&k&&(j=k.value||k.outerHTML||k.innerHTML)&&(i=k.value||k.textContent||k.innerText)?(a.clipboardData.clearData(),a.clipboardData.setData(\"text/plain\",i),j!==i&&a.clipboardData.setData(\"text/html\",j)):!R[\"text/plain\"]&&a.target&&(i=a.target.getAttribute(\"data-clipboard-text\"))&&(a.clipboardData.clearData(),a.clipboardData.setData(\"text/plain\",i));break;case\"aftercopy\":za(a),$a.clearData(),b&&b!==Na()&&b.focus&&b.focus();break;case\"_mouseover\":$a.focus(b),$.bubbleEvents===!0&&f&&(b&&b!==a.relatedTarget&&!E(a.relatedTarget,b)&&Aa(z({},a,{type:\"mouseenter\",bubbles:!1,cancelable:!1})),Aa(z({},a,{type:\"mouseover\"})));break;case\"_mouseout\":$a.blur(),$.bubbleEvents===!0&&f&&(b&&b!==a.relatedTarget&&!E(a.relatedTarget,b)&&Aa(z({},a,{type:\"mouseleave\",bubbles:!1,cancelable:!1})),Aa(z({},a,{type:\"mouseout\"})));break;case\"_mousedown\":Oa(b,$.activeClass),$.bubbleEvents===!0&&f&&Aa(z({},a,{type:a.type.slice(1)}));break;case\"_mouseup\":Pa(b,$.activeClass),$.bubbleEvents===!0&&f&&Aa(z({},a,{type:a.type.slice(1)}));break;case\"_click\":e=null,$.bubbleEvents===!0&&f&&Aa(z({},a,{type:a.type.slice(1)}));break;case\"_mousemove\":$.bubbleEvents===!0&&f&&Aa(z({},a,{type:a.type.slice(1)}))}return/^_(?:click|mouse(?:over|out|down|up|move))$/.test(a.type)?!0:void 0},za=function(a){if(a.errors&&a.errors.length>0){var b=A(a);z(b,{type:\"error\",name:\"clipboard-error\"}),delete b.success,i(function(){$a.emit(b)},0)}},Aa=function(a){if(a&&\"string\"==typeof a.type&&a){var b,c=a.target||null,d=c&&c.ownerDocument||g,e={view:d.defaultView||f,canBubble:!0,cancelable:!0,detail:\"click\"===a.type?1:0,button:\"number\"==typeof a.which?a.which-1:\"number\"==typeof a.button?a.button:d.createEvent?0:1},h=z(e,a);c&&d.createEvent&&c.dispatchEvent&&(h=[h.type,h.canBubble,h.cancelable,h.view,h.detail,h.screenX,h.screenY,h.clientX,h.clientY,h.ctrlKey,h.altKey,h.shiftKey,h.metaKey,h.button,h.relatedTarget],b=d.createEvent(\"MouseEvents\"),b.initMouseEvent&&(b.initMouseEvent.apply(b,h),b._source=\"js\",c.dispatchEvent(b)))}},Ba=function(){var a=$.flashLoadTimeout;if(\"number\"==typeof a&&a>=0){var b=Math.min(1e3,a/10),c=$.swfObjectId+\"_fallbackContent\";U=k(function(){var a=g.getElementById(c);Sa(a)&&(Ta(),O.deactivated=null,$a.emit({type:\"error\",name:\"swf-not-found\"}))},b)}},Ca=function(){var a=g.createElement(\"div\");return a.id=$.containerId,a.className=$.containerClass,a.style.position=\"absolute\",a.style.left=\"0px\",a.style.top=\"-9999px\",a.style.width=\"1px\",a.style.height=\"1px\",a.style.zIndex=\"\"+Wa($.zIndex),a},Da=function(a){for(var b=a&&a.parentNode;b&&\"OBJECT\"===b.nodeName&&b.parentNode;)b=b.parentNode;return b||null},Ea=function(a){return\"string\"==typeof a&&a?a.replace(/[\"&'<>]/g,function(a){switch(a){case'\"':return\"&quot;\";case\"&\":return\"&amp;\";case\"'\":return\"&apos;\";case\"<\":return\"&lt;\";case\">\":return\"&gt;\";default:return a}}):a},Fa=function(){var a,b=O.bridge,c=Da(b);if(!b){var d=Ma(f.location.host,$),e=\"never\"===d?\"none\":\"all\",h=Ka(z({jsVersion:$a.version},$)),i=$.swfPath+Ja($.swfPath,$);N&&(i=Ea(i)),c=Ca();var j=g.createElement(\"div\");c.appendChild(j),g.body.appendChild(c);var k=g.createElement(\"div\"),l=\"activex\"===O.pluginType;k.innerHTML='<object id=\"'+$.swfObjectId+'\" name=\"'+$.swfObjectId+'\" width=\"100%\" height=\"100%\" '+(l?'classid=\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\"':'type=\"application/x-shockwave-flash\" data=\"'+i+'\"')+\">\"+(l?'<param name=\"movie\" value=\"'+i+'\"/>':\"\")+'<param name=\"allowScriptAccess\" value=\"'+d+'\"/><param name=\"allowNetworking\" value=\"'+e+'\"/><param name=\"menu\" value=\"false\"/><param name=\"wmode\" value=\"transparent\"/><param name=\"flashvars\" value=\"'+h+'\"/><div id=\"'+$.swfObjectId+'_fallbackContent\">&nbsp;</div></object>',b=k.firstChild,k=null,x(b).ZeroClipboard=$a,c.replaceChild(b,j),Ba()}return b||(b=g[$.swfObjectId],b&&(a=b.length)&&(b=b[a-1]),!b&&c&&(b=c.firstChild)),O.bridge=b||null,b},Ga=function(){var a=O.bridge;if(a){var d=Da(a);d&&(\"activex\"===O.pluginType&&\"readyState\"in a?(a.style.display=\"none\",function e(){if(4===a.readyState){for(var b in a)\"function\"==typeof a[b]&&(a[b]=null);a.parentNode&&a.parentNode.removeChild(a),d.parentNode&&d.parentNode.removeChild(d)}else i(e,10)}()):(a.parentNode&&a.parentNode.removeChild(a),d.parentNode&&d.parentNode.removeChild(d))),Ta(),O.ready=null,O.bridge=null,O.deactivated=null,O.insecure=null,c=b}},Ha=function(a){var b={},c={};if(\"object\"==typeof a&&a){for(var d in a)if(d&&v.call(a,d)&&\"string\"==typeof a[d]&&a[d])switch(d.toLowerCase()){case\"text/plain\":case\"text\":case\"air:text\":case\"flash:text\":b.text=a[d],c.text=d;break;case\"text/html\":case\"html\":case\"air:html\":case\"flash:html\":b.html=a[d],c.html=d;break;case\"application/rtf\":case\"text/rtf\":case\"rtf\":case\"richtext\":case\"air:rtf\":case\"flash:rtf\":b.rtf=a[d],c.rtf=d}return{data:b,formatMap:c}}},Ia=function(a,b){if(\"object\"!=typeof a||!a||\"object\"!=typeof b||!b)return a;var c={};for(var d in a)if(v.call(a,d))if(\"errors\"===d){c[d]=a[d]?a[d].slice():[];for(var e=0,f=c[d].length;f>e;e++)c[d][e].format=b[c[d][e].format]}else if(\"success\"!==d&&\"data\"!==d)c[d]=a[d];else{c[d]={};var g=a[d];for(var h in g)h&&v.call(g,h)&&v.call(b,h)&&(c[d][b[h]]=g[h])}return c},Ja=function(a,b){var c=null==b||b&&b.cacheBust===!0;return c?(-1===a.indexOf(\"?\")?\"?\":\"&\")+\"noCache=\"+t():\"\"},Ka=function(a){var b,c,d,e,g=\"\",h=[];if(a.trustedDomains&&(\"string\"==typeof a.trustedDomains?e=[a.trustedDomains]:\"object\"==typeof a.trustedDomains&&\"length\"in a.trustedDomains&&(e=a.trustedDomains)),e&&e.length)for(b=0,c=e.length;c>b;b++)if(v.call(e,b)&&e[b]&&\"string\"==typeof e[b]){if(d=La(e[b]),!d)continue;if(\"*\"===d){h.length=0,h.push(d);break}h.push.apply(h,[d,\"//\"+d,f.location.protocol+\"//\"+d])}return h.length&&(g+=\"trustedOrigins=\"+n(h.join(\",\"))),a.forceEnhancedClipboard===!0&&(g+=(g?\"&\":\"\")+\"forceEnhancedClipboard=true\"),\"string\"==typeof a.swfObjectId&&a.swfObjectId&&(g+=(g?\"&\":\"\")+\"swfObjectId=\"+n(a.swfObjectId)),\"string\"==typeof a.jsVersion&&a.jsVersion&&(g+=(g?\"&\":\"\")+\"jsVersion=\"+n(a.jsVersion)),g},La=function(a){if(null==a||\"\"===a)return null;if(a=a.replace(/^\\s+|\\s+$/g,\"\"),\"\"===a)return null;var b=a.indexOf(\"//\");a=-1===b?a:a.slice(b+2);var c=a.indexOf(\"/\");return a=-1===c?a:-1===b||0===c?null:a.slice(0,c),a&&\".swf\"===a.slice(-4).toLowerCase()?null:a||null},Ma=function(){var a=function(a){var b,c,d,e=[];if(\"string\"==typeof a&&(a=[a]),\"object\"!=typeof a||!a||\"number\"!=typeof a.length)return e;for(b=0,c=a.length;c>b;b++)if(v.call(a,b)&&(d=La(a[b]))){if(\"*\"===d){e.length=0,e.push(\"*\");break}-1===e.indexOf(d)&&e.push(d)}return e};return function(b,c){var d=La(c.swfPath);null===d&&(d=b);var e=a(c.trustedDomains),f=e.length;if(f>0){if(1===f&&\"*\"===e[0])return\"always\";if(-1!==e.indexOf(b))return 1===f&&b===d?\"sameDomain\":\"always\"}return\"never\"}}(),Na=function(){try{return g.activeElement}catch(a){return null}},Oa=function(a,b){var c,d,e,f=[];if(\"string\"==typeof b&&b&&(f=b.split(/\\s+/)),a&&1===a.nodeType&&f.length>0){for(e=(\" \"+(a.className||\"\")+\" \").replace(/[\\t\\r\\n\\f]/g,\" \"),c=0,d=f.length;d>c;c++)-1===e.indexOf(\" \"+f[c]+\" \")&&(e+=f[c]+\" \");e=e.replace(/^\\s+|\\s+$/g,\"\"),e!==a.className&&(a.className=e)}return a},Pa=function(a,b){var c,d,e,f=[];if(\"string\"==typeof b&&b&&(f=b.split(/\\s+/)),a&&1===a.nodeType&&f.length>0&&a.className){for(e=(\" \"+a.className+\" \").replace(/[\\t\\r\\n\\f]/g,\" \"),c=0,d=f.length;d>c;c++)e=e.replace(\" \"+f[c]+\" \",\" \");e=e.replace(/^\\s+|\\s+$/g,\"\"),e!==a.className&&(a.className=e)}return a},Qa=function(a,b){var c=m(a,null).getPropertyValue(b);return\"cursor\"!==b||c&&\"auto\"!==c||\"A\"!==a.nodeName?c:\"pointer\"},Ra=function(a){var b={left:0,top:0,width:0,height:0};if(a.getBoundingClientRect){var c=a.getBoundingClientRect(),d=f.pageXOffset,e=f.pageYOffset,h=g.documentElement.clientLeft||0,i=g.documentElement.clientTop||0,j=0,k=0;if(\"relative\"===Qa(g.body,\"position\")){var l=g.body.getBoundingClientRect(),m=g.documentElement.getBoundingClientRect();j=l.left-m.left||0,k=l.top-m.top||0}b.left=c.left+d-h-j,b.top=c.top+e-i-k,b.width=\"width\"in c?c.width:c.right-c.left,b.height=\"height\"in c?c.height:c.bottom-c.top}return b},Sa=function(a){if(!a)return!1;var b=m(a,null);if(!b)return!1;var c=r(b.height)>0,d=r(b.width)>0,e=r(b.top)>=0,f=r(b.left)>=0,g=c&&d&&e&&f,h=g?null:Ra(a),i=\"none\"!==b.display&&\"collapse\"!==b.visibility&&(g||!!h&&(c||h.height>0)&&(d||h.width>0)&&(e||h.top>=0)&&(f||h.left>=0));return i},Ta=function(){j(T),T=0,l(U),U=0},Ua=function(){var a;if(d&&(a=Da(O.bridge))){var b=Ra(d);z(a.style,{width:b.width+\"px\",height:b.height+\"px\",top:b.top+\"px\",left:b.left+\"px\",zIndex:\"\"+Wa($.zIndex)})}},Va=function(a){O.ready===!0&&(O.bridge&&\"function\"==typeof O.bridge.setHandCursor?O.bridge.setHandCursor(a):O.ready=!1)},Wa=function(a){if(/^(?:auto|inherit)$/.test(a))return a;var b;return\"number\"!=typeof a||s(a)?\"string\"==typeof a&&(b=Wa(q(a,10))):b=a,\"number\"==typeof b?b:\"auto\"},Xa=function(a){var b=/(\\r\\n|\\r|\\n)/g;return\"string\"==typeof a&&$.fixLineEndings===!0&&(L()?/((^|[^\\r])\\n|\\r([^\\n]|$))/.test(a)&&(a=a.replace(b,\"\\r\\n\")):/\\r/.test(a)&&(a=a.replace(b,\"\\n\"))),a},Ya=function(b){var c,d,e,f=O.sandboxed,g=null;if(b=b===!0,M===!1)g=!1;else{try{d=a.frameElement||null}catch(h){e={name:h.name,message:h.message}}if(d&&1===d.nodeType&&\"IFRAME\"===d.nodeName)try{g=d.hasAttribute(\"sandbox\")}catch(h){g=null}else{try{c=document.domain||null}catch(h){c=null}(null===c||e&&\"SecurityError\"===e.name&&/(^|[\\s\\(\\[@])sandbox(es|ed|ing|[\\s\\.,!\\)\\]@]|$)/.test(e.message.toLowerCase()))&&(g=!0)}}return O.sandboxed=g,f===g||b||Za(o),g},Za=function(a){function b(a){var b=a.match(/[\\d]+/g);return b.length=3,b.join(\".\")}function c(a){return!!a&&(a=a.toLowerCase())&&(/^(pepflashplayer\\.dll|libpepflashplayer\\.so|pepperflashplayer\\.plugin)$/.test(a)||\"chrome.plugin\"===a.slice(-13))}function d(a){a&&(i=!0,a.version&&(l=b(a.version)),!l&&a.description&&(l=b(a.description)),a.filename&&(k=c(a.filename)))}var e,f,g,i=!1,j=!1,k=!1,l=\"\";if(h.plugins&&h.plugins.length)e=h.plugins[\"Shockwave Flash\"],d(e),h.plugins[\"Shockwave Flash 2.0\"]&&(i=!0,l=\"2.0.0.11\");else if(h.mimeTypes&&h.mimeTypes.length)g=h.mimeTypes[\"application/x-shockwave-flash\"],e=g&&g.enabledPlugin,d(e);else if(\"undefined\"!=typeof a){j=!0;try{f=new a(\"ShockwaveFlash.ShockwaveFlash.7\"),i=!0,l=b(f.GetVariable(\"$version\"))}catch(m){try{f=new a(\"ShockwaveFlash.ShockwaveFlash.6\"),i=!0,l=\"6.0.21\"}catch(n){try{f=new a(\"ShockwaveFlash.ShockwaveFlash\"),i=!0,l=b(f.GetVariable(\"$version\"))}catch(o){j=!1}}}}O.disabled=i!==!0,O.outdated=l&&r(l)<r(P),O.version=l||\"0.0.0\",O.pluginType=k?\"pepper\":j?\"activex\":i?\"netscape\":\"unknown\"};Za(o),Ya(!0);var $a=function(){return this instanceof $a?void(\"function\"==typeof $a._createClient&&$a._createClient.apply(this,y(arguments))):new $a};$a.version=\"2.4.0-beta.1\",$a.config=function(){return _.apply(this,y(arguments))},$a.state=function(){return aa.apply(this,y(arguments))},$a.isFlashUnusable=function(){return ca.apply(this,y(arguments))},$a.on=function(){return da.apply(this,y(arguments))},$a.off=function(){return ea.apply(this,y(arguments))},$a.handlers=function(){return fa.apply(this,y(arguments))},$a.emit=function(){return ga.apply(this,y(arguments))},$a.create=function(){return ia.apply(this,y(arguments))},$a.destroy=function(){return ja.apply(this,y(arguments))},$a.setData=function(){return ka.apply(this,y(arguments))},$a.clearData=function(){return la.apply(this,y(arguments))},$a.getData=function(){return ma.apply(this,y(arguments))},$a.focus=$a.activate=function(){return na.apply(this,y(arguments))},$a.blur=$a.deactivate=function(){return oa.apply(this,y(arguments))},$a.activeElement=function(){return pa.apply(this,y(arguments))};var _a=0,ab={},bb=0,cb={},db={};z($,{autoActivate:!0});var eb=function(a){var b,c=this;c.id=\"\"+_a++,b={instance:c,elements:[],handlers:{},coreWildcardHandler:function(a){return c.emit(a)}},ab[c.id]=b,a&&c.clip(a),$a.on(\"*\",b.coreWildcardHandler),$a.on(\"destroy\",function(){c.destroy()}),$a.create()},fb=function(a,d){var e,f,g,h={},i=this,j=ab[i.id],k=j&&j.handlers;if(!j)throw new Error(\"Attempted to add new listener(s) to a destroyed ZeroClipboard client instance\");if(\"string\"==typeof a&&a?g=a.toLowerCase().split(/\\s+/):\"object\"!=typeof a||!a||\"length\"in a||\"undefined\"!=typeof d||u(a).forEach(function(b){var c=a[b];\"function\"==typeof c&&i.on(b,c)}),g&&g.length&&d){for(e=0,f=g.length;f>e;e++)a=g[e].replace(/^on/,\"\"),h[a]=!0,k[a]||(k[a]=[]),k[a].push(d);if(h.ready&&O.ready&&this.emit({type:\"ready\",client:this}),h.error){for(e=0,f=X.length;f>e;e++)if(O[X[e].replace(/^flash-/,\"\")]){this.emit({type:\"error\",name:X[e],client:this});break}c!==b&&$a.version!==c&&this.emit({type:\"error\",name:\"version-mismatch\",jsVersion:$a.version,swfVersion:c})}}return i},gb=function(a,b){var c,d,e,f,g,h=this,i=ab[h.id],j=i&&i.handlers;if(!j)return h;if(0===arguments.length?f=u(j):\"string\"==typeof a&&a?f=a.split(/\\s+/):\"object\"!=typeof a||!a||\"length\"in a||\"undefined\"!=typeof b||u(a).forEach(function(b){var c=a[b];\"function\"==typeof c&&h.off(b,c)}),f&&f.length)for(c=0,d=f.length;d>c;c++)if(a=f[c].toLowerCase().replace(/^on/,\"\"),g=j[a],g&&g.length)if(b)for(e=g.indexOf(b);-1!==e;)g.splice(e,1),e=g.indexOf(b,e);else g.length=0;return h},hb=function(a){var b=null,c=ab[this.id]&&ab[this.id].handlers;return c&&(b=\"string\"==typeof a&&a?c[a]?c[a].slice(0):[]:A(c)),b},ib=function(a){var b,c=this;return nb.call(c,a)&&(\"object\"==typeof a&&a&&\"string\"==typeof a.type&&a.type&&(a=z({},a)),b=z({},ra(a),{client:c}),ob.call(c,b)),c},jb=function(a){if(!ab[this.id])throw new Error(\"Attempted to clip element(s) to a destroyed ZeroClipboard client instance\");a=pb(a);for(var b=0;b<a.length;b++)if(v.call(a,b)&&a[b]&&1===a[b].nodeType){a[b].zcClippingId?-1===cb[a[b].zcClippingId].indexOf(this.id)&&cb[a[b].zcClippingId].push(this.id):(a[b].zcClippingId=\"zcClippingId_\"+bb++,cb[a[b].zcClippingId]=[this.id],$.autoActivate===!0&&qb(a[b]));var c=ab[this.id]&&ab[this.id].elements;-1===c.indexOf(a[b])&&c.push(a[b])}return this},kb=function(a){var b=ab[this.id];if(!b)return this;var c,d=b.elements;a=\"undefined\"==typeof a?d.slice(0):pb(a);for(var e=a.length;e--;)if(v.call(a,e)&&a[e]&&1===a[e].nodeType){for(c=0;-1!==(c=d.indexOf(a[e],c));)d.splice(c,1);var f=cb[a[e].zcClippingId];if(f){for(c=0;-1!==(c=f.indexOf(this.id,c));)f.splice(c,1);0===f.length&&($.autoActivate===!0&&rb(a[e]),delete a[e].zcClippingId)}}return this},lb=function(){var a=ab[this.id];return a&&a.elements?a.elements.slice(0):[]},mb=function(){var a=ab[this.id];a&&(this.unclip(),this.off(),$a.off(\"*\",a.coreWildcardHandler),delete ab[this.id])},nb=function(a){if(!a||!a.type)return!1;if(a.client&&a.client!==this)return!1;var b=ab[this.id],c=b&&b.elements,d=!!c&&c.length>0,e=!a.target||d&&-1!==c.indexOf(a.target),f=a.relatedTarget&&d&&-1!==c.indexOf(a.relatedTarget),g=a.client&&a.client===this;return b&&(e||f||g)?!0:!1},ob=function(a){var b=ab[this.id];if(\"object\"==typeof a&&a&&a.type&&b){var c=ua(a),d=b&&b.handlers[\"*\"]||[],e=b&&b.handlers[a.type]||[],g=d.concat(e);if(g&&g.length){var h,i,j,k,l,m=this;for(h=0,i=g.length;i>h;h++)j=g[h],k=m,\"string\"==typeof j&&\"function\"==typeof f[j]&&(j=f[j]),\"object\"==typeof j&&j&&\"function\"==typeof j.handleEvent&&(k=j,j=j.handleEvent),\"function\"==typeof j&&(l=z({},a),va(j,k,[l],c))}}},pb=function(a){return\"string\"==typeof a&&(a=[]),\"number\"!=typeof a.length?[a]:a},qb=function(a){if(a&&1===a.nodeType){var b=function(a){(a||(a=f.event))&&(\"js\"!==a._source&&(a.stopImmediatePropagation(),a.preventDefault()),delete a._source)},c=function(c){(c||(c=f.event))&&(b(c),$a.focus(a))};a.addEventListener(\"mouseover\",c,!1),a.addEventListener(\"mouseout\",b,!1),a.addEventListener(\"mouseenter\",b,!1),a.addEventListener(\"mouseleave\",b,!1),a.addEventListener(\"mousemove\",b,!1),db[a.zcClippingId]={mouseover:c,mouseout:b,mouseenter:b,mouseleave:b,mousemove:b}}},rb=function(a){if(a&&1===a.nodeType){var b=db[a.zcClippingId];if(\"object\"==typeof b&&b){for(var c,d,e=[\"move\",\"leave\",\"enter\",\"out\",\"over\"],f=0,g=e.length;g>f;f++)c=\"mouse\"+e[f],d=b[c],\"function\"==typeof d&&a.removeEventListener(c,d,!1);delete db[a.zcClippingId]}}};$a._createClient=function(){eb.apply(this,y(arguments))},$a.prototype.on=function(){return fb.apply(this,y(arguments))},$a.prototype.off=function(){return gb.apply(this,y(arguments))},$a.prototype.handlers=function(){return hb.apply(this,y(arguments))},$a.prototype.emit=function(){return ib.apply(this,y(arguments))},$a.prototype.clip=function(){return jb.apply(this,y(arguments))},$a.prototype.unclip=function(){return kb.apply(this,y(arguments))},$a.prototype.elements=function(){return lb.apply(this,y(arguments))},$a.prototype.destroy=function(){return mb.apply(this,y(arguments))},$a.prototype.setText=function(a){if(!ab[this.id])throw new Error(\"Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance\");return $a.setData(\"text/plain\",a),this},$a.prototype.setHtml=function(a){if(!ab[this.id])throw new Error(\"Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance\");return $a.setData(\"text/html\",a),this},$a.prototype.setRichText=function(a){if(!ab[this.id])throw new Error(\"Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance\");return $a.setData(\"application/rtf\",a),this},$a.prototype.setData=function(){if(!ab[this.id])throw new Error(\"Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance\");return $a.setData.apply(this,y(arguments)),this},$a.prototype.clearData=function(){if(!ab[this.id])throw new Error(\"Attempted to clear pending clipboard data from a destroyed ZeroClipboard client instance\");return $a.clearData.apply(this,y(arguments)),this},$a.prototype.getData=function(){if(!ab[this.id])throw new Error(\"Attempted to get pending clipboard data from a destroyed ZeroClipboard client instance\");return $a.getData.apply(this,y(arguments))},\"function\"==typeof define&&define.amd?define(function(){return $a}):\"object\"==typeof module&&module&&\"object\"==typeof module.exports&&module.exports?module.exports=$a:a.ZeroClipboard=$a}(function(){return this||window}());",
                "\\ No newline at end of file",
                "diff --git a/js/utils/zeroclipboard/ZeroClipboard.swf b/js/utils/zeroclipboard/ZeroClipboard.swf",
                "deleted file mode 100644",
                "index 1718378d..00000000",
                "Binary files a/js/utils/zeroclipboard/ZeroClipboard.swf and /dev/null differ"
            ],
            "changed_files": [
                "js/utils/zeroclipboard/ZeroClipboard.min.js",
                "js/utils/zeroclipboard/ZeroClipboard.swf"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "732": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [],
            "matched_rules": [
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 732",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "5a80e746b85e7b553e394071f48a38608fae3746",
            "repository": "https://github.com/intelliants/subrion",
            "timestamp": 1529399307,
            "hunks": 4,
            "message": "Fixed Member View Social Link Escape Please, check and merge",
            "diff": [
                "diff --git a/templates/_common/view-member.tpl b/templates/_common/view-member.tpl",
                "index 211efdf5..be3f8785 100644",
                "--- a/templates/_common/view-member.tpl",
                "+++ b/templates/_common/view-member.tpl",
                "@@ -17,12 +17,12 @@",
                "             {if !empty($item.facebook)}",
                "-                <p><a class=\"ia-item__additional__icon\" href=\"{$item.facebook|escape:'url'}\"><span class=\"fa fa-facebook\"></span></a></p>",
                "+                <p><a class=\"ia-item__additional__icon\" href=\"{$item.facebook|escape}\"><span class=\"fa fa-facebook\"></span></a></p>",
                "             {/if}",
                "             {if !empty($item.twitter)}",
                "-                <p><a class=\"ia-item__additional__icon\" href=\"{$item.twitter|escape:'url'}\"><span class=\"fa fa-twitter\"></span></a></p>",
                "+                <p><a class=\"ia-item__additional__icon\" href=\"{$item.twitter|escape}\"><span class=\"fa fa-twitter\"></span></a></p>",
                "             {/if}",
                "             {if !empty($item.gplus)}",
                "-                <p><a class=\"ia-item__additional__icon\" href=\"{$item.gplus|escape:'url'}\"><span class=\"fa fa-google-plus\"></span></a></p>",
                "+                <p><a class=\"ia-item__additional__icon\" href=\"{$item.gplus|escape}\"><span class=\"fa fa-google-plus\"></span></a></p>",
                "             {/if}",
                "             {if !empty($item.linkedin)}",
                "-                <p><a class=\"ia-item__additional__icon\" href=\"{$item.linkedin|escape:'url'}\"><span class=\"fa fa-linkedin\"></span></a></p>",
                "+                <p><a class=\"ia-item__additional__icon\" href=\"{$item.linkedin|escape}\"><span class=\"fa fa-linkedin\"></span></a></p>",
                "             {/if}"
            ],
            "changed_files": [
                "templates/_common/view-member.tpl"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [],
            "matched_rules": []
        },
        {
            "commit_id": "c4eb6f2056cb084f5e294b10b0525ff2f1b0896d",
            "repository": "https://github.com/intelliants/subrion",
            "timestamp": 1530181593,
            "hunks": 2,
            "message": "generateGuestAccessId method implemented in abstract class",
            "diff": [
                "diff --git a/includes/classes/ia.base.module.front.php b/includes/classes/ia.base.module.front.php",
                "index 8f2abec4..527a040e 100644",
                "--- a/includes/classes/ia.base.module.front.php",
                "+++ b/includes/classes/ia.base.module.front.php",
                "@@ -332,7 +332,6 @@ abstract class abstractModuleFront extends abstractCore",
                "-    // this method to be overloaded",
                "-    // each item class should use own token generation logic because of specific set of fields",
                "+    // this method to be overloaded if needed.",
                "     public function generateGuestAccessId(array $itemData)",
                "     {",
                "-        throw new Exception('No guest access key generator method');",
                "+        return md5($this->getItemName() . $itemData['date_added'] . IA_SALT . $itemData['id']);",
                "     }"
            ],
            "changed_files": [
                "includes/classes/ia.base.module.front.php"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [],
            "matched_rules": []
        },
        {
            "commit_id": "999398e8ea1e026793fe9ba584087a50a757c5fd",
            "repository": "https://github.com/intelliants/subrion",
            "timestamp": 1531193932,
            "hunks": 2,
            "message": "Fixed. Rephrased Admin Notifications. Please, check",
            "diff": [
                "diff --git a/install/dump/install.sql b/install/dump/install.sql",
                "index b86a8e2a..693bbe96 100644",
                "--- a/install/dump/install.sql",
                "+++ b/install/dump/install.sql",
                "@@ -1374,3 +1374,3 @@ INSERT INTO `{install:prefix}language` (`key`,`value`,`category`) VALUES",
                " ('are_you_sure_to_delete_selected_members','Are you sure you want to delete selected members?','admin'),",
                "-('are_you_sure_to_delete_selected_members_and_uploads','<b class = \"text-danger\">All uploaded by selected users files (images, and etc.) will be removed too!</b> <br/> Are you sure you want to delete selected members?','admin'),",
                "+('are_you_sure_to_delete_selected_members_and_uploads','<b class = \"text-danger\">Be careful! If you disable this option all files uploaded by a selected users will be deleted when users are deleted. It is not recommended to turn it off.</b> <br/> <strong><p class=\"text-center\" style=\"margin-top: 10px;\">Are you sure you want to delete selected members?</p></strong>','admin'),",
                " ('are_you_sure_to_delete_selected_menus','Are you sure you want to delete selected menus?','admin'),",
                "@@ -1381,3 +1381,3 @@ INSERT INTO `{install:prefix}language` (`key`,`value`,`category`) VALUES",
                " ('are_you_sure_to_delete_this_member','Are you sure you want to delete this member?','admin'),",
                "-('are_you_sure_to_delete_this_member_and_uploads','<b class = \"text-danger\">All uploaded by him files (images, pdfs and etc.) will be removed too!</b> <br/> Are you sure you want to delete this member?','admin'),",
                "+('are_you_sure_to_delete_this_member_and_uploads','<b class = \"text-danger\">Be careful! If you disable this option all files uploaded by a user will be deleted when a user is deleted. It is not recommended to turn it off.</b> <br/> <strong><p class=\"text-center\" style=\"margin-top: 10px;\">Are you sure you want to delete this member?</p></strong>','admin'),",
                " ('are_you_sure_to_delete_this_menu','Are you sure you want to delete this menu?','admin'),"
            ],
            "changed_files": [
                "install/dump/install.sql"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [],
            "matched_rules": []
        },
        {
            "commit_id": "12d6c9e40479dfa41def573a60eaaa447a9c5f35",
            "repository": "https://github.com/intelliants/subrion",
            "timestamp": 1529306703,
            "hunks": 3,
            "message": "Site Map for Blog Module Fixed Dinamic URL for Blog Module.",
            "diff": [
                "diff --git a/modules/blog/includes/classes/ia.admin.blog.php b/modules/blog/includes/classes/ia.admin.blog.php",
                "index 1ee91e58..1bd17a45 100644",
                "--- a/modules/blog/includes/classes/ia.admin.blog.php",
                "+++ b/modules/blog/includes/classes/ia.admin.blog.php",
                "@@ -136,5 +136,8 @@ SQL;",
                "         $this->iaDb->bind($stmt, ['status' => iaCore::STATUS_ACTIVE]);",
                "+",
                "         if ($rows = $this->iaDb->all(['id', 'alias'], $stmt, null, null, self::getTable())) {",
                "+            $page = $this->iaCore->factory('page', iaCore::ADMIN)->getByName('blog', false);",
                "+",
                "             foreach ($rows as $row) {",
                "-                $result[] = IA_URL . 'blog' . IA_URL_DELIMITER . $row['id'] . '-' . $row['alias'];",
                "+                $result[] = IA_CLEAR_URL . $page['alias'] . $row['id'] . '-' . $row['alias'];",
                "             }"
            ],
            "changed_files": [
                "modules/blog/includes/classes/ia.admin.blog.php"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [],
            "matched_rules": []
        },
        {
            "commit_id": "d280616fc2b39226381affcae3c8ce999643772a",
            "repository": "https://github.com/intelliants/subrion",
            "timestamp": 1530252668,
            "hunks": 1,
            "message": "Sitemap generation fixed",
            "diff": [
                "diff --git a/includes/classes/ia.admin.sitemap.php b/includes/classes/ia.admin.sitemap.php",
                "index d87a1527..194422d7 100644",
                "--- a/includes/classes/ia.admin.sitemap.php",
                "+++ b/includes/classes/ia.admin.sitemap.php",
                "@@ -146,3 +146,3 @@ class iaSitemap extends abstractCore",
                "                     if (iaCore::CORE != $module) {",
                "-                        $itemClassInstance = $this->iaCore->factoryItem($itemName);",
                "+                        $itemClassInstance = $this->iaCore->factoryItem($itemName, iaCore::ADMIN);"
            ],
            "changed_files": [
                "includes/classes/ia.admin.sitemap.php"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [],
            "matched_rules": []
        },
        {
            "commit_id": "deaa969d959b40fb1cdf2c8d762a29b81152345c",
            "repository": "https://github.com/intelliants/subrion",
            "timestamp": 1531740148,
            "hunks": 2,
            "message": "Tooltip output format enhanced - Line break support added",
            "diff": [
                "diff --git a/admin/templates/default/field-type-content-manage.tpl b/admin/templates/default/field-type-content-manage.tpl",
                "index 3901233f..735f5491 100644",
                "--- a/admin/templates/default/field-type-content-manage.tpl",
                "+++ b/admin/templates/default/field-type-content-manage.tpl",
                "@@ -23,3 +23,3 @@",
                "         {$tooltip = {lang key=\"field_tooltip_{$field.item}_{$field.name}\" default=''}}",
                "-        {if $tooltip}<div class=\"help-block\">{$tooltip|escape}</div>{/if}",
                "+        {if $tooltip}<div class=\"help-block\">{$tooltip|escape|nl2br}</div>{/if}",
                "     </div>",
                "diff --git a/templates/_common/field-type-content-manage.tpl b/templates/_common/field-type-content-manage.tpl",
                "index fd2db290..051fd4a2 100644",
                "--- a/templates/_common/field-type-content-manage.tpl",
                "+++ b/templates/_common/field-type-content-manage.tpl",
                "@@ -370,3 +370,3 @@ $(function() {",
                "         {assign tooltip {lang key=\"field_tooltip_{$field.item}_{$field.name}\" default=''}}",
                "-        {if $tooltip}<p class=\"help-block help-block--tooltip\">{$tooltip|escape}</p>{/if}",
                "+        {if $tooltip}<p class=\"help-block help-block--tooltip\">{$tooltip|escape|nl2br}</p>{/if}",
                " </div>"
            ],
            "changed_files": [
                "admin/templates/default/field-type-content-manage.tpl",
                "templates/_common/field-type-content-manage.tpl"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [],
            "matched_rules": []
        }
    ]
}
