{
    "advisory_record": {
        "cve_id": "CVE-2018-1000613",
        "description": "Legion of the Bouncy Castle Legion of the Bouncy Castle Java Cryptography APIs 1.58 up to but not including 1.60 contains a CWE-470: Use of Externally-Controlled Input to Select Classes or Code ('Unsafe Reflection') vulnerability in XMSS/XMSS^MT private key deserialization that can result in Deserializing an XMSS/XMSS^MT private key can result in the execution of unexpected code. This attack appear to be exploitable via A handcrafted private key can include references to unexpected classes which will be picked up from the class path for the executing application. This vulnerability appears to have been fixed in 1.60 and later.",
        "reserved_timestamp": 1530230400,
        "published_timestamp": 1531166400,
        "updated_timestamp": 1623691203,
        "repository_url": null,
        "references": {
            "": 39,
            "commit::4092ede58da51af9a21e4825fbad0d9a3ef5a223": 6,
            "commit::cd98322b171b15b3f88c5ec871175147893c31e6": 6,
            "https://access.redhat.com/support/": 5,
            "https://access.redhat.com/downloads/": 4,
            "https://access.redhat.com/errata/": 3,
            "https://access.redhat.com/labs/": 3,
            "http://lists.opensuse.org/opensuse-security-announce/2020-05/msg00011.html": 2,
            "https://www.oracle.com/security-alerts/cpuapr2020.html": 2,
            "https://www.oracle.com/technetwork/security-advisory/cpujan2019-5072801.html": 2,
            "https://www.oracle.com/technetwork/security-advisory/cpuapr2019-5072813.html": 2,
            "https://www.oracle.com/technetwork/security-advisory/cpujul2019-5072835.html": 2,
            "https://lists.apache.org/thread.html/rf1bbc0ea4a9f014cf94df9a12a6477d24a27f52741dbc87f2fd52ff2%40%3Cissues.geode.apache.org%3E": 2,
            "https://www.oracle.com/security-alerts/cpuoct2020.html": 2,
            "https://security.netapp.com/advisory/ntap-20190204-0003/": 2,
            "https://www.oracle.com/security-alerts/cpuApr2021.html": 2,
            "https://access.redhat.com/security/cve/cve-2018-1000613": 2,
            "http://www.bouncycastle.org/releasenotes.html": 2,
            "https://security.netapp.com/en": 2,
            "https://access.redhat.com/management/": 2,
            "https://access.redhat.com/": 2,
            "https://access.redhat.com/products/red-hat-enterprise-linux/": 2,
            "https://access.redhat.com/products/red-hat-openshift-container-platform": 2,
            "https://access.redhat.com/products/red-hat-ansible-automation-platform/": 2,
            "https://access.redhat.com/products/": 2,
            "https://access.redhat.com/documentation": 2,
            "https://access.redhat.com/product-life-cycles/": 2,
            "https://access.redhat.com/security": 2,
            "https://access.redhat.com/security/security-updates/#/security-advisories": 2,
            "https://access.redhat.com/security/security-updates/#/cve": 2,
            "https://access.redhat.com/support/contact/": 2,
            "https://status.redhat.com": 2,
            "https://www.suse.com/security/cve/CVE-2017-13098.html": 1,
            "https://www.suse.com/security/cve/CVE-2018-1000613.html": 1,
            "https://bugzilla.suse.com/1072697": 1,
            "https://bugzilla.suse.com/1100694": 1,
            "http://hyperkitty.readthedocs.org": 1,
            "https://www.netapp.com/": 1,
            "https://mysupport.netapp.com": 1,
            "https://community.netapp.com": 1,
            "https://www.netapp.com/company/contact-us/": 1,
            "https://security.netapp.com": 1,
            "https://security.netapp.com/advisory/": 1,
            "https://security.netapp.com/bulletins/": 1,
            "https://security.netapp.com/contact/": 1,
            "https://security.netapp.com/policy/": 1,
            "https://security.netapp.com/resources/": 1,
            "https://security.netapp.com/certs/": 1,
            "https://security.netapp.com/advisory": 1,
            "https://security.netapp.com/advisory/ntap-20190204-0003": 1,
            "https://www.netapp.com/company/legal/privacy-policy/": 1,
            "https://nvd.nist.gov/vuln/detail/CVE-2018-1000180": 1,
            "https://nvd.nist.gov/vuln/detail/CVE-2018-1000613": 1,
            "https://www.bouncycastle.org/jira/browse/BJA-694": 1,
            "https://www.bouncycastle.org/latest_releases.html": 1,
            "https://mysupport.netapp.com/products/ocwfa/5.0/": 1,
            "https://mysupport.netapp.com/site/downloads/": 1,
            "http://mysupport.netapp.com": 1,
            "https://security.netapp.com/advisory/NTAP-20190204-0003": 1,
            "https://www.netapp.com/forms/site-feedback/": 1,
            "https://access.redhat.com/downloads/content/package-browser": 1,
            "https://catalog.redhat.com/software/containers/explore/": 1,
            "https://access.redhat.com/articles/1202803": 1,
            "https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution": 1,
            "https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article": 1,
            "https://access.redhat.com/documentation/en/red_hat_enterprise_linux": 1,
            "https://access.redhat.com/documentation/en/openshift_container_platform": 1,
            "https://access.redhat.com/documentation/en/red_hat_ansible_automation_platform": 1,
            "https://access.redhat.com/documentation/": 1,
            "https://access.redhat.com/security/": 1,
            "https://access.redhat.com/security/vulnerabilities": 1,
            "https://access.redhat.com/security/data": 1,
            "https://access.redhat.com/security/security-updates/#/security-labs": 1,
            "https://access.redhat.com/security/updates/backporting/": 1,
            "https://access.redhat.com/support/cases/": 1,
            "https://access.redhat.com/support/cases/#/troubleshoot": 1,
            "https://access.redhat.com/community": 1,
            "https://access.redhat.com/community/": 1,
            "https://access.redhat.com/discussions/": 1,
            "https://access.redhat.com/announcements/": 1,
            "https://access.redhat.com/accelerators/": 1,
            "https://access.redhat.com/jbossnetwork/restricted/listSoftware.html": 1,
            "https://cloud.redhat.com/insights": 1,
            "https://access.redhat.com/changeLanguage?language=en": 1,
            "https://access.redhat.com/changeLanguage?language=fr": 1,
            "https://access.redhat.com/changeLanguage?language=ko": 1,
            "https://access.redhat.com/changeLanguage?language=ja": 1,
            "https://access.redhat.com/changeLanguage?language=zh_CN": 1,
            "https://access.redhat.com/products/red-hat-satellite/": 1,
            "https://access.redhat.com/products/red-hat-subscription-management/": 1,
            "https://access.redhat.com/products/red-hat-insights/": 1,
            "https://access.redhat.com/products/red-hat-openstack-platform/": 1,
            "https://access.redhat.com/products/red-hat-openshift-container-platform/": 1,
            "https://access.redhat.com/products/red-hat-openshift-ai/": 1,
            "https://access.redhat.com/products/openshift-dedicated-red-hat/": 1,
            "https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/": 1,
            "https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/": 1,
            "https://access.redhat.com/products/red-hat-quay/": 1,
            "https://access.redhat.com/products/red-hat-openshift-dev-spaces": 1,
            "https://access.redhat.com/products/red-hat-openshift-service-aws": 1,
            "https://access.redhat.com/products/red-hat-storage/": 1,
            "https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/": 1,
            "https://access.redhat.com/products/red-hat-ceph-storage/": 1,
            "https://access.redhat.com/products/red-hat-openshift-data-foundation": 1,
            "https://access.redhat.com/products/red-hat-runtimes/": 1,
            "https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/": 1,
            "https://access.redhat.com/products/red-hat-data-grid/": 1,
            "https://access.redhat.com/products/red-hat-jboss-web-server/": 1,
            "https://access.redhat.com/products/red-hat-build-of-keycloak/": 1,
            "https://access.redhat.com/products/spring-boot/": 1,
            "https://access.redhat.com/products/nodejs/": 1,
            "https://access.redhat.com/products/quarkus/": 1,
            "https://access.redhat.com/products/red-hat-application-foundations/": 1,
            "https://access.redhat.com/products/red-hat-fuse/": 1,
            "https://access.redhat.com/products/red-hat-amq/": 1,
            "https://access.redhat.com/products/red-hat-3scale/": 1,
            "https://redhat.com/en": 1,
            "https://twitter.com/RedHat": 1,
            "https://access.redhat.com/management": 1,
            "https://access.redhat.com/support": 1,
            "https://access.redhat.com/support/customer-service": 1,
            "https://access.redhat.com/articles/33844": 1,
            "https://access.redhat.com/help/login_assistance": 1,
            "https://www.redhat.com/en/trust": 1,
            "https://www.redhat.com/en/about/browser-support": 1,
            "https://www.redhat.com/en/about/digital-accessibility": 1,
            "https://access.redhat.com/recognition/": 1,
            "https://access.redhat.com/help/colophon/": 1,
            "https://www.redhat.com/": 1,
            "http://developers.redhat.com/": 1,
            "https://connect.redhat.com/": 1,
            "https://cloud.redhat.com/": 1,
            "https://access.redhat.com/subscription-value": 1,
            "https://www.redhat.com/about/": 1,
            "http://jobs.redhat.com": 1,
            "https://redhat.com/en/about/company": 1,
            "https://redhat.com/en/jobs": 1,
            "https://redhat.com/en/events": 1,
            "https://redhat.com/en/about/office-locations": 1,
            "https://redhat.com/en/contact": 1,
            "https://redhat.com/en/blog": 1,
            "https://redhat.com/en/about/our-culture/diversity-equity-inclusion": 1,
            "https://coolstuff.redhat.com/": 1,
            "https://www.redhat.com/en/summit": 1,
            "https://redhat.com/en/about/privacy-policy": 1,
            "https://redhat.com/en/about/terms-use": 1,
            "https://redhat.com/en/about/all-policies-guidelines": 1,
            "https://redhat.com/en/about/digital-accessibility": 1
        },
        "affected_products": [
            "Java",
            "Input",
            "Unsafe",
            "Use",
            "Reflection",
            "Classes",
            "Code",
            "Castle",
            "XMSS",
            "Bouncy",
            "Select",
            "Controlled",
            "n/a",
            "Legion",
            "Cryptography"
        ],
        "versions": {
            "status": "affected",
            "version": "n/a"
        },
        "files": [
            "XMSS^MT",
            "APIs",
            "CWE-470",
            "Externally-Controlled"
        ],
        "keywords": [
            "handcraft",
            "result",
            "attack",
            "controlled",
            "java",
            "reflection",
            "deserialization",
            "classes",
            "bouncy",
            "unsafe",
            "class",
            "xmss",
            "deserialize",
            "execution",
            "reference",
            "input",
            "select",
            "vulnerability",
            "legion",
            "appear",
            "contain",
            "castle",
            "execute",
            "pick",
            "path",
            "application",
            "include",
            "cryptography",
            "code"
        ],
        "files_extension": [],
        "has_fixing_commit": true
    },
    "commits": [
        {
            "commit_id": "4092ede58da51af9a21e4825fbad0d9a3ef5a223",
            "repository": "https://github.com/bcgit/bc-java",
            "timestamp": 1520046394,
            "hunks": 28,
            "message": "added additional checking to XMSS BDS tree parsing. Failures now mostly cause IOException",
            "diff": [
                "diff --git a/core/src/main/java/org/bouncycastle/pqc/crypto/gmss/GMSSKeyPairGenerator.java b/core/src/main/java/org/bouncycastle/pqc/crypto/gmss/GMSSKeyPairGenerator.java",
                "index 013441ec5..3b7d8a6ae 100644",
                "--- a/core/src/main/java/org/bouncycastle/pqc/crypto/gmss/GMSSKeyPairGenerator.java",
                "+++ b/core/src/main/java/org/bouncycastle/pqc/crypto/gmss/GMSSKeyPairGenerator.java",
                "@@ -180,22 +180,15 @@ public class GMSSKeyPairGenerator",
                "         {",
                "-            GMSSRootCalc tree = new GMSSRootCalc(this.heightOfTrees[h], this.K[h], digestProvider);",
                "-            try",
                "-            {",
                "-                // on lowest layer no lower root is available, so just call",
                "-                // the method with null as first parameter",
                "-                if (h == numLayer - 1)",
                "-                {",
                "-                    tree = this.generateCurrentAuthpathAndRoot(null, currentStack[h], seeds[h], h);",
                "-                }",
                "-                else",
                "-                // otherwise call the method with the former computed root",
                "-                // value",
                "-                {",
                "-                    tree = this.generateCurrentAuthpathAndRoot(currentRoots[h + 1], currentStack[h], seeds[h], h);",
                "-                }",
                "+            GMSSRootCalc tree;",
                "+            // on lowest layer no lower root is available, so just call",
                "+            // the method with null as first parameter",
                "+            if (h == numLayer - 1)",
                "+            {",
                "+                tree = this.generateCurrentAuthpathAndRoot(null, currentStack[h], seeds[h], h);",
                "             }",
                "-            catch (Exception e1)",
                "+            else",
                "+            // otherwise call the method with the former computed root",
                "+            // value",
                "             {",
                "-                e1.printStackTrace();",
                "+                tree = this.generateCurrentAuthpathAndRoot(currentRoots[h + 1], currentStack[h], seeds[h], h);",
                "             }",
                "diff --git a/core/src/main/java/org/bouncycastle/pqc/crypto/rainbow/RainbowParameters.java b/core/src/main/java/org/bouncycastle/pqc/crypto/rainbow/RainbowParameters.java",
                "index 147c55e93..926f1ba4b 100644",
                "--- a/core/src/main/java/org/bouncycastle/pqc/crypto/rainbow/RainbowParameters.java",
                "+++ b/core/src/main/java/org/bouncycastle/pqc/crypto/rainbow/RainbowParameters.java",
                "@@ -46,10 +46,4 @@ public class RainbowParameters",
                "         this.vi = vi;",
                "-        try",
                "-        {",
                "-            checkParams();",
                "-        }",
                "-        catch (Exception e)",
                "-        {",
                "-            e.printStackTrace();",
                "-        }",
                "+",
                "+        checkParams();",
                "     }",
                "@@ -57,3 +51,2 @@ public class RainbowParameters",
                "     private void checkParams()",
                "-        throws Exception",
                "     {",
                "@@ -61,3 +54,3 @@ public class RainbowParameters",
                "         {",
                "-            throw new Exception(\"no layers defined.\");",
                "+            throw new IllegalArgumentException(\"no layers defined.\");",
                "         }",
                "@@ -69,3 +62,3 @@ public class RainbowParameters",
                "                 {",
                "-                    throw new Exception(",
                "+                    throw new IllegalArgumentException(",
                "                         \"v[i] has to be smaller than v[i+1]\");",
                "@@ -76,3 +69,3 @@ public class RainbowParameters",
                "         {",
                "-            throw new Exception(",
                "+            throw new IllegalArgumentException(",
                "                 \"Rainbow needs at least 1 layer, such that v1 < v2.\");",
                "diff --git a/core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSMTPrivateKeyParameters.java b/core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSMTPrivateKeyParameters.java",
                "index e0d6bb701..d9c221664 100644",
                "--- a/core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSMTPrivateKeyParameters.java",
                "+++ b/core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSMTPrivateKeyParameters.java",
                "@@ -70,6 +70,8 @@ public final class XMSSMTPrivateKeyParameters",
                "-            BDSStateMap bdsImport = null;",
                "             try",
                "             {",
                "-                bdsImport = (BDSStateMap)XMSSUtil.deserialize(bdsStateBinary);",
                "+                BDSStateMap bdsImport = (BDSStateMap)XMSSUtil.deserialize(bdsStateBinary, BDSStateMap.class);",
                "+",
                "+                bdsImport.setXMSS(builder.xmss);",
                "+                bdsState = bdsImport;",
                "             }",
                "@@ -77,3 +79,3 @@ public final class XMSSMTPrivateKeyParameters",
                "             {",
                "-                e.printStackTrace();",
                "+                throw new IllegalArgumentException(e.getMessage(), e);",
                "             }",
                "@@ -81,6 +83,4 @@ public final class XMSSMTPrivateKeyParameters",
                "             {",
                "-                e.printStackTrace();",
                "+                throw new IllegalArgumentException(e.getMessage(), e);",
                "             }",
                "-            bdsImport.setXMSS(builder.xmss);",
                "-            bdsState = bdsImport;",
                "         }",
                "@@ -262,6 +262,5 @@ public final class XMSSMTPrivateKeyParameters",
                " \t\t/* concatenate bdsState */",
                "-        byte[] bdsStateOut = null;",
                "         try",
                "         {",
                "-            bdsStateOut = XMSSUtil.serialize(bdsState);",
                "+            return Arrays.concatenate(out, XMSSUtil.serialize(bdsState));",
                "         }",
                "@@ -269,6 +268,4 @@ public final class XMSSMTPrivateKeyParameters",
                "         {",
                "-            e.printStackTrace();",
                "-            throw new RuntimeException(\"error serializing bds state\");",
                "+            throw new IllegalStateException(\"error serializing bds state: \" + e.getMessage(), e);",
                "         }",
                "-        return Arrays.concatenate(out, bdsStateOut);",
                "     }",
                "diff --git a/core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSPrivateKeyParameters.java b/core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSPrivateKeyParameters.java",
                "index 3d62ca21e..85622af52 100644",
                "--- a/core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSPrivateKeyParameters.java",
                "+++ b/core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSPrivateKeyParameters.java",
                "@@ -88,6 +88,12 @@ public final class XMSSPrivateKeyParameters",
                "             byte[] bdsStateBinary = XMSSUtil.extractBytesAtOffset(privateKey, position, privateKey.length - position);",
                "-            BDS bdsImport = null;",
                "             try",
                "             {",
                "-                bdsImport = (BDS)XMSSUtil.deserialize(bdsStateBinary);",
                "+                BDS bdsImport = (BDS)XMSSUtil.deserialize(bdsStateBinary, BDS.class);",
                "+                bdsImport.setXMSS(builder.xmss);",
                "+                bdsImport.validate();",
                "+                if (bdsImport.getIndex() != index)",
                "+                {",
                "+                    throw new IllegalStateException(\"serialized BDS has wrong index\");",
                "+                }",
                "+                bdsState = bdsImport;",
                "             }",
                "@@ -95,3 +101,3 @@ public final class XMSSPrivateKeyParameters",
                "             {",
                "-                e.printStackTrace();",
                "+                throw new IllegalArgumentException(e.getMessage(), e);",
                "             }",
                "@@ -99,11 +105,4 @@ public final class XMSSPrivateKeyParameters",
                "             {",
                "-                e.printStackTrace();",
                "-            }",
                "-            bdsImport.setXMSS(builder.xmss);",
                "-            bdsImport.validate();",
                "-            if (bdsImport.getIndex() != index)",
                "-            {",
                "-                throw new IllegalStateException(\"serialized BDS has wrong index\");",
                "+                throw new IllegalArgumentException(e.getMessage(), e);",
                "             }",
                "-            bdsState = bdsImport;",
                "         }",
                "diff --git a/core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSUtil.java b/core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSUtil.java",
                "index 4eaee74a4..3a707f455 100644",
                "--- a/core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSUtil.java",
                "+++ b/core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSUtil.java",
                "@@ -323,3 +323,3 @@ public class XMSSUtil",
                "-    public static Object deserialize(byte[] data)",
                "+    public static Object deserialize(byte[] data, Class clazz)",
                "         throws IOException, ClassNotFoundException",
                "@@ -328,3 +328,16 @@ public class XMSSUtil",
                "         ObjectInputStream is = new ObjectInputStream(in);",
                "-        return is.readObject();",
                "+        Object obj = is.readObject();",
                "+",
                "+        if (is.available() != 0)",
                "+        {",
                "+            throw new IOException(\"unexpected data found at end of ObjectInputStream\");",
                "+        }",
                "+        if (clazz.isInstance(obj))",
                "+        {",
                "+            return obj;",
                "+        }",
                "+        else",
                "+        {",
                "+            throw new IOException(\"unexpected class found in ObjectInputStream\");",
                "+        }",
                "     }",
                "diff --git a/core/src/main/java/org/bouncycastle/pqc/math/linearalgebra/GF2nField.java b/core/src/main/java/org/bouncycastle/pqc/math/linearalgebra/GF2nField.java",
                "index 22e299f01..091a20031 100644",
                "--- a/core/src/main/java/org/bouncycastle/pqc/math/linearalgebra/GF2nField.java",
                "+++ b/core/src/main/java/org/bouncycastle/pqc/math/linearalgebra/GF2nField.java",
                "@@ -157,12 +157,5 @@ public abstract class GF2nField",
                "         {",
                "-            try",
                "-            {",
                "-                a[i] = new GF2Polynomial(matrix[i]);",
                "-                inv[i] = new GF2Polynomial(mDegree);",
                "-                inv[i].setBit(mDegree - 1 - i);",
                "-            }",
                "-            catch (RuntimeException BDNEExc)",
                "-            {",
                "-                BDNEExc.printStackTrace();",
                "-            }",
                "+            a[i] = new GF2Polynomial(matrix[i]);",
                "+            inv[i] = new GF2Polynomial(mDegree);",
                "+            inv[i].setBit(mDegree - 1 - i);",
                "         }",
                "diff --git a/docs/releasenotes.html b/docs/releasenotes.html",
                "index 823b2f807..004bd8c22 100644",
                "--- a/docs/releasenotes.html",
                "+++ b/docs/releasenotes.html",
                "@@ -30,2 +30,3 @@ Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2018",
                " <li>Base64/UrlBase64 would throw an exception on a zero length string. This has been fixed.</li>",
                "+<li>XMSS applies further validation to deserialisation of the BDS tree so that failure occurs as soon as tampering is detected.</li>",
                " </ul>",
                "diff --git a/prov/src/main/java/org/bouncycastle/pqc/jcajce/provider/xmss/BCXMSSMTPrivateKey.java b/prov/src/main/java/org/bouncycastle/pqc/jcajce/provider/xmss/BCXMSSMTPrivateKey.java",
                "index be83bc4b0..49e4dcf09 100644",
                "--- a/prov/src/main/java/org/bouncycastle/pqc/jcajce/provider/xmss/BCXMSSMTPrivateKey.java",
                "+++ b/prov/src/main/java/org/bouncycastle/pqc/jcajce/provider/xmss/BCXMSSMTPrivateKey.java",
                "@@ -54,3 +54,3 @@ public class BCXMSSMTPrivateKey",
                "             {",
                "-                keyBuilder.withBDSState((BDSStateMap)XMSSUtil.deserialize(xmssMtPrivateKey.getBdsState()));",
                "+                keyBuilder.withBDSState((BDSStateMap)XMSSUtil.deserialize(xmssMtPrivateKey.getBdsState(), BDSStateMap.class));",
                "             }",
                "diff --git a/prov/src/main/java/org/bouncycastle/pqc/jcajce/provider/xmss/BCXMSSPrivateKey.java b/prov/src/main/java/org/bouncycastle/pqc/jcajce/provider/xmss/BCXMSSPrivateKey.java",
                "index 461c4cbbb..4f792f22c 100644",
                "--- a/prov/src/main/java/org/bouncycastle/pqc/jcajce/provider/xmss/BCXMSSPrivateKey.java",
                "+++ b/prov/src/main/java/org/bouncycastle/pqc/jcajce/provider/xmss/BCXMSSPrivateKey.java",
                "@@ -53,3 +53,3 @@ public class BCXMSSPrivateKey",
                "             {",
                "-                keyBuilder.withBDSState((BDS)XMSSUtil.deserialize(xmssPrivateKey.getBdsState()));",
                "+                keyBuilder.withBDSState((BDS)XMSSUtil.deserialize(xmssPrivateKey.getBdsState(), BDS.class));",
                "             }"
            ],
            "changed_files": [
                "core/src/main/java/org/bouncycastle/pqc/crypto/gmss/GMSSKeyPairGenerator.java",
                "core/src/main/java/org/bouncycastle/pqc/crypto/rainbow/RainbowParameters.java",
                "core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSMTPrivateKeyParameters.java",
                "core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSPrivateKeyParameters.java",
                "core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSUtil.java",
                "core/src/main/java/org/bouncycastle/pqc/math/linearalgebra/GF2nField.java",
                "docs/releasenotes.html",
                "prov/src/main/java/org/bouncycastle/pqc/jcajce/provider/xmss/BCXMSSMTPrivateKey.java",
                "prov/src/main/java/org/bouncycastle/pqc/jcajce/provider/xmss/BCXMSSPrivateKey.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [
                [
                    "no-tag",
                    "b38c8c371cbee58766f18368573bc2215be312c9"
                ],
                [
                    "no-tag",
                    "540a427e811247979b7be75c4c9cee94c78db69b"
                ]
            ],
            "tags": [
                "r1v60"
            ],
            "matched_rules": [
                {
                    "id": "COMMIT_IN_REFERENCE",
                    "message": "This commit is mentioned 6 times in the references.",
                    "relevance": 64
                },
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: xmss",
                    "relevance": 4
                },
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: castle, bouncy, xmss",
                    "relevance": 4
                },
                {
                    "id": "COMMIT_HAS_TWINS",
                    "message": "This commit has one or more twins.",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "cd98322b171b15b3f88c5ec871175147893c31e6",
            "repository": "https://github.com/bcgit/bc-java",
            "timestamp": 1520052854,
            "hunks": 3,
            "message": "added full filtering for BDS data.",
            "diff": [
                "diff --git a/core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSUtil.java b/core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSUtil.java",
                "index ea8fa64aa..79c63ac80 100644",
                "--- a/core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSUtil.java",
                "+++ b/core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSUtil.java",
                "@@ -10,2 +10,4 @@ import java.io.ObjectOutputStream;",
                " import java.io.ObjectStreamClass;",
                "+import java.util.HashSet;",
                "+import java.util.Set;",
                "@@ -384,2 +386,20 @@ public class XMSSUtil",
                "     {",
                "+        private static final Set<String> components = new HashSet<>();",
                "+",
                "+        static",
                "+        {",
                "+            components.add(\"java.util.TreeMap\");",
                "+            components.add(\"java.lang.Integer\");",
                "+            components.add(\"java.lang.Number\");",
                "+            components.add(\"org.bouncycastle.pqc.crypto.xmss.BDS\");",
                "+            components.add(\"java.util.ArrayList\");",
                "+            components.add(\"org.bouncycastle.pqc.crypto.xmss.XMSSNode\");",
                "+            components.add(\"[B\");",
                "+            components.add(\"java.util.LinkedList\");",
                "+            components.add(\"java.util.Stack\");",
                "+            components.add(\"java.util.Vector\");",
                "+            components.add(\"[Ljava.lang.Object;\");",
                "+            components.add(\"org.bouncycastle.pqc.crypto.xmss.BDSTreeHash\");",
                "+        }",
                "+",
                "         private final Class mainClass;",
                "@@ -411,2 +431,10 @@ public class XMSSUtil",
                "             }",
                "+            else",
                "+            {",
                "+                if (!components.contains(desc.getName()))",
                "+                {",
                "+                    throw new InvalidClassException(",
                "+                          \"unexpected class: \", desc.getName());",
                "+                }",
                "+            }",
                "             return super.resolveClass(desc);"
            ],
            "changed_files": [
                "core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSUtil.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [
                [
                    "no-tag",
                    "8e9f4a16c923b8793eb053533fe5be46ce1ca695"
                ],
                [
                    "no-tag",
                    "5f8d43ab01df50a83e6b5cf6c400d8537fd938c6"
                ]
            ],
            "tags": [
                "r1v60"
            ],
            "matched_rules": [
                {
                    "id": "COMMIT_IN_REFERENCE",
                    "message": "This commit is mentioned 6 times in the references.",
                    "relevance": 64
                },
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: castle, bouncy, xmss",
                    "relevance": 4
                },
                {
                    "id": "COMMIT_HAS_TWINS",
                    "message": "This commit has one or more twins.",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "6b2d39821c2e27664847f4f9d7acfa850ad58e5c",
            "repository": "https://github.com/bcgit/bc-java",
            "timestamp": 1520070426,
            "hunks": 3,
            "message": "Return empty byte array instead of null, for the null session ID",
            "diff": [
                "diff --git a/tls/src/main/java/org/bouncycastle/jsse/provider/ProvSSLSessionImpl.java b/tls/src/main/java/org/bouncycastle/jsse/provider/ProvSSLSessionImpl.java",
                "index 151e9c87b..7c5f1f324 100644",
                "--- a/tls/src/main/java/org/bouncycastle/jsse/provider/ProvSSLSessionImpl.java",
                "+++ b/tls/src/main/java/org/bouncycastle/jsse/provider/ProvSSLSessionImpl.java",
                "@@ -22,2 +22,3 @@ import org.bouncycastle.tls.SessionParameters;",
                " import org.bouncycastle.tls.TlsSession;",
                "+import org.bouncycastle.tls.TlsUtils;",
                " import org.bouncycastle.util.Arrays;",
                "@@ -137,5 +138,6 @@ class ProvSSLSessionImpl",
                "     {",
                "-        return tlsSession == null",
                "+        byte[] id = tlsSession == null",
                "             ?   null",
                "             :   Arrays.clone(tlsSession.getSessionID());",
                "+        return id == null ? TlsUtils.EMPTY_BYTES : id;",
                "     }"
            ],
            "changed_files": [
                "tls/src/main/java/org/bouncycastle/jsse/provider/ProvSSLSessionImpl.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [
                [
                    "no-tag",
                    "7d1d2804d55d45aa1992db8aa60571dcedc613fe"
                ],
                [
                    "no-tag",
                    "dd47a032f8064ff58f0355b0fcda42f5c5d1384e"
                ]
            ],
            "tags": [
                "r1v60"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: castle, bouncy",
                    "relevance": 4
                },
                {
                    "id": "COMMIT_HAS_TWINS",
                    "message": "This commit has one or more twins.",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "22906c6c75685ed2ccffeae3fec114409ceba66f",
            "repository": "https://github.com/bcgit/bc-java",
            "timestamp": 1520236366,
            "hunks": 7,
            "message": "added methods for extract Issuer Alternate and Subject Alternate Names.",
            "diff": [
                "diff --git a/pkix/src/main/java/org/bouncycastle/cert/jcajce/JcaX509ExtensionUtils.java b/pkix/src/main/java/org/bouncycastle/cert/jcajce/JcaX509ExtensionUtils.java",
                "index 0838f0895..63c5d57fb 100644",
                "--- a/pkix/src/main/java/org/bouncycastle/cert/jcajce/JcaX509ExtensionUtils.java",
                "+++ b/pkix/src/main/java/org/bouncycastle/cert/jcajce/JcaX509ExtensionUtils.java",
                "@@ -10,3 +10,9 @@ import java.security.PublicKey;",
                " import java.security.cert.CertificateEncodingException;",
                "+import java.security.cert.CertificateParsingException;",
                " import java.security.cert.X509Certificate;",
                "+import java.util.ArrayList;",
                "+import java.util.Collection;",
                "+import java.util.Collections;",
                "+import java.util.Enumeration;",
                "+import java.util.List;",
                "@@ -14,4 +20,8 @@ import javax.security.auth.x500.X500Principal;",
                "+import org.bouncycastle.asn1.ASN1ObjectIdentifier;",
                " import org.bouncycastle.asn1.ASN1OctetString;",
                " import org.bouncycastle.asn1.ASN1Primitive;",
                "+import org.bouncycastle.asn1.ASN1String;",
                "+import org.bouncycastle.asn1.DEROctetString;",
                "+import org.bouncycastle.asn1.DERSequence;",
                " import org.bouncycastle.asn1.oiw.OIWObjectIdentifiers;",
                "@@ -20,2 +30,3 @@ import org.bouncycastle.asn1.x509.AlgorithmIdentifier;",
                " import org.bouncycastle.asn1.x509.AuthorityKeyIdentifier;",
                "+import org.bouncycastle.asn1.x509.Extension;",
                " import org.bouncycastle.asn1.x509.GeneralName;",
                "@@ -26,2 +37,3 @@ import org.bouncycastle.cert.X509ExtensionUtils;",
                " import org.bouncycastle.operator.DigestCalculator;",
                "+import org.bouncycastle.util.Integers;",
                "@@ -114,2 +126,69 @@ public class JcaX509ExtensionUtils",
                "+    public static Collection getIssuerAlternativeNames(X509Certificate cert)",
                "+            throws CertificateParsingException",
                "+    {",
                "+        byte[] extVal = cert.getExtensionValue(Extension.issuerAlternativeName.getId());",
                "+",
                "+        return getAlternativeNames(extVal);",
                "+    }",
                "+",
                "+    public static Collection getSubjectAlternativeNames(X509Certificate cert)",
                "+            throws CertificateParsingException",
                "+    {",
                "+        byte[] extVal = cert.getExtensionValue(Extension.subjectAlternativeName.getId());",
                "+",
                "+        return getAlternativeNames(extVal);",
                "+    }",
                "+",
                "+    private static Collection getAlternativeNames(byte[] extVal)",
                "+        throws CertificateParsingException",
                "+    {",
                "+        if (extVal == null)",
                "+        {",
                "+            return Collections.EMPTY_LIST;",
                "+        }",
                "+        try",
                "+        {",
                "+            Collection temp = new ArrayList();",
                "+            Enumeration it = DERSequence.getInstance(parseExtensionValue(extVal)).getObjects();",
                "+            while (it.hasMoreElements())",
                "+            {",
                "+                GeneralName genName = GeneralName.getInstance(it.nextElement());",
                "+                List list = new ArrayList();",
                "+                list.add(Integers.valueOf(genName.getTagNo()));",
                "+                switch (genName.getTagNo())",
                "+                {",
                "+                case GeneralName.ediPartyName:",
                "+                case GeneralName.x400Address:",
                "+                case GeneralName.otherName:",
                "+                    list.add(genName.getName().toASN1Primitive());",
                "+                    break;",
                "+                case GeneralName.directoryName:",
                "+                    list.add(X500Name.getInstance(genName.getName()).toString());",
                "+                    break;",
                "+                case GeneralName.dNSName:",
                "+                case GeneralName.rfc822Name:",
                "+                case GeneralName.uniformResourceIdentifier:",
                "+                    list.add(((ASN1String)genName.getName()).getString());",
                "+                    break;",
                "+                case GeneralName.registeredID:",
                "+                    list.add(ASN1ObjectIdentifier.getInstance(genName.getName()).getId());",
                "+                    break;",
                "+                case GeneralName.iPAddress:",
                "+                    list.add(DEROctetString.getInstance(genName.getName()).getOctets());",
                "+                    break;",
                "+                default:",
                "+                    throw new IOException(\"Bad tag number: \" + genName.getTagNo());",
                "+                }",
                "+",
                "+                temp.add(list);",
                "+            }",
                "+            return Collections.unmodifiableCollection(temp);",
                "+        }",
                "+        catch (Exception e)",
                "+        {",
                "+            throw new CertificateParsingException(e.getMessage());",
                "+        }",
                "+    }",
                "+",
                "     private static class SHA1DigestCalculator"
            ],
            "changed_files": [
                "pkix/src/main/java/org/bouncycastle/cert/jcajce/JcaX509ExtensionUtils.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [
                [
                    "no-tag",
                    "57d48151d50aad462ea3e89974329507325df52e"
                ],
                [
                    "no-tag",
                    "fd80d43c23a6e3f51e936d8ec77fc69281dec191"
                ]
            ],
            "tags": [
                "r1v60"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: castle, bouncy",
                    "relevance": 4
                },
                {
                    "id": "COMMIT_HAS_TWINS",
                    "message": "This commit has one or more twins.",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "cc24914c7e69b3737507d23be855bd58dc7938b5",
            "repository": "https://github.com/bcgit/bc-java",
            "timestamp": 1520395187,
            "hunks": 2,
            "message": "added stub provider to prevent issues with -Djava.security.debug",
            "diff": [
                "diff --git a/prov/src/main/java/org/bouncycastle/jcajce/provider/drbg/DRBG.java b/prov/src/main/java/org/bouncycastle/jcajce/provider/drbg/DRBG.java",
                "index 3bd795164..9af401653 100644",
                "--- a/prov/src/main/java/org/bouncycastle/jcajce/provider/drbg/DRBG.java",
                "+++ b/prov/src/main/java/org/bouncycastle/jcajce/provider/drbg/DRBG.java",
                "@@ -254,2 +254,11 @@ public class DRBG",
                "+    private static class HybridRandomProvider",
                "+        extends Provider",
                "+    {",
                "+        protected HybridRandomProvider()",
                "+        {",
                "+            super(\"BCHEP\", 1.0, \"Bouncy Castle Hybrid Entropy Provider\");",
                "+        }",
                "+    }",
                "+",
                "     private static class HybridSecureRandom",
                "@@ -265,3 +274,3 @@ public class DRBG",
                "         {",
                "-            super(null, null);",
                "+            super(null, new HybridRandomProvider());",
                "             drbg = new SP800SecureRandomBuilder(new EntropySourceProvider()"
            ],
            "changed_files": [
                "prov/src/main/java/org/bouncycastle/jcajce/provider/drbg/DRBG.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [
                [
                    "no-tag",
                    "cef02c6911af804fe3de737816e74caf15a0bdac"
                ],
                [
                    "no-tag",
                    "85dc53b89417357576fa3522faafcb2785dd782c"
                ]
            ],
            "tags": [
                "r1rv60",
                "r1rv61",
                "r1rv62",
                "r1rv63",
                "r1rv64",
                "r1rv65",
                "r1rv66",
                "r1rv67",
                "r1rv68",
                "r1rv69",
                "r1rv70",
                "r1rv71",
                "r1rv72",
                "r1rv72v2",
                "r1rv73",
                "r1rv74",
                "r1rv75",
                "r1rv76",
                "r1rv77",
                "r1rv78",
                "r1rv78v1"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: castle, bouncy",
                    "relevance": 4
                },
                {
                    "id": "COMMIT_HAS_TWINS",
                    "message": "This commit has one or more twins.",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "a6bfdf05b7011cdce28bd1e80d872a252575d8a1",
            "repository": "https://github.com/bcgit/bc-java",
            "timestamp": 1520050133,
            "hunks": 6,
            "message": "added main on outer wrapper in deserialisation.",
            "diff": [
                "diff --git a/core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSUtil.java b/core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSUtil.java",
                "index 3a707f455..ea8fa64aa 100644",
                "--- a/core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSUtil.java",
                "+++ b/core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSUtil.java",
                "@@ -5,4 +5,7 @@ import java.io.ByteArrayOutputStream;",
                " import java.io.IOException;",
                "+import java.io.InputStream;",
                "+import java.io.InvalidClassException;",
                " import java.io.ObjectInputStream;",
                " import java.io.ObjectOutputStream;",
                "+import java.io.ObjectStreamClass;",
                "@@ -323,3 +326,3 @@ public class XMSSUtil",
                "-    public static Object deserialize(byte[] data, Class clazz)",
                "+    public static Object deserialize(byte[] data, final Class clazz)",
                "         throws IOException, ClassNotFoundException",
                "@@ -327,3 +330,4 @@ public class XMSSUtil",
                "         ByteArrayInputStream in = new ByteArrayInputStream(data);",
                "-        ObjectInputStream is = new ObjectInputStream(in);",
                "+        ObjectInputStream is = new CheckingStream(clazz, in);",
                "+",
                "         Object obj = is.readObject();",
                "@@ -334,2 +338,3 @@ public class XMSSUtil",
                "         }",
                "+        // you'd hope this would always succeed!",
                "         if (clazz.isInstance(obj))",
                "@@ -375,2 +380,36 @@ public class XMSSUtil",
                "     }",
                "+",
                "+    private static class CheckingStream",
                "+       extends ObjectInputStream",
                "+    {",
                "+        private final Class mainClass;",
                "+        private boolean found = false;",
                "+",
                "+        CheckingStream(Class mainClass, InputStream in)",
                "+            throws IOException",
                "+        {",
                "+            super(in);",
                "+",
                "+            this.mainClass = mainClass;",
                "+        }",
                "+",
                "+        protected Class<?> resolveClass(ObjectStreamClass desc)",
                "+            throws IOException,",
                "+            ClassNotFoundException",
                "+        {",
                "+            if (!found)",
                "+            {",
                "+                if (!desc.getName().equals(mainClass.getName()))",
                "+                {",
                "+                    throw new InvalidClassException(",
                "+                        \"unexpected class: \", desc.getName());",
                "+                }",
                "+                else",
                "+                {",
                "+                    found = true;",
                "+                }",
                "+            }",
                "+            return super.resolveClass(desc);",
                "+        }",
                "+    }",
                " }"
            ],
            "changed_files": [
                "core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSUtil.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [
                [
                    "no-tag",
                    "cb1e7101d36cccae2d4b8a012f6bdcbca1dca8dc"
                ],
                [
                    "no-tag",
                    "d4517b68775bd1b388e2e7a091d37126c312d106"
                ]
            ],
            "tags": [
                "r1rv73",
                "r1rv74",
                "r1rv75",
                "r1rv76",
                "r1rv77",
                "r1rv78",
                "r1rv78v1"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: castle, bouncy, xmss",
                    "relevance": 4
                },
                {
                    "id": "COMMIT_HAS_TWINS",
                    "message": "This commit has one or more twins.",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "561aeb49d0b25198fecfb05b9958c4b13abae452",
            "repository": "https://github.com/bcgit/bc-java",
            "timestamp": 1519308589,
            "hunks": 7,
            "message": "Added new Curves and KeyAgreements",
            "diff": [
                "diff --git a/core/src/main/java/org/bouncycastle/asn1/bsi/BSIObjectIdentifiers.java b/core/src/main/java/org/bouncycastle/asn1/bsi/BSIObjectIdentifiers.java",
                "index 315f6c481..a2ddd701f 100644",
                "--- a/core/src/main/java/org/bouncycastle/asn1/bsi/BSIObjectIdentifiers.java",
                "+++ b/core/src/main/java/org/bouncycastle/asn1/bsi/BSIObjectIdentifiers.java",
                "@@ -34,2 +34,44 @@ public interface BSIObjectIdentifiers",
                "     static final ASN1ObjectIdentifier ecdsa_plain_RIPEMD160 = ecdsa_plain_signatures.branch(\"6\");",
                "+",
                "+\t/** 0.4.0.127.0.7.1 */",
                "+\tstatic final ASN1ObjectIdentifier algorithm = bsi_de.branch(\"1\");",
                "+",
                "+\t/** ElGamal Elliptic Curve Key Agreement and Key Derivation according to X963 OID: 0.4.0.127.0.7.1.1.5.1.1 */",
                "+\tstatic final ASN1ObjectIdentifier ecka_eg_X963kdf = id_ecc.branch(\"5.1.1\");",
                "+",
                "+\t/** ElGamal Elliptic Curve Key Agreement and Key Derivation according to X963",
                "+\t * with hash function SHA256",
                "+\t * OID: 0.4.0.127.0.7.1.1.5.1.1.3 */",
                "+\tstatic final ASN1ObjectIdentifier ecka_eg_X963kdf_SHA256 = ecka_eg_X963kdf.branch(\"3\");",
                "+",
                "+\t/** ElGamal Elliptic Curve Key Agreement and Key Derivation according to X963",
                "+\t * with hash function SHA384",
                "+\t * OID: 0.4.0.127.0.7.1.1.5.1.1.4 */",
                "+\tstatic final ASN1ObjectIdentifier ecka_eg_X963kdf_SHA384 = ecka_eg_X963kdf.branch(\"4\");",
                "+",
                "+\t/** ElGamal Elliptic Curve Key Agreement and Key Derivation according to X963",
                "+\t * with hash function SHA512",
                "+\t * OID: 0.4.0.127.0.7.1.1.5.1.1.5 */",
                "+\tstatic final ASN1ObjectIdentifier ecka_eg_X963kdf_SHA512 = ecka_eg_X963kdf.branch(\"5\");",
                "+",
                "+\t/** AES encryption (CBC) and authentication (CMAC)",
                "+\t * OID: 0.4.0.127.0.7.1.x */",
                "+\t//FIXME replace \"1\" with correct OID",
                "+\tstatic final ASN1ObjectIdentifier aes_cbc_cmac = algorithm.branch(\"1\");",
                "+",
                "+\t/** AES encryption (CBC) and authentication (CMAC) with 128 bit",
                "+\t * OID: 0.4.0.127.0.7.1.x.y1 */",
                "+\t//FIXME replace \"1\" with correct OID",
                "+\tstatic final ASN1ObjectIdentifier id_aes128_CBC_CMAC = aes_cbc_cmac.branch(\"1\");",
                "+",
                "+",
                "+\t/** AES encryption (CBC) and authentication (CMAC) with 192 bit",
                "+\t * OID: 0.4.0.127.0.7.1.x.y2 */",
                "+\t//FIXME replace \"1\" with correct OID",
                "+\tstatic final ASN1ObjectIdentifier id_aes192_CBC_CMAC = aes_cbc_cmac.branch(\"1\");",
                "+",
                "+\t/** AES encryption (CBC) and authentication (CMAC) with 256 bit",
                "+\t * OID: 0.4.0.127.0.7.1.x.y3 */",
                "+\t//FIXME replace \"1\" with correct OID",
                "+\tstatic final ASN1ObjectIdentifier id_aes256_CBC_CMAC = aes_cbc_cmac.branch(\"1\");",
                " }",
                "diff --git a/core/src/main/java/org/bouncycastle/crypto/agreement/kdf/ECKaEgKEKGenerator.java b/core/src/main/java/org/bouncycastle/crypto/agreement/kdf/ECKaEgKEKGenerator.java",
                "new file mode 100644",
                "index 000000000..3faeb3245",
                "--- /dev/null",
                "+++ b/core/src/main/java/org/bouncycastle/crypto/agreement/kdf/ECKaEgKEKGenerator.java",
                "@@ -0,0 +1,89 @@",
                "+package org.bouncycastle.crypto.agreement.kdf;",
                "+",
                "+import java.io.IOException;",
                "+",
                "+import org.bouncycastle.asn1.ASN1EncodableVector;",
                "+import org.bouncycastle.asn1.ASN1Encoding;",
                "+import org.bouncycastle.asn1.ASN1ObjectIdentifier;",
                "+import org.bouncycastle.asn1.DERNull;",
                "+import org.bouncycastle.asn1.DEROctetString;",
                "+import org.bouncycastle.asn1.DERSequence;",
                "+import org.bouncycastle.asn1.DERTaggedObject;",
                "+import org.bouncycastle.asn1.x509.AlgorithmIdentifier;",
                "+import org.bouncycastle.crypto.DataLengthException;",
                "+import org.bouncycastle.crypto.DerivationParameters;",
                "+import org.bouncycastle.crypto.Digest;",
                "+import org.bouncycastle.crypto.DigestDerivationFunction;",
                "+import org.bouncycastle.crypto.generators.KDF2BytesGenerator;",
                "+import org.bouncycastle.crypto.params.KDFParameters;",
                "+import org.bouncycastle.util.Pack;",
                "+",
                "+/**",
                "+ * X9.63 based key derivation function for ECDH CMS.",
                "+ *",
                "+ * @author rainer.schubert",
                "+ *",
                "+ */",
                "+public class ECKaEgKEKGenerator extends DHKEKGenerator {",
                "+\tprivate DigestDerivationFunction kdf;",
                "+",
                "+\tprivate ASN1ObjectIdentifier algorithm;",
                "+\tprivate int keySize;",
                "+\tprivate byte[] z;",
                "+\tprivate boolean addSharedInfo;",
                "+",
                "+\tpublic static boolean USE_SHARED_INFO = true;",
                "+\tpublic static boolean DONTUSE_SHARED_INFO = false;",
                "+",
                "+\tpublic ECKaEgKEKGenerator(Digest digest, boolean addSharedInfo) {",
                "+\t\tsuper(digest);",
                "+\t\tthis.kdf = new KDF2BytesGenerator(digest);",
                "+\t\tthis.addSharedInfo = addSharedInfo;",
                "+\t}",
                "+",
                "+\tpublic ECKaEgKEKGenerator(Digest digest) {",
                "+\t\tsuper(digest);",
                "+\t\tthis.kdf = new KDF2BytesGenerator(digest);",
                "+\t\tthis.addSharedInfo = true;",
                "+\t}",
                "+",
                "+\t@Override",
                "+\tpublic void init(DerivationParameters param) {",
                "+\t\tDHKDFParameters params = (DHKDFParameters) param;",
                "+",
                "+\t\tthis.algorithm = params.getAlgorithm();",
                "+\t\tthis.keySize = params.getKeySize();",
                "+\t\tthis.z = params.getZ();",
                "+\t}",
                "+",
                "+\t@Override",
                "+\tpublic Digest getDigest() {",
                "+\t\treturn kdf.getDigest();",
                "+\t}",
                "+",
                "+\t@Override",
                "+\tpublic int generateBytes(byte[] out, int outOff, int len)",
                "+\t\t\tthrows DataLengthException, IllegalArgumentException",
                "+\t{",
                "+\t\tbyte[] sharedInfo = null;",
                "+",
                "+\t\tif (addSharedInfo) {",
                "+\t\t\t// TODO Create an ASN.1 class for this (RFC3278)",
                "+\t\t\t// ECC-CMS-SharedInfo",
                "+\t\t\tASN1EncodableVector v = new ASN1EncodableVector();",
                "+",
                "+\t\t\tv.add(new AlgorithmIdentifier(algorithm, DERNull.INSTANCE));",
                "+\t\t\tv.add(new DERTaggedObject(true, 2, new DEROctetString(Pack.intToBigEndian(keySize))));",
                "+",
                "+\t\t\ttry {",
                "+\t\t\t\tsharedInfo = new DERSequence(v).getEncoded(ASN1Encoding.DER);",
                "+\t\t\t} catch (IOException e) {",
                "+\t\t\t\tthrow new IllegalArgumentException(\"unable to initialise kdf: \" + e.getMessage());",
                "+\t\t\t}",
                "+\t\t}",
                "+",
                "+\t\tkdf.init(new KDFParameters(z, sharedInfo));",
                "+",
                "+\t\treturn kdf.generateBytes(out, outOff, len);",
                "+\t}",
                "+}",
                "diff --git a/pkix/src/main/java/org/bouncycastle/cms/CMSAlgorithm.java b/pkix/src/main/java/org/bouncycastle/cms/CMSAlgorithm.java",
                "index 3e48eef1d..d8fa40116 100644",
                "--- a/pkix/src/main/java/org/bouncycastle/cms/CMSAlgorithm.java",
                "+++ b/pkix/src/main/java/org/bouncycastle/cms/CMSAlgorithm.java",
                "@@ -3,2 +3,3 @@ package org.bouncycastle.cms;",
                " import org.bouncycastle.asn1.ASN1ObjectIdentifier;",
                "+import org.bouncycastle.asn1.bsi.BSIObjectIdentifiers;",
                " import org.bouncycastle.asn1.cryptopro.CryptoProObjectIdentifiers;",
                "@@ -32,2 +33,6 @@ public class CMSAlgorithm",
                "+\tpublic static final ASN1ObjectIdentifier  AES128_CBC_CMAC      = BSIObjectIdentifiers.id_aes128_CBC_CMAC;",
                "+\tpublic static final ASN1ObjectIdentifier  AES192_CBC_CMAC      = BSIObjectIdentifiers.id_aes192_CBC_CMAC;",
                "+\tpublic static final ASN1ObjectIdentifier  AES256_CBC_CMAC      = BSIObjectIdentifiers.id_aes256_CBC_CMAC;",
                "+",
                "     public static final ASN1ObjectIdentifier  CAMELLIA128_CBC = NTTObjectIdentifiers.id_camellia128_cbc.intern();",
                "@@ -74,2 +79,7 @@ public class CMSAlgorithm",
                "+\tpublic static final ASN1ObjectIdentifier  ECKA_EG_X963KDF  = BSIObjectIdentifiers.ecka_eg_X963kdf;",
                "+\tpublic static final ASN1ObjectIdentifier  ECKA_EG_X963KDF_SHA256  = BSIObjectIdentifiers.ecka_eg_X963kdf_SHA256;",
                "+\tpublic static final ASN1ObjectIdentifier  ECKA_EG_X963KDF_SHA384  = BSIObjectIdentifiers.ecka_eg_X963kdf_SHA384;",
                "+\tpublic static final ASN1ObjectIdentifier  ECKA_EG_X963KDF_SHA512  = BSIObjectIdentifiers.ecka_eg_X963kdf_SHA512;",
                "+",
                "     public static final ASN1ObjectIdentifier  SHA1 = OIWObjectIdentifiers.idSHA1.intern();",
                "diff --git a/prov/src/main/java/org/bouncycastle/jcajce/provider/asymmetric/ec/KeyAgreementSpi.java b/prov/src/main/java/org/bouncycastle/jcajce/provider/asymmetric/ec/KeyAgreementSpi.java",
                "index 038379b2c..89590a9b8 100644",
                "--- a/prov/src/main/java/org/bouncycastle/jcajce/provider/asymmetric/ec/KeyAgreementSpi.java",
                "+++ b/prov/src/main/java/org/bouncycastle/jcajce/provider/asymmetric/ec/KeyAgreementSpi.java",
                "@@ -20,2 +20,6 @@ import org.bouncycastle.crypto.agreement.ECMQVBasicAgreement;",
                " import org.bouncycastle.crypto.agreement.kdf.ConcatenationKDFGenerator;",
                "+import org.bouncycastle.crypto.agreement.kdf.ECKaEgKEKGenerator;",
                "+import org.bouncycastle.crypto.digests.SHA256Digest;",
                "+import org.bouncycastle.crypto.digests.SHA384Digest;",
                "+import org.bouncycastle.crypto.digests.SHA512Digest;",
                " import org.bouncycastle.crypto.generators.KDF2BytesGenerator;",
                "@@ -613,2 +617,50 @@ public class KeyAgreementSpi",
                "     }",
                "+",
                "+\t/**",
                "+\t * KeyAgreement according to BSI TR-03111 chapter 4.3.1",
                "+\t * TODO check optional SharedInfo",
                "+\t * TODO SHAxxxDigest according to FIPS180-2 but should be FIPS180-3 - check conformity",
                "+\t * @author rainer.schubert",
                "+\t */",
                "+\tpublic static class ECKAEGwithSHA256KDF",
                "+\t\t\textends KeyAgreementSpi",
                "+\t{",
                "+\t\tpublic ECKAEGwithSHA256KDF()",
                "+\t\t{",
                "+\t\t\tsuper(\"ECKAEGwithSHA256KDF\", new ECDHBasicAgreement(), new ECKaEgKEKGenerator(new SHA256Digest(),",
                "+\t\t\t\t\tECKaEgKEKGenerator.DONTUSE_SHARED_INFO));",
                "+\t\t}",
                "+\t}",
                "+",
                "+\t/**",
                "+\t * KeyAgreement according to BSI TR-03111 chapter 4.3.1",
                "+\t * TODO check optional SharedInfo",
                "+\t * TODO SHAxxxDigest according to FIPS180-2 but should be FIPS180-3 - check conformity",
                "+\t * @author rainer.schubert",
                "+\t */",
                "+\tpublic static class ECKAEGwithSHA384KDF",
                "+\t\t\textends KeyAgreementSpi",
                "+\t{",
                "+\t\tpublic ECKAEGwithSHA384KDF()",
                "+\t\t{",
                "+\t\t\tsuper(\"ECKAEGwithSHA384KDF\", new ECDHBasicAgreement(), new ECKaEgKEKGenerator(new SHA384Digest(),",
                "+\t\t\t\t\tECKaEgKEKGenerator.DONTUSE_SHARED_INFO));",
                "+\t\t}",
                "+\t}",
                "+",
                "+\t/**",
                "+\t * KeyAgreement according to BSI TR-03111 chapter 4.3.1",
                "+\t * TODO check optional SharedInfo",
                "+\t * TODO SHAxxxDigest according to FIPS180-2 but should be FIPS180-3 - check conformity",
                "+\t * @author rainer.schubert",
                "+\t */",
                "+\tpublic static class ECKAEGwithSHA512KDF",
                "+\t\t\textends KeyAgreementSpi",
                "+\t{",
                "+\t\tpublic ECKAEGwithSHA512KDF()",
                "+\t\t{",
                "+\t\t\tsuper(\"ECKAEGwithSHA512KDF\", new ECDHBasicAgreement(), new ECKaEgKEKGenerator(new SHA512Digest(),",
                "+\t\t\t\t\tECKaEgKEKGenerator.DONTUSE_SHARED_INFO));",
                "+\t\t}",
                "+\t}",
                " }"
            ],
            "changed_files": [
                "core/src/main/java/org/bouncycastle/asn1/bsi/BSIObjectIdentifiers.java",
                "core/src/main/java/org/bouncycastle/crypto/agreement/kdf/ECKaEgKEKGenerator.java",
                "pkix/src/main/java/org/bouncycastle/cms/CMSAlgorithm.java",
                "prov/src/main/java/org/bouncycastle/jcajce/provider/asymmetric/ec/KeyAgreementSpi.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [
                [
                    "no-tag",
                    "96fd9aa50b693137dbf36a94a4b94139e3cff0a7"
                ],
                [
                    "no-tag",
                    "4a5804920d2e6a10ff925759867955ffd4834ff8"
                ]
            ],
            "tags": [
                "r1rv73",
                "r1rv74",
                "r1rv75",
                "r1rv76",
                "r1rv77",
                "r1rv78",
                "r1rv78v1"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: castle, bouncy",
                    "relevance": 4
                },
                {
                    "id": "COMMIT_HAS_TWINS",
                    "message": "This commit has one or more twins.",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "bfc0db7d13e86acc01508552c07418fdd8def62e",
            "repository": "https://github.com/bcgit/bc-java",
            "timestamp": 1520053085,
            "hunks": 1,
            "message": "fixed use of <>",
            "diff": [
                "diff --git a/core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSUtil.java b/core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSUtil.java",
                "index 79c63ac80..78e4eae5e 100644",
                "--- a/core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSUtil.java",
                "+++ b/core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSUtil.java",
                "@@ -386,3 +386,3 @@ public class XMSSUtil",
                "     {",
                "-        private static final Set<String> components = new HashSet<>();",
                "+        private static final Set components = new HashSet();"
            ],
            "changed_files": [
                "core/src/main/java/org/bouncycastle/pqc/crypto/xmss/XMSSUtil.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [
                [
                    "no-tag",
                    "5e80add6ff70e531401bfe367190bf0b0333aef7"
                ],
                [
                    "no-tag",
                    "8ba9db9fd6b726c8a780a8132c7bbf887465e5d0"
                ]
            ],
            "tags": [
                "r1v60"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: castle, bouncy, xmss",
                    "relevance": 4
                },
                {
                    "id": "COMMIT_HAS_TWINS",
                    "message": "This commit has one or more twins.",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "f65220c5031d280ec296ec87a578184a869a1805",
            "repository": "https://github.com/bcgit/bc-java",
            "timestamp": 1520396455,
            "hunks": 2,
            "message": "update",
            "diff": [
                "diff --git a/CONTRIBUTORS.html b/CONTRIBUTORS.html",
                "index e6f29882c..04b5fb19d 100644",
                "--- a/CONTRIBUTORS.html",
                "+++ b/CONTRIBUTORS.html",
                "@@ -459,3 +459,3 @@ CertPath support for implicit DSA parameters and a range of NameConstraints. Add",
                " <li>Artem Storozhuk &lt;storojs72&#064gmail.com&gt; initial implementation of DSTU7564 (digest) and DSTU7624 (cipher) and their associated modes.</li>",
                "-<li>Andreas Glaser &lt;andreas.glaser@gi-de.com&gt; patch to recognise ANSSI curves for PKCS#10 requests.</li>",
                "+<li>Andreas Glaser &lt;andreas.glaser&#064gi-de.com&gt; patch to recognise ANSSI curves for PKCS#10 requests.</li>",
                " <li>codeborne &lt;https://github.com/cbxp&gt; patch to correct OIDs used in public key digest parameters for ECGOST-2012.</li>",
                "@@ -469,2 +469,3 @@ CertPath support for implicit DSA parameters and a range of NameConstraints. Add",
                " <li>David Strawn &lt;https://github.com/isomarcte&gt; fix for off by one error in SCRYPT bounds checking.</li>",
                "+<li>chris mccown &lt;0xchrismccown&#064gmail.com&gt; identification of serialisation issue with XMSS/XMSSMT private keys.</li>",
                " </ul>"
            ],
            "changed_files": [
                "CONTRIBUTORS.html"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [
                [
                    "no-tag",
                    "7ff448f1dc19c37ef660fde325d1b15a31f6f81d"
                ],
                [
                    "no-tag",
                    "3c17d92038102027230ae906c5a704d44b775747"
                ]
            ],
            "tags": [
                "r1rv73",
                "r1rv74",
                "r1rv75",
                "r1rv76",
                "r1rv77",
                "r1rv78",
                "r1rv78v1"
            ],
            "matched_rules": [
                {
                    "id": "COMMIT_HAS_TWINS",
                    "message": "This commit has one or more twins.",
                    "relevance": 2
                }
            ]
        }
    ]
}
