{
    "advisory_record": {
        "cve_id": "CVE-2018-8038",
        "description": "Versions of Apache CXF Fediz prior to 1.4.4 do not fully disable Document Type Declarations (DTDs) when either parsing the Identity Provider response in the application plugins, or in the Identity Provider itself when parsing certain XML-based parameters.",
        "reserved_timestamp": 1520553600,
        "published_timestamp": 1530662400,
        "updated_timestamp": 1623841666,
        "repository_url": null,
        "references": {
            "": 21,
            "https://lists.apache.org/thread.html/f0a6a05ec3b3a00458da43712b0ff3a2f573175d9bfb39fb0de21424%40%3Cdev.cxf.apache.org%3E": 2,
            "http://www.securitytracker.com/id/1041220": 2,
            "commit::b6ed9865d0614332fa419fe4b6d0fe81bc2e660d": 2,
            "http://cxf.apache.org/security-advisories.data/CVE-2018-8038.txt.asc": 2,
            "https://lists.apache.org/thread.html/rc774278135816e7afc943dc9fc78eb0764f2c84a2b96470a0187315c%40%3Ccommits.cxf.apache.org%3E": 2,
            "https://lists.apache.org/thread.html/r36e44ffc1a9b365327df62cdfaabe85b9a5637de102cea07d79b2dbf%40%3Ccommits.cxf.apache.org%3E": 2,
            "https://lists.apache.org/thread.html/rff42cfa5e7d75b7c1af0e37589140a8f1999e578a75738740b244bd4%40%3Ccommits.cxf.apache.org%3E": 2,
            "https://lists.apache.org/thread.html/rd49aabd984ed540c8ff7916d4d79405f3fa311d2fdbcf9ed307839a6%40%3Ccommits.cxf.apache.org%3E": 2,
            "https://lists.apache.org/thread.html/rec7160382badd3ef4ad017a22f64a266c7188b9ba71394f0d321e2d4%40%3Ccommits.cxf.apache.org%3E": 2,
            "https://lists.apache.org/thread.html/rfb87e0bf3995e7d560afeed750fac9329ff5f1ad49da365129b7f89e%40%3Ccommits.cxf.apache.org%3E": 2
        },
        "affected_products": [
            "Apache CXF Fediz",
            "Type",
            "Identity",
            "Apache",
            "CXF",
            "Document",
            "Fediz",
            "Provider",
            "DTDs",
            "Declarations"
        ],
        "versions": {
            "status": "affected",
            "version": "prior to 1.4.4"
        },
        "files": [
            "DTDs",
            "XML-based",
            "CXF"
        ],
        "keywords": [
            "declarations",
            "identity",
            "base",
            "parse",
            "parameter",
            "response",
            "type",
            "apache",
            "dtds",
            "provider",
            "document",
            "application",
            "fediz",
            "version",
            "plugin"
        ],
        "files_extension": [],
        "has_fixing_commit": true
    },
    "commits": [
        {
            "commit_id": "b6ed9865d0614332fa419fe4b6d0fe81bc2e660d",
            "repository": "https://github.com/apache/cxf-fediz",
            "timestamp": 1520443585,
            "hunks": 3,
            "message": "Make sure DocTypes are disallowed",
            "diff": [
                "diff --git a/plugins/core/src/main/java/org/apache/cxf/fediz/core/util/DOMUtils.java b/plugins/core/src/main/java/org/apache/cxf/fediz/core/util/DOMUtils.java",
                "index effd00a4..9c533fc7 100644",
                "--- a/plugins/core/src/main/java/org/apache/cxf/fediz/core/util/DOMUtils.java",
                "+++ b/plugins/core/src/main/java/org/apache/cxf/fediz/core/util/DOMUtils.java",
                "@@ -64,3 +64,3 @@ public final class DOMUtils {",
                "     private static final Logger LOG = LoggerFactory.getLogger(DOMUtils.class);",
                "-    ",
                "+",
                "     private static final String XMLNAMESPACE = \"xmlns\";",
                "@@ -68,3 +68,3 @@ public final class DOMUtils {",
                "     private static final DocumentBuilderFactory DBF = DocumentBuilderFactory.newInstance();",
                "-    ",
                "+",
                "     static {",
                "@@ -72,2 +72,3 @@ public final class DOMUtils {",
                "             DBF.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);",
                "+            DBF.setFeature(\"http://apache.org/xml/features/disallow-doctype-decl\", true);"
            ],
            "changed_files": [
                "plugins/core/src/main/java/org/apache/cxf/fediz/core/util/DOMUtils.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [
                [
                    "no-tag",
                    "4c396acb42439e61cc63b0452dd22442d720b61b"
                ]
            ],
            "tags": [
                "fediz-1.5.0",
                "fediz-1.5.1",
                "fediz-1.6.0",
                "fediz-1.6.1",
                "fediz-1.6.2"
            ],
            "matched_rules": [
                {
                    "id": "COMMIT_IN_REFERENCE",
                    "message": "This commit is mentioned 2 times in the references.",
                    "relevance": 64
                },
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: type",
                    "relevance": 4
                },
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: plugin",
                    "relevance": 4
                },
                {
                    "id": "COMMIT_HAS_TWINS",
                    "message": "This commit has one or more twins.",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "1c6ecf2ffdc233395b2bbaa4418f5c900d432eb1",
            "repository": "https://github.com/apache/cxf-fediz",
            "timestamp": 1520520708,
            "hunks": 1,
            "message": "Adding further DocType test for the plugins",
            "diff": [
                "diff --git a/plugins/core/src/main/java/org/apache/cxf/fediz/core/processor/FederationProcessorImpl.java b/plugins/core/src/main/java/org/apache/cxf/fediz/core/processor/FederationProcessorImpl.java",
                "index 5fc4893f..80c3dc47 100644",
                "--- a/plugins/core/src/main/java/org/apache/cxf/fediz/core/processor/FederationProcessorImpl.java",
                "+++ b/plugins/core/src/main/java/org/apache/cxf/fediz/core/processor/FederationProcessorImpl.java",
                "@@ -135,3 +135,3 @@ public class FederationProcessorImpl extends AbstractFedizProcessor {",
                "         }",
                "-        if (!\"RequestSecurityTokenResponse\".equals(el.getLocalName())) {",
                "+        if (el == null || !\"RequestSecurityTokenResponse\".equals(el.getLocalName())) {",
                "             LOG.warn(\"Unexpected root element of wresult: '\" + el.getLocalName() + \"'\");"
            ],
            "changed_files": [
                "plugins/core/src/main/java/org/apache/cxf/fediz/core/processor/FederationProcessorImpl.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [
                [
                    "no-tag",
                    "8f745805ce4ca38f7a91d7ba343e705117314f18"
                ]
            ],
            "tags": [
                "fediz-1.4.4",
                "fediz-1.4.5",
                "fediz-1.4.6"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: type, plugin",
                    "relevance": 4
                },
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: plugin",
                    "relevance": 4
                },
                {
                    "id": "COMMIT_HAS_TWINS",
                    "message": "This commit has one or more twins.",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "e3a000a805b511212f2296e35767007d361f2397",
            "repository": "https://github.com/apache/cxf-fediz",
            "timestamp": 1520956238,
            "hunks": 1,
            "message": "Updating CXF",
            "diff": [
                "diff --git a/pom.xml b/pom.xml",
                "index 4d9c3a22..e4589e9b 100644",
                "--- a/pom.xml",
                "+++ b/pom.xml",
                "@@ -46,3 +46,3 @@",
                "         <commons.validator.version>1.6</commons.validator.version>",
                "-        <cxf.version>3.1.14</cxf.version>",
                "+        <cxf.version>3.1.15</cxf.version>",
                "         <cxf.build-utils.version>3.2.0</cxf.build-utils.version>"
            ],
            "changed_files": [
                "pom.xml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "fediz-1.4.4",
                "fediz-1.4.5",
                "fediz-1.4.6"
            ],
            "matched_rules": [
                {
                    "id": "RELEVANT_WORDS_IN_MESSAGE",
                    "message": "The commit message contains some relevant words: CXF",
                    "relevance": 8
                }
            ]
        },
        {
            "commit_id": "a39091461c15827e0802b019a9c63c67eea7b06e",
            "repository": "https://github.com/apache/cxf-fediz",
            "timestamp": 1520505745,
            "hunks": 2,
            "message": "Adding the secure processing feature in the IdP",
            "diff": [
                "diff --git a/services/idp-core/src/main/java/org/apache/cxf/fediz/service/idp/beans/TokenSerializer.java b/services/idp-core/src/main/java/org/apache/cxf/fediz/service/idp/beans/TokenSerializer.java",
                "index e36ecf46..e044943c 100644",
                "--- a/services/idp-core/src/main/java/org/apache/cxf/fediz/service/idp/beans/TokenSerializer.java",
                "+++ b/services/idp-core/src/main/java/org/apache/cxf/fediz/service/idp/beans/TokenSerializer.java",
                "@@ -22,2 +22,3 @@ import java.io.StringWriter;",
                "+import javax.xml.XMLConstants;",
                " import javax.xml.transform.OutputKeys;",
                "@@ -48,3 +49,5 @@ public class TokenSerializer {",
                "             try {",
                "-                Transformer t = TransformerFactory.newInstance().newTransformer();",
                "+                TransformerFactory tf = TransformerFactory.newInstance();",
                "+                tf.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);",
                "+                Transformer t = tf.newTransformer();",
                "                 t.setOutputProperty(OutputKeys.OMIT_XML_DECLARATION, \"yes\");"
            ],
            "changed_files": [
                "services/idp-core/src/main/java/org/apache/cxf/fediz/service/idp/beans/TokenSerializer.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [
                [
                    "no-tag",
                    "673d70abf035c31ae08ca01f8526d3e5edcdb1d3"
                ]
            ],
            "tags": [
                "fediz-1.4.4",
                "fediz-1.4.5",
                "fediz-1.4.6"
            ],
            "matched_rules": [
                {
                    "id": "SEC_KEYWORDS_IN_MESSAGE",
                    "message": "The commit message contains some security-related keywords: secure",
                    "relevance": 4
                },
                {
                    "id": "COMMIT_HAS_TWINS",
                    "message": "This commit has one or more twins.",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "5372ce1182572ab7bd9555bacc68d9d35a693f37",
            "repository": "https://github.com/apache/cxf-fediz",
            "timestamp": 1520274964,
            "hunks": 1,
            "message": "Updating Apache parent pom",
            "diff": [
                "diff --git a/pom.xml b/pom.xml",
                "index 1876f8c6..4d9c3a22 100644",
                "--- a/pom.xml",
                "+++ b/pom.xml",
                "@@ -31,3 +31,3 @@",
                "         <artifactId>apache</artifactId>",
                "-        <version>18</version>",
                "+        <version>19</version>",
                "     </parent>"
            ],
            "changed_files": [
                "pom.xml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [
                [
                    "no-tag",
                    "84b4d31adc6feaa1d2659f87edd1a2b5a88e9fef"
                ]
            ],
            "tags": [
                "fediz-1.4.4",
                "fediz-1.4.5",
                "fediz-1.4.6"
            ],
            "matched_rules": [
                {
                    "id": "COMMIT_HAS_TWINS",
                    "message": "This commit has one or more twins.",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "518a84580f2023b4016277d12f7299ffeafca2ce",
            "repository": "https://github.com/apache/cxf-fediz",
            "timestamp": 1520958391,
            "hunks": 1,
            "message": "Tomcat update",
            "diff": [
                "diff --git a/pom.xml b/pom.xml",
                "index e4589e9b..c80adf90 100644",
                "--- a/pom.xml",
                "+++ b/pom.xml",
                "@@ -70,3 +70,3 @@",
                "         <tomcat7.version>7.0.85</tomcat7.version>",
                "-        <tomcat8.version>8.5.28</tomcat8.version>",
                "+        <tomcat8.version>8.5.29</tomcat8.version>",
                "         <woodstox.core.version>4.4.1</woodstox.core.version>"
            ],
            "changed_files": [
                "pom.xml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [
                [
                    "no-tag",
                    "2d89eaf480afd431fe059412d429e9c5f28e5aca"
                ]
            ],
            "tags": [
                "fediz-1.4.4",
                "fediz-1.4.5",
                "fediz-1.4.6"
            ],
            "matched_rules": [
                {
                    "id": "COMMIT_HAS_TWINS",
                    "message": "This commit has one or more twins.",
                    "relevance": 2
                }
            ]
        }
    ]
}
