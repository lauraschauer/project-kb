{
    "advisory_record": {
        "cve_id": "CVE-2018-9159",
        "description": "In Spark before 2.7.2, a remote attacker can read unintended static files via various representations of absolute or relative pathnames, as demonstrated by file: URLs and directory traversal sequences. NOTE: this product is unrelated to Ignite Realtime Spark.",
        "reserved_timestamp": 1522454400,
        "published_timestamp": 1522530000,
        "updated_timestamp": 1534327021,
        "repository_url": null,
        "references": {
            "": 125,
            "https://access.redhat.com/support/": 10,
            "https://github.com/perwendel/spark/issues/981": 9,
            "commit::030e9d00125cbd1ad759668f85488aba1019c668": 8,
            "https://access.redhat.com/downloads/": 8,
            "commit::ce9e11517eca69e58ed4378d1e47a02bd06863cc": 6,
            "https://access.redhat.com/errata/": 6,
            "https://access.redhat.com/labs/": 6,
            "commit::a221a864db28eb736d36041df2fa6eb8839fc5cd": 5,
            "https://access.redhat.com/errata/RHSA-2018:2020": 4,
            "https://access.redhat.com/errata/RHSA-2018:2405": 4,
            "http://sparkjava.com/news#spark-272-released": 4,
            "commit::db45b5640ab577057e630b1c14bd537517aa5a29": 4,
            "https://access.redhat.com/management/": 4,
            "https://access.redhat.com/": 4,
            "https://access.redhat.com/products/red-hat-enterprise-linux/": 4,
            "https://access.redhat.com/products/red-hat-openshift-container-platform": 4,
            "https://access.redhat.com/products/red-hat-ansible-automation-platform/": 4,
            "https://access.redhat.com/products/": 4,
            "https://access.redhat.com/documentation": 4,
            "https://access.redhat.com/product-life-cycles/": 4,
            "https://access.redhat.com/security": 4,
            "https://access.redhat.com/security/security-updates/#/security-advisories": 4,
            "https://access.redhat.com/security/security-updates/#/cve": 4,
            "https://access.redhat.com/support/contact/": 4,
            "https://status.redhat.com": 4,
            "https://github.com/perwendel": 3,
            "https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax": 2,
            "commit::5f27c52b506621649a246ccefb5d2a1c63bdd1fa": 2,
            "https://access.redhat.com/downloads/content/package-browser": 2,
            "https://catalog.redhat.com/software/containers/explore/": 2,
            "https://access.redhat.com/articles/1202803": 2,
            "https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution": 2,
            "https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article": 2,
            "https://access.redhat.com/documentation/en/red_hat_enterprise_linux": 2,
            "https://access.redhat.com/documentation/en/openshift_container_platform": 2,
            "https://access.redhat.com/documentation/en/red_hat_ansible_automation_platform": 2,
            "https://access.redhat.com/documentation/": 2,
            "https://access.redhat.com/security/": 2,
            "https://access.redhat.com/security/vulnerabilities": 2,
            "https://access.redhat.com/security/data": 2,
            "https://access.redhat.com/security/security-updates/#/security-labs": 2,
            "https://access.redhat.com/security/updates/backporting/": 2,
            "https://access.redhat.com/support/cases/": 2,
            "https://access.redhat.com/support/cases/#/troubleshoot": 2,
            "https://access.redhat.com/community": 2,
            "https://access.redhat.com/community/": 2,
            "https://access.redhat.com/discussions/": 2,
            "https://access.redhat.com/announcements/": 2,
            "https://access.redhat.com/accelerators/": 2,
            "https://access.redhat.com/jbossnetwork/restricted/listSoftware.html": 2,
            "https://cloud.redhat.com/insights": 2,
            "https://access.redhat.com/changeLanguage?language=en": 2,
            "https://access.redhat.com/changeLanguage?language=fr": 2,
            "https://access.redhat.com/changeLanguage?language=ko": 2,
            "https://access.redhat.com/changeLanguage?language=ja": 2,
            "https://access.redhat.com/changeLanguage?language=zh_CN": 2,
            "https://access.redhat.com/products/red-hat-satellite/": 2,
            "https://access.redhat.com/products/red-hat-subscription-management/": 2,
            "https://access.redhat.com/products/red-hat-insights/": 2,
            "https://access.redhat.com/products/red-hat-openstack-platform/": 2,
            "https://access.redhat.com/products/red-hat-openshift-container-platform/": 2,
            "https://access.redhat.com/products/red-hat-openshift-ai/": 2,
            "https://access.redhat.com/products/openshift-dedicated-red-hat/": 2,
            "https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/": 2,
            "https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/": 2,
            "https://access.redhat.com/products/red-hat-quay/": 2,
            "https://access.redhat.com/products/red-hat-openshift-dev-spaces": 2,
            "https://access.redhat.com/products/red-hat-openshift-service-aws": 2,
            "https://access.redhat.com/products/red-hat-storage/": 2,
            "https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/": 2,
            "https://access.redhat.com/products/red-hat-ceph-storage/": 2,
            "https://access.redhat.com/products/red-hat-openshift-data-foundation": 2,
            "https://access.redhat.com/products/red-hat-runtimes/": 2,
            "https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/": 2,
            "https://access.redhat.com/products/red-hat-data-grid/": 2,
            "https://access.redhat.com/products/red-hat-jboss-web-server/": 2,
            "https://access.redhat.com/products/red-hat-build-of-keycloak/": 2,
            "https://access.redhat.com/products/spring-boot/": 2,
            "https://access.redhat.com/products/nodejs/": 2,
            "https://access.redhat.com/products/quarkus/": 2,
            "https://access.redhat.com/products/red-hat-application-foundations/": 2,
            "https://access.redhat.com/products/red-hat-fuse/": 2,
            "https://access.redhat.com/products/red-hat-amq/": 2,
            "https://access.redhat.com/products/red-hat-3scale/": 2,
            "https://bugzilla.redhat.com/show_bug.cgi?id=1563732": 2,
            "https://www.redhat.com/security/data/cve/CVE-2018-9159.html": 2,
            "https://access.redhat.com/security/team/contact/": 2,
            "https://redhat.com/en": 2,
            "https://twitter.com/RedHat": 2,
            "https://access.redhat.com/management": 2,
            "https://access.redhat.com/support": 2,
            "https://access.redhat.com/support/customer-service": 2,
            "https://access.redhat.com/articles/33844": 2,
            "https://access.redhat.com/help/login_assistance": 2,
            "https://www.redhat.com/en/trust": 2,
            "https://www.redhat.com/en/about/browser-support": 2,
            "https://www.redhat.com/en/about/digital-accessibility": 2,
            "https://access.redhat.com/recognition/": 2,
            "https://access.redhat.com/help/colophon/": 2,
            "https://www.redhat.com/": 2,
            "http://developers.redhat.com/": 2,
            "https://connect.redhat.com/": 2,
            "https://cloud.redhat.com/": 2,
            "https://access.redhat.com/subscription-value": 2,
            "https://www.redhat.com/about/": 2,
            "http://jobs.redhat.com": 2,
            "https://redhat.com/en/about/company": 2,
            "https://redhat.com/en/jobs": 2,
            "https://redhat.com/en/events": 2,
            "https://redhat.com/en/about/office-locations": 2,
            "https://redhat.com/en/contact": 2,
            "https://redhat.com/en/blog": 2,
            "https://redhat.com/en/about/our-culture/diversity-equity-inclusion": 2,
            "https://coolstuff.redhat.com/": 2,
            "https://www.redhat.com/en/summit": 2,
            "https://redhat.com/en/about/privacy-policy": 2,
            "https://redhat.com/en/about/terms-use": 2,
            "https://redhat.com/en/about/all-policies-guidelines": 2,
            "https://redhat.com/en/about/digital-accessibility": 2,
            "https://access.redhat.com/articles/3060411": 2,
            "https://github.com/features/actions": 1,
            "https://github.com/features/packages": 1,
            "https://github.com/features/security": 1,
            "https://github.com/features/codespaces": 1,
            "https://github.com/features/copilot": 1,
            "https://github.com/features/code-review": 1,
            "https://github.com/features/issues": 1,
            "https://github.com/features/discussions": 1,
            "https://github.com/features": 1,
            "https://docs.github.com": 1,
            "https://skills.github.com": 1,
            "https://github.blog": 1,
            "https://github.com/enterprise": 1,
            "https://github.com/team": 1,
            "https://github.com/enterprise/startups": 1,
            "https://github.com/solutions/industries/healthcare": 1,
            "https://github.com/solutions/industries/financial-services": 1,
            "https://github.com/solutions/industries/manufacturing": 1,
            "https://github.com/solutions/ci-cd": 1,
            "https://github.com/solutions/devops": 1,
            "https://github.com/solutions/devsecops": 1,
            "https://resources.github.com/learn/pathways": 1,
            "https://resources.github.com": 1,
            "https://github.com/customer-stories": 1,
            "https://partner.github.com": 1,
            "https://github.com/readme": 1,
            "https://github.com/topics": 1,
            "https://github.com/trending": 1,
            "https://github.com/collections": 1,
            "https://github.com/enterprise/advanced-security": 1,
            "https://github.com/pricing": 1,
            "https://docs.github.com/terms": 1,
            "https://docs.github.com/privacy": 1,
            "http://sparkjava.com/news#vulnerability": 1,
            "http://sparkjava.com/contact": 1,
            "https://github.com/perwendel/spark/issues/981#issuecomment-368292443": 1,
            "https://github.com/notifications/unsubscribe-auth/ADoRdnxRj7RDzZYoiGXEALtpThYsMbc8ks5tYRsbgaJpZM4SSLJ4": 1,
            "https://github.com/perwendel/spark/issues/981#issuecomment-368292875": 1,
            "https://github.com/notifications/unsubscribe-auth/ADoRdmowKufvjhKWqJJSlh1UIVh1FKc9ks5tYR01gaJpZM4SSLJ4": 1,
            "https://github.com/perwendel/spark/pull/987": 1,
            "https://github.com/orangetw": 1,
            "https://github.com/perwendel/spark/pull/988": 1,
            "https://github.com": 1,
            "https://docs.github.com/site-policy/github-terms/github-terms-of-service": 1,
            "https://docs.github.com/site-policy/privacy-policies/github-privacy-statement": 1,
            "https://github.com/security": 1,
            "https://www.githubstatus.com/": 1,
            "https://docs.github.com/": 1,
            "https://support.github.com?tags=dotcom-footer": 1,
            "https://access.redhat.com/security/updates/classification/#moderate": 1,
            "https://access.redhat.com/jbossnetwork/restricted/listSoftware.html?product=jboss.fuse&downloadType=securityPatches&version=6.3": 1,
            "https://access.redhat.com/jbossnetwork/restricted/listSoftware.html?downloadType=securityPatches&product=jboss.amq.broker&version=6.3.0": 1,
            "https://access.redhat.com/documentation/en-us/red_hat_amq/6.3/": 1,
            "https://access.redhat.com/documentation/en-us/red_hat_fuse/6.3/": 1,
            "https://bugzilla.redhat.com/show_bug.cgi?id=1503055": 1,
            "https://bugzilla.redhat.com/show_bug.cgi?id=1540030": 1,
            "https://bugzilla.redhat.com/show_bug.cgi?id=1553024": 1,
            "https://bugzilla.redhat.com/show_bug.cgi?id=1563133": 1,
            "https://www.redhat.com/security/data/cve/CVE-2017-8046.html": 1,
            "https://www.redhat.com/security/data/cve/CVE-2017-12196.html": 1,
            "https://www.redhat.com/security/data/cve/CVE-2018-1199.html": 1,
            "https://www.redhat.com/security/data/cve/CVE-2018-1295.html": 1,
            "https://access.redhat.com/security/updates/classification/#critical": 1
        },
        "affected_products": [
            "Ignite",
            "n/a",
            "Spark",
            "Realtime"
        ],
        "versions": {
            "status": "affected",
            "version": "n/a"
        },
        "files": [
            "NOTE",
            "URLs"
        ],
        "keywords": [
            "ignite",
            "directory",
            "demonstrate",
            "attacker",
            "file",
            "spark",
            "representation",
            "realtime",
            "traversal",
            "read",
            "pathname",
            "product",
            "note",
            "sequence"
        ],
        "files_extension": [],
        "has_fixing_commit": true
    },
    "commits": [
        {
            "commit_id": "a221a864db28eb736d36041df2fa6eb8839fc5cd",
            "repository": "https://github.com/perwendel/spark",
            "timestamp": 1520425694,
            "hunks": 4,
            "message": "Fix for #981, patch 2",
            "diff": [
                "diff --git a/src/main/java/spark/resource/ClassPathResource.java b/src/main/java/spark/resource/ClassPathResource.java",
                "index dd8ba97..e4b19f5 100644",
                "--- a/src/main/java/spark/resource/ClassPathResource.java",
                "+++ b/src/main/java/spark/resource/ClassPathResource.java",
                "@@ -25,2 +25,3 @@ import spark.utils.Assert;",
                " import spark.utils.ClassUtils;",
                "+import spark.utils.ResourceUtils;",
                " import spark.utils.StringUtils;",
                "@@ -76,3 +77,3 @@ public class ClassPathResource extends AbstractFileResolvingResource {",
                "         Assert.notNull(path, \"Path must not be null\");",
                "-        Assert.state(doesNotContainFileColon(path), \"Path must not contain 'file:'\");",
                "+        Assert.isTrue(isValid(path), \"Path is not valid\");",
                "@@ -88,4 +89,23 @@ public class ClassPathResource extends AbstractFileResolvingResource {",
                "-    private static boolean doesNotContainFileColon(String path) {",
                "-        return !path.contains(\"file:\");",
                "+    private static boolean isValid(final String path) {",
                "+        return !isInvalidPath(path);",
                "+    }",
                "+",
                "+    private static boolean isInvalidPath(String path) {",
                "+        if (path.contains(\"WEB-INF\") || path.contains(\"META-INF\")) {",
                "+            return true;",
                "+        }",
                "+        if (path.contains(\":/\")) {",
                "+            String relativePath = (path.charAt(0) == '/' ? path.substring(1) : path);",
                "+            if (ResourceUtils.isUrl(relativePath) || relativePath.startsWith(\"url:\")) {",
                "+                return true;",
                "+            }",
                "+        }",
                "+        if (path.contains(\"\")) {",
                "+            path = StringUtils.cleanPath(path);",
                "+            if (path.contains(\"../\")) {",
                "+                return true;",
                "+            }",
                "+        }",
                "+        return false;",
                "     }",
                "@@ -238,4 +258,4 @@ public class ClassPathResource extends AbstractFileResolvingResource {",
                "             return (this.path.equals(otherRes.path) &&",
                "-                thisLoader.equals(otherLoader) &&",
                "-                this.clazz.equals(otherRes.clazz));",
                "+                    thisLoader.equals(otherLoader) &&",
                "+                    this.clazz.equals(otherRes.clazz));",
                "         }"
            ],
            "changed_files": [
                "src/main/java/spark/resource/ClassPathResource.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "981": "Support static files in /META-INF/resources according to Servlet Spec #996 Bump spark-core from 2.5.4 to 2.7.2 open-korean-text/open-korean-text-api#15 Bump spark-core from 2.7.1 to 2.7.2 kabakan/JCollection#1"
            },
            "cve_refs": [],
            "twins": [],
            "tags": [],
            "matched_rules": [
                {
                    "id": "XREF_GH",
                    "message": "The commit and the advisory (including referenced pages) mention the same github issue: 981",
                    "relevance": 32
                },
                {
                    "id": "COMMIT_IN_REFERENCE",
                    "message": "This commit is mentioned 5 times in the references.",
                    "relevance": 64
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 981",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "db45b5640ab577057e630b1c14bd537517aa5a29",
            "repository": "https://github.com/perwendel/spark",
            "timestamp": 1520332939,
            "hunks": 16,
            "message": "Fix for #981 (#987)",
            "diff": [
                "diff --git a/pom.xml b/pom.xml",
                "index f8e0a98..5ed76d0 100644",
                "--- a/pom.xml",
                "+++ b/pom.xml",
                "@@ -11,3 +11,3 @@",
                "     <packaging>bundle</packaging>",
                "-    <version>3.0.0-SNAPSHOT</version>",
                "+    <version>2.7.2-SNAPSHOT</version>",
                "     <name>Spark</name>",
                "diff --git a/src/main/java/spark/resource/ClassPathResource.java b/src/main/java/spark/resource/ClassPathResource.java",
                "index 70bccc0..dd8ba97 100644",
                "--- a/src/main/java/spark/resource/ClassPathResource.java",
                "+++ b/src/main/java/spark/resource/ClassPathResource.java",
                "@@ -76,3 +76,6 @@ public class ClassPathResource extends AbstractFileResolvingResource {",
                "         Assert.notNull(path, \"Path must not be null\");",
                "+        Assert.state(doesNotContainFileColon(path), \"Path must not contain 'file:'\");",
                "+",
                "         String pathToUse = StringUtils.cleanPath(path);",
                "+",
                "         if (pathToUse.startsWith(\"/\")) {",
                "@@ -80,2 +83,3 @@ public class ClassPathResource extends AbstractFileResolvingResource {",
                "         }",
                "+",
                "         this.path = pathToUse;",
                "@@ -84,2 +88,6 @@ public class ClassPathResource extends AbstractFileResolvingResource {",
                "+    private static boolean doesNotContainFileColon(String path) {",
                "+        return !path.contains(\"file:\");",
                "+    }",
                "+",
                "     /**",
                "@@ -110,6 +118,5 @@ public class ClassPathResource extends AbstractFileResolvingResource {",
                "      *",
                "+     * @return if exists.",
                "      * @see java.lang.ClassLoader#getResource(String)",
                "      * @see java.lang.Class#getResource(String)",
                "-     *",
                "-     * @return if exists.",
                "      */",
                "@@ -129,6 +136,5 @@ public class ClassPathResource extends AbstractFileResolvingResource {",
                "      *",
                "+     * @return the input stream.",
                "      * @see java.lang.ClassLoader#getResourceAsStream(String)",
                "      * @see java.lang.Class#getResourceAsStream(String)",
                "-     *",
                "-     * @return the input stream.",
                "      */",
                "@@ -151,6 +157,5 @@ public class ClassPathResource extends AbstractFileResolvingResource {",
                "      *",
                "+     * @return the url.",
                "      * @see java.lang.ClassLoader#getResource(String)",
                "      * @see java.lang.Class#getResource(String)",
                "-     *",
                "-     * @return the url.",
                "      */",
                "@@ -174,5 +179,4 @@ public class ClassPathResource extends AbstractFileResolvingResource {",
                "      *",
                "-     * @see spark.utils.StringUtils#applyRelativePath(String, String)",
                "-     *",
                "      * @return the resource.",
                "+     * @see spark.utils.StringUtils#applyRelativePath(String, String)",
                "      */",
                "@@ -188,5 +192,4 @@ public class ClassPathResource extends AbstractFileResolvingResource {",
                "      *",
                "-     * @see spark.utils.StringUtils#getFilename(String)",
                "-     *",
                "      * @return the file name.",
                "+     * @see spark.utils.StringUtils#getFilename(String)",
                "      */",
                "@@ -235,4 +238,4 @@ public class ClassPathResource extends AbstractFileResolvingResource {",
                "             return (this.path.equals(otherRes.path) &&",
                "-                    thisLoader.equals(otherLoader) &&",
                "-                    this.clazz.equals(otherRes.clazz));",
                "+                thisLoader.equals(otherLoader) &&",
                "+                this.clazz.equals(otherRes.clazz));",
                "         }"
            ],
            "changed_files": [
                "pom.xml",
                "src/main/java/spark/resource/ClassPathResource.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "981": "Support static files in /META-INF/resources according to Servlet Spec #996 Bump spark-core from 2.5.4 to 2.7.2 open-korean-text/open-korean-text-api#15 Bump spark-core from 2.7.1 to 2.7.2 kabakan/JCollection#1",
                "987": "Bump spark-core from 2.5.4 to 2.7.2 open-korean-text/open-korean-text-api#15 Bump spark-core from 2.7.1 to 2.7.2 kabakan/JCollection#1"
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "2.7.2",
                "2.9.0",
                "2.9.1",
                "2.9.2",
                "2.9.3"
            ],
            "matched_rules": [
                {
                    "id": "XREF_GH",
                    "message": "The commit and the advisory (including referenced pages) mention the same github issue: 981, 987",
                    "relevance": 32
                },
                {
                    "id": "COMMIT_IN_REFERENCE",
                    "message": "This commit is mentioned 4 times in the references.",
                    "relevance": 64
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 981, 987",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "ce9e11517eca69e58ed4378d1e47a02bd06863cc",
            "repository": "https://github.com/perwendel/spark",
            "timestamp": 1520332707,
            "hunks": 16,
            "message": "Fix for #981",
            "diff": [
                "diff --git a/pom.xml b/pom.xml",
                "index f8e0a98..5ed76d0 100644",
                "--- a/pom.xml",
                "+++ b/pom.xml",
                "@@ -11,3 +11,3 @@",
                "     <packaging>bundle</packaging>",
                "-    <version>3.0.0-SNAPSHOT</version>",
                "+    <version>2.7.2-SNAPSHOT</version>",
                "     <name>Spark</name>",
                "diff --git a/src/main/java/spark/resource/ClassPathResource.java b/src/main/java/spark/resource/ClassPathResource.java",
                "index 70bccc0..dd8ba97 100644",
                "--- a/src/main/java/spark/resource/ClassPathResource.java",
                "+++ b/src/main/java/spark/resource/ClassPathResource.java",
                "@@ -76,3 +76,6 @@ public class ClassPathResource extends AbstractFileResolvingResource {",
                "         Assert.notNull(path, \"Path must not be null\");",
                "+        Assert.state(doesNotContainFileColon(path), \"Path must not contain 'file:'\");",
                "+",
                "         String pathToUse = StringUtils.cleanPath(path);",
                "+",
                "         if (pathToUse.startsWith(\"/\")) {",
                "@@ -80,2 +83,3 @@ public class ClassPathResource extends AbstractFileResolvingResource {",
                "         }",
                "+",
                "         this.path = pathToUse;",
                "@@ -84,2 +88,6 @@ public class ClassPathResource extends AbstractFileResolvingResource {",
                "+    private static boolean doesNotContainFileColon(String path) {",
                "+        return !path.contains(\"file:\");",
                "+    }",
                "+",
                "     /**",
                "@@ -110,6 +118,5 @@ public class ClassPathResource extends AbstractFileResolvingResource {",
                "      *",
                "+     * @return if exists.",
                "      * @see java.lang.ClassLoader#getResource(String)",
                "      * @see java.lang.Class#getResource(String)",
                "-     *",
                "-     * @return if exists.",
                "      */",
                "@@ -129,6 +136,5 @@ public class ClassPathResource extends AbstractFileResolvingResource {",
                "      *",
                "+     * @return the input stream.",
                "      * @see java.lang.ClassLoader#getResourceAsStream(String)",
                "      * @see java.lang.Class#getResourceAsStream(String)",
                "-     *",
                "-     * @return the input stream.",
                "      */",
                "@@ -151,6 +157,5 @@ public class ClassPathResource extends AbstractFileResolvingResource {",
                "      *",
                "+     * @return the url.",
                "      * @see java.lang.ClassLoader#getResource(String)",
                "      * @see java.lang.Class#getResource(String)",
                "-     *",
                "-     * @return the url.",
                "      */",
                "@@ -174,5 +179,4 @@ public class ClassPathResource extends AbstractFileResolvingResource {",
                "      *",
                "-     * @see spark.utils.StringUtils#applyRelativePath(String, String)",
                "-     *",
                "      * @return the resource.",
                "+     * @see spark.utils.StringUtils#applyRelativePath(String, String)",
                "      */",
                "@@ -188,5 +192,4 @@ public class ClassPathResource extends AbstractFileResolvingResource {",
                "      *",
                "-     * @see spark.utils.StringUtils#getFilename(String)",
                "-     *",
                "      * @return the file name.",
                "+     * @see spark.utils.StringUtils#getFilename(String)",
                "      */",
                "@@ -235,4 +238,4 @@ public class ClassPathResource extends AbstractFileResolvingResource {",
                "             return (this.path.equals(otherRes.path) &&",
                "-                    thisLoader.equals(otherLoader) &&",
                "-                    this.clazz.equals(otherRes.clazz));",
                "+                thisLoader.equals(otherLoader) &&",
                "+                this.clazz.equals(otherRes.clazz));",
                "         }"
            ],
            "changed_files": [
                "pom.xml",
                "src/main/java/spark/resource/ClassPathResource.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "981": "Support static files in /META-INF/resources according to Servlet Spec #996 Bump spark-core from 2.5.4 to 2.7.2 open-korean-text/open-korean-text-api#15 Bump spark-core from 2.7.1 to 2.7.2 kabakan/JCollection#1"
            },
            "cve_refs": [],
            "twins": [],
            "tags": [],
            "matched_rules": [
                {
                    "id": "XREF_GH",
                    "message": "The commit and the advisory (including referenced pages) mention the same github issue: 981",
                    "relevance": 32
                },
                {
                    "id": "COMMIT_IN_REFERENCE",
                    "message": "This commit is mentioned 6 times in the references.",
                    "relevance": 64
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 981",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "030e9d00125cbd1ad759668f85488aba1019c668",
            "repository": "https://github.com/perwendel/spark",
            "timestamp": 1520430182,
            "hunks": 4,
            "message": "Fix for #981, patch 2 (#988)",
            "diff": [
                "diff --git a/src/main/java/spark/resource/ClassPathResource.java b/src/main/java/spark/resource/ClassPathResource.java",
                "index dd8ba97..e4b19f5 100644",
                "--- a/src/main/java/spark/resource/ClassPathResource.java",
                "+++ b/src/main/java/spark/resource/ClassPathResource.java",
                "@@ -25,2 +25,3 @@ import spark.utils.Assert;",
                " import spark.utils.ClassUtils;",
                "+import spark.utils.ResourceUtils;",
                " import spark.utils.StringUtils;",
                "@@ -76,3 +77,3 @@ public class ClassPathResource extends AbstractFileResolvingResource {",
                "         Assert.notNull(path, \"Path must not be null\");",
                "-        Assert.state(doesNotContainFileColon(path), \"Path must not contain 'file:'\");",
                "+        Assert.isTrue(isValid(path), \"Path is not valid\");",
                "@@ -88,4 +89,23 @@ public class ClassPathResource extends AbstractFileResolvingResource {",
                "-    private static boolean doesNotContainFileColon(String path) {",
                "-        return !path.contains(\"file:\");",
                "+    private static boolean isValid(final String path) {",
                "+        return !isInvalidPath(path);",
                "+    }",
                "+",
                "+    private static boolean isInvalidPath(String path) {",
                "+        if (path.contains(\"WEB-INF\") || path.contains(\"META-INF\")) {",
                "+            return true;",
                "+        }",
                "+        if (path.contains(\":/\")) {",
                "+            String relativePath = (path.charAt(0) == '/' ? path.substring(1) : path);",
                "+            if (ResourceUtils.isUrl(relativePath) || relativePath.startsWith(\"url:\")) {",
                "+                return true;",
                "+            }",
                "+        }",
                "+        if (path.contains(\"\")) {",
                "+            path = StringUtils.cleanPath(path);",
                "+            if (path.contains(\"../\")) {",
                "+                return true;",
                "+            }",
                "+        }",
                "+        return false;",
                "     }",
                "@@ -238,4 +258,4 @@ public class ClassPathResource extends AbstractFileResolvingResource {",
                "             return (this.path.equals(otherRes.path) &&",
                "-                thisLoader.equals(otherLoader) &&",
                "-                this.clazz.equals(otherRes.clazz));",
                "+                    thisLoader.equals(otherLoader) &&",
                "+                    this.clazz.equals(otherRes.clazz));",
                "         }"
            ],
            "changed_files": [
                "src/main/java/spark/resource/ClassPathResource.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "981": "Support static files in /META-INF/resources according to Servlet Spec #996 Bump spark-core from 2.5.4 to 2.7.2 open-korean-text/open-korean-text-api#15 Bump spark-core from 2.7.1 to 2.7.2 kabakan/JCollection#1",
                "988": "Bump spark-core from 2.5.4 to 2.7.2 open-korean-text/open-korean-text-api#15 Bump spark-core from 2.7.1 to 2.7.2 kabakan/JCollection#1"
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "2.7.2",
                "2.9.0",
                "2.9.1",
                "2.9.2",
                "2.9.3"
            ],
            "matched_rules": [
                {
                    "id": "XREF_GH",
                    "message": "The commit and the advisory (including referenced pages) mention the same github issue: 981, 988",
                    "relevance": 32
                },
                {
                    "id": "COMMIT_IN_REFERENCE",
                    "message": "This commit is mentioned 8 times in the references.",
                    "relevance": 64
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 981, 988",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "2c29cf30c2344ef5a52b2f5b657fd0c82bee577a",
            "repository": "https://github.com/perwendel/spark",
            "timestamp": 1520332974,
            "hunks": 1,
            "message": "Update pom.xml (#985)",
            "diff": [
                "diff --git a/pom.xml b/pom.xml",
                "index 5ed76d0..5c25d9a 100644",
                "--- a/pom.xml",
                "+++ b/pom.xml",
                "@@ -32,3 +32,3 @@",
                "         <java.version>1.8</java.version>",
                "-        <jetty.version>9.4.6.v20170531</jetty.version>",
                "+        <jetty.version>9.4.8.v20171121</jetty.version>",
                "         <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>"
            ],
            "changed_files": [
                "pom.xml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "985": "Bump spark-core from 2.5.4 to 2.7.2 open-korean-text/open-korean-text-api#15 Bump spark-core from 2.7.1 to 2.7.2 kabakan/JCollection#1"
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "2.7.2",
                "2.9.0",
                "2.9.1",
                "2.9.2",
                "2.9.3"
            ],
            "matched_rules": [
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 985",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "27236534e90bd2bfe339fd65fe6ddd6a9f0304e1",
            "repository": "https://github.com/perwendel/spark",
            "timestamp": 1520419634,
            "hunks": 1,
            "message": "preparing for 2.7.2 maintenance release",
            "diff": [
                "diff --git a/pom.xml b/pom.xml",
                "index 5c25d9a..7d527ae 100644",
                "--- a/pom.xml",
                "+++ b/pom.xml",
                "@@ -11,3 +11,3 @@",
                "     <packaging>bundle</packaging>",
                "-    <version>2.7.2-SNAPSHOT</version>",
                "+    <version>2.7.2</version>",
                "     <name>Spark</name>"
            ],
            "changed_files": [
                "pom.xml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "2.7.2",
                "2.9.0",
                "2.9.1",
                "2.9.2",
                "2.9.3"
            ],
            "matched_rules": []
        }
    ]
}
