{
    "advisory_record": {
        "cve_id": "CVE-2018-18476",
        "description": "mysql-binuuid-rails 1.1.0 and earlier allows SQL Injection because it removes default string escaping for affected database columns.",
        "reserved_timestamp": 1539820800,
        "published_timestamp": 1540414800,
        "updated_timestamp": 1540414621,
        "repository_url": null,
        "references": {
            "": 91,
            "https://github.com/nedap/mysql-binuuid-rails/pull/18": 3,
            "https://github.com": 3,
            "https://gist.github.com/viraptor/881276ea61e8d56bac6e28454c79f1e6": 2,
            "https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fviraptor%2F881276ea61e8d56bac6e28454c79f1e6": 2,
            "https://docs.github.com/articles/which-remote-url-should-i-use": 2,
            "https://docs.github.com/site-policy/github-terms/github-terms-of-service": 2,
            "https://docs.github.com/site-policy/privacy-policies/github-privacy-statement": 2,
            "https://github.com/security": 2,
            "https://www.githubstatus.com/": 2,
            "https://docs.github.com/": 2,
            "https://support.github.com?tags=dotcom-footer": 2,
            "https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax": 2,
            "commit::721815744a11e07e320d51e64b9445abaa9d3bd3": 2,
            "commit::c8e0ee7cbdb5023d22f496c7043f809559b3732b": 2,
            "commit::16ed8470892e570f5c97666c27b04d4d0f79da9c": 2,
            "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-18476": 1,
            "https://github.com/features/actions": 1,
            "https://github.com/features/packages": 1,
            "https://github.com/features/security": 1,
            "https://github.com/features/codespaces": 1,
            "https://github.com/features/copilot": 1,
            "https://github.com/features/code-review": 1,
            "https://github.com/features/issues": 1,
            "https://github.com/features/discussions": 1,
            "https://github.com/features": 1,
            "https://docs.github.com": 1,
            "https://skills.github.com": 1,
            "https://github.blog": 1,
            "https://github.com/enterprise": 1,
            "https://github.com/team": 1,
            "https://github.com/enterprise/startups": 1,
            "https://github.com/solutions/industries/healthcare": 1,
            "https://github.com/solutions/industries/financial-services": 1,
            "https://github.com/solutions/industries/manufacturing": 1,
            "https://github.com/solutions/ci-cd": 1,
            "https://github.com/solutions/devops": 1,
            "https://github.com/solutions/devsecops": 1,
            "https://resources.github.com/learn/pathways": 1,
            "https://resources.github.com": 1,
            "https://github.com/customer-stories": 1,
            "https://partner.github.com": 1,
            "https://github.com/readme": 1,
            "https://github.com/topics": 1,
            "https://github.com/trending": 1,
            "https://github.com/collections": 1,
            "https://github.com/enterprise/advanced-security": 1,
            "https://github.com/pricing": 1,
            "https://docs.github.com/terms": 1,
            "https://docs.github.com/privacy": 1,
            "https://github.co/hiddenchars": 1,
            "commit::9ae920951b46ff0163b16c55d744e89acb1036d4": 1,
            "https://github.com/nedap/mysql-binuuid-rails/pull/18#event-1914199792": 1
        },
        "affected_products": [
            "n/a",
            "Injection",
            "SQL"
        ],
        "versions": {
            "status": "affected",
            "version": "n/a"
        },
        "files": [
            "mysql-binuuid-rails",
            "SQL"
        ],
        "keywords": [
            "mysql",
            "default",
            "escape",
            "string",
            "injection",
            "allow",
            "database",
            "affect",
            "remove",
            "rail",
            "binuuid",
            "column"
        ],
        "files_extension": [],
        "has_fixing_commit": true
    },
    "commits": [
        {
            "commit_id": "9ae920951b46ff0163b16c55d744e89acb1036d4",
            "repository": "https://github.com/nedap/mysql-binuuid-rails",
            "timestamp": 1539938483,
            "hunks": 4,
            "message": "Fix possible SQL injection issue (#18) * Add a validation test case for the SQL injection Signed-off-by: Mark Oude Veldhuis <mark.oudeveldhuis@nedap.com> * Raise exception on invalid UUIDs Signed-off-by: Mark Oude Veldhuis <mark.oudeveldhuis@nedap.com> * Stay within 80 chars, add some comments.",
            "diff": [
                "diff --git a/lib/mysql-binuuid/type.rb b/lib/mysql-binuuid/type.rb",
                "index eea5442..816aed6 100644",
                "--- a/lib/mysql-binuuid/type.rb",
                "+++ b/lib/mysql-binuuid/type.rb",
                "@@ -1,4 +1,5 @@",
                " module MySQLBinUUID",
                "-  class Type < ActiveModel::Type::Binary",
                "+  class InvalidUUID < StandardError; end",
                "+  class Type < ActiveModel::Type::Binary",
                "     def type",
                "@@ -29,3 +30,12 @@ module MySQLBinUUID",
                "       return if value.nil?",
                "-      Data.new(strip_dashes(value))",
                "+      undashed_uuid = strip_dashes(value)",
                "+",
                "+      # To avoid SQL injection, verify that it looks like a UUID. ActiveRecord",
                "+      # does not explicity escape the Binary data type. escaping is implicit as",
                "+      # the Binary data type always converts its value to a hex string.",
                "+      unless valid_undashed_uuid?(undashed_uuid)",
                "+        raise MySQLBinUUID::InvalidUUID, \"#{value} is not a valid UUID\"",
                "+      end",
                "+",
                "+      Data.new(undashed_uuid)",
                "     end",
                "@@ -75,2 +85,7 @@ module MySQLBinUUID",
                "+    # Verify that the undashed version of a UUID only contains characters that",
                "+    # represent a hexadecimal value.",
                "+    def valid_undashed_uuid?(value)",
                "+      value =~ /\\A[[:xdigit:]]{32}\\z/",
                "+    end",
                "   end",
                "diff --git a/test/integration/mysql_integration_test.rb b/test/integration/mysql_integration_test.rb",
                "index e45aa8a..284904e 100644",
                "--- a/test/integration/mysql_integration_test.rb",
                "+++ b/test/integration/mysql_integration_test.rb",
                "@@ -114,2 +114,20 @@ describe MyUuidModel do",
                "     end",
                "+",
                "+    it \"can't be used to inject SQL using .where\" do",
                "+      assert_raises MySQLBinUUID::InvalidUUID do",
                "+        MyUuidModel.where(the_uuid: \"' OR ''='\").first",
                "+      end",
                "+    end",
                "+",
                "+    it \"can't be used to inject SQL using .find_by\" do",
                "+      assert_raises MySQLBinUUID::InvalidUUID do",
                "+        MyUuidModel.find_by(the_uuid: \"' OR ''='\")",
                "+      end",
                "+    end",
                "+",
                "+    it \"can't be used to inject SQL while creating\" do",
                "+      assert_raises MySQLBinUUID::InvalidUUID do",
                "+        MyUuidModel.create!(the_uuid: \"40' + x'40\")",
                "+      end",
                "+    end",
                "   end"
            ],
            "changed_files": [
                "lib/mysql-binuuid/type.rb",
                "test/integration/mysql_integration_test.rb"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "18": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "v1.1.1",
                "v1.2.0",
                "v1.2.1",
                "v1.3.0"
            ],
            "matched_rules": [
                {
                    "id": "XREF_GH",
                    "message": "The commit and the advisory (including referenced pages) mention the same github issue: 18",
                    "relevance": 32
                },
                {
                    "id": "COMMIT_IN_REFERENCE",
                    "message": "This commit is mentioned 1 times in the references.",
                    "relevance": 64
                },
                {
                    "id": "RELEVANT_WORDS_IN_MESSAGE",
                    "message": "The commit message contains some relevant words: SQL",
                    "relevance": 8
                },
                {
                    "id": "CHANGES_RELEVANT_CODE",
                    "message": "The commit modifies code containing relevant filename or methods: SQL",
                    "relevance": 8
                },
                {
                    "id": "SEC_KEYWORDS_IN_MESSAGE",
                    "message": "The commit message contains some security-related keywords: injection",
                    "relevance": 4
                },
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: injection",
                    "relevance": 4
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 18",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "2f89a6a36d8b89ff0eea7b298c99dae517a603fc",
            "repository": "https://github.com/nedap/mysql-binuuid-rails",
            "timestamp": 1539940738,
            "hunks": 1,
            "message": "Prepare version 1.1.1 (#20) * Update CHANGELOG and version for v1.1.1 * Add list of contributors",
            "diff": [
                "diff --git a/lib/mysql-binuuid/version.rb b/lib/mysql-binuuid/version.rb",
                "index 0144996..476bbc7 100644",
                "--- a/lib/mysql-binuuid/version.rb",
                "+++ b/lib/mysql-binuuid/version.rb",
                "@@ -1,3 +1,3 @@",
                " module MySQLBinUUID",
                "-  VERSION = \"1.1.0\"",
                "+  VERSION = \"1.1.1\"",
                " end"
            ],
            "changed_files": [
                "lib/mysql-binuuid/version.rb"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "20": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "v1.1.1",
                "v1.2.0",
                "v1.2.1",
                "v1.3.0"
            ],
            "matched_rules": [
                {
                    "id": "CHANGES_RELEVANT_CODE",
                    "message": "The commit modifies code containing relevant filename or methods: SQL",
                    "relevance": 8
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 20",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "5501bdf86575ce13f28bab8aaa61c70ffedf36a9",
            "repository": "https://github.com/nedap/mysql-binuuid-rails",
            "timestamp": 1539939072,
            "hunks": 1,
            "message": "Switch CI to latest versions of Ruby 2.{3,4,5} (#19)",
            "diff": [
                "diff --git a/.travis.yml b/.travis.yml",
                "index 3b7cff6..96d0e15 100644",
                "--- a/.travis.yml",
                "+++ b/.travis.yml",
                "@@ -3,5 +3,5 @@ cache: bundler",
                " rvm:",
                "-  - 2.3.7",
                "-  - 2.4.4",
                "-  - 2.5.1",
                "+  - 2.3.8",
                "+  - 2.4.5",
                "+  - 2.5.3",
                " env:"
            ],
            "changed_files": [
                ".travis.yml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "19": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "v1.1.1",
                "v1.2.0",
                "v1.2.1",
                "v1.3.0"
            ],
            "matched_rules": [
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 19",
                    "relevance": 2
                }
            ]
        }
    ]
}
