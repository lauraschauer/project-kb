{
    "advisory_record": {
        "cve_id": "CVE-2018-1260",
        "description": "Spring Security OAuth, versions 2.3 prior to 2.3.3, 2.2 prior to 2.2.2, 2.1 prior to 2.1.2, 2.0 prior to 2.0.15 and older unsupported versions contains a remote code execution vulnerability. A malicious user or attacker can craft an authorization request to the authorization endpoint that can lead to remote code execution when the resource owner is forwarded to the approval endpoint.",
        "reserved_timestamp": 1512518400,
        "published_timestamp": 1525824000,
        "updated_timestamp": 1539856621,
        "repository_url": null,
        "references": {
            "": 30,
            "https://access.redhat.com/support/": 10,
            "https://access.redhat.com/downloads/": 8,
            "https://access.redhat.com/errata/": 6,
            "https://access.redhat.com/labs/": 6,
            "https://access.redhat.com/errata/RHSA-2018:1809": 4,
            "https://pivotal.io/security/cve-2018-1260": 4,
            "https://access.redhat.com/errata/RHSA-2018:2939": 4,
            "https://access.redhat.com/management/": 4,
            "https://access.redhat.com/": 4,
            "https://access.redhat.com/products/red-hat-enterprise-linux/": 4,
            "https://access.redhat.com/products/red-hat-openshift-container-platform": 4,
            "https://access.redhat.com/products/red-hat-ansible-automation-platform/": 4,
            "https://access.redhat.com/products/": 4,
            "https://access.redhat.com/documentation": 4,
            "https://access.redhat.com/product-life-cycles/": 4,
            "https://access.redhat.com/security": 4,
            "https://access.redhat.com/security/security-updates/#/security-advisories": 4,
            "https://access.redhat.com/security/security-updates/#/cve": 4,
            "https://access.redhat.com/support/contact/": 4,
            "https://status.redhat.com": 4,
            "http://www.securityfocus.com/bid/104158": 2,
            "https://goo.gl/hKpzJK": 2,
            "https://access.redhat.com/downloads/content/package-browser": 2,
            "https://catalog.redhat.com/software/containers/explore/": 2,
            "https://access.redhat.com/articles/1202803": 2,
            "https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution": 2,
            "https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article": 2,
            "https://access.redhat.com/documentation/en/red_hat_enterprise_linux": 2,
            "https://access.redhat.com/documentation/en/openshift_container_platform": 2,
            "https://access.redhat.com/documentation/en/red_hat_ansible_automation_platform": 2,
            "https://access.redhat.com/documentation/": 2,
            "https://access.redhat.com/security/": 2,
            "https://access.redhat.com/security/vulnerabilities": 2,
            "https://access.redhat.com/security/data": 2,
            "https://access.redhat.com/security/security-updates/#/security-labs": 2,
            "https://access.redhat.com/security/updates/backporting/": 2,
            "https://access.redhat.com/support/cases/": 2,
            "https://access.redhat.com/support/cases/#/troubleshoot": 2,
            "https://access.redhat.com/community": 2,
            "https://access.redhat.com/community/": 2,
            "https://access.redhat.com/discussions/": 2,
            "https://access.redhat.com/announcements/": 2,
            "https://access.redhat.com/accelerators/": 2,
            "https://access.redhat.com/jbossnetwork/restricted/listSoftware.html": 2,
            "https://cloud.redhat.com/insights": 2,
            "https://access.redhat.com/changeLanguage?language=en": 2,
            "https://access.redhat.com/changeLanguage?language=fr": 2,
            "https://access.redhat.com/changeLanguage?language=ko": 2,
            "https://access.redhat.com/changeLanguage?language=ja": 2,
            "https://access.redhat.com/changeLanguage?language=zh_CN": 2,
            "https://access.redhat.com/products/red-hat-satellite/": 2,
            "https://access.redhat.com/products/red-hat-subscription-management/": 2,
            "https://access.redhat.com/products/red-hat-insights/": 2,
            "https://access.redhat.com/products/red-hat-openstack-platform/": 2,
            "https://access.redhat.com/products/red-hat-openshift-container-platform/": 2,
            "https://access.redhat.com/products/red-hat-openshift-ai/": 2,
            "https://access.redhat.com/products/openshift-dedicated-red-hat/": 2,
            "https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/": 2,
            "https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/": 2,
            "https://access.redhat.com/products/red-hat-quay/": 2,
            "https://access.redhat.com/products/red-hat-openshift-dev-spaces": 2,
            "https://access.redhat.com/products/red-hat-openshift-service-aws": 2,
            "https://access.redhat.com/products/red-hat-storage/": 2,
            "https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/": 2,
            "https://access.redhat.com/products/red-hat-ceph-storage/": 2,
            "https://access.redhat.com/products/red-hat-openshift-data-foundation": 2,
            "https://access.redhat.com/products/red-hat-runtimes/": 2,
            "https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/": 2,
            "https://access.redhat.com/products/red-hat-data-grid/": 2,
            "https://access.redhat.com/products/red-hat-jboss-web-server/": 2,
            "https://access.redhat.com/products/red-hat-build-of-keycloak/": 2,
            "https://access.redhat.com/products/spring-boot/": 2,
            "https://access.redhat.com/products/nodejs/": 2,
            "https://access.redhat.com/products/quarkus/": 2,
            "https://access.redhat.com/products/red-hat-application-foundations/": 2,
            "https://access.redhat.com/products/red-hat-fuse/": 2,
            "https://access.redhat.com/products/red-hat-amq/": 2,
            "https://access.redhat.com/products/red-hat-3scale/": 2,
            "https://bugzilla.redhat.com/show_bug.cgi?id=1584376": 2,
            "https://www.redhat.com/security/data/cve/CVE-2018-1260.html": 2,
            "https://access.redhat.com/security/team/contact/": 2,
            "https://redhat.com/en": 2,
            "https://twitter.com/RedHat": 2,
            "https://access.redhat.com/management": 2,
            "https://access.redhat.com/support": 2,
            "https://access.redhat.com/support/customer-service": 2,
            "https://access.redhat.com/articles/33844": 2,
            "https://access.redhat.com/help/login_assistance": 2,
            "https://www.redhat.com/en/trust": 2,
            "https://www.redhat.com/en/about/browser-support": 2,
            "https://www.redhat.com/en/about/digital-accessibility": 2,
            "https://access.redhat.com/recognition/": 2,
            "https://access.redhat.com/help/colophon/": 2,
            "https://www.redhat.com/": 2,
            "http://developers.redhat.com/": 2,
            "https://connect.redhat.com/": 2,
            "https://cloud.redhat.com/": 2,
            "https://access.redhat.com/subscription-value": 2,
            "https://www.redhat.com/about/": 2,
            "http://jobs.redhat.com": 2,
            "https://redhat.com/en/about/company": 2,
            "https://redhat.com/en/jobs": 2,
            "https://redhat.com/en/events": 2,
            "https://redhat.com/en/about/office-locations": 2,
            "https://redhat.com/en/contact": 2,
            "https://redhat.com/en/blog": 2,
            "https://redhat.com/en/about/our-culture/diversity-equity-inclusion": 2,
            "https://coolstuff.redhat.com/": 2,
            "https://www.redhat.com/en/summit": 2,
            "https://redhat.com/en/about/privacy-policy": 2,
            "https://redhat.com/en/about/terms-use": 2,
            "https://redhat.com/en/about/all-policies-guidelines": 2,
            "https://redhat.com/en/about/digital-accessibility": 2,
            "https://bugzilla.redhat.com/show_bug.cgi?id=1578578": 1,
            "https://bugzilla.redhat.com/show_bug.cgi?id=1578902": 1,
            "https://www.redhat.com/security/data/cve/CVE-2018-1257.html": 1,
            "https://www.redhat.com/security/data/cve/CVE-2018-1259.html": 1,
            "https://access.redhat.com/security/updates/classification/#important": 1,
            "https://access.redhat.com/jbossnetwork/restricted/listSoftware.html?product=catRhoar.spring.boot&downloadType=distributions&version=1.5.13": 1,
            "https://access.redhat.com/documentation/en-us/red_hat_openshift_application_runtimes/1/html-single/red_hat_openshift_application_runtimes_release_notes/": 1,
            "https://access.redhat.com/articles/3060411": 1,
            "https://bugzilla.redhat.com/show_bug.cgi?id=1494283": 1,
            "https://bugzilla.redhat.com/show_bug.cgi?id=1548282": 1,
            "https://bugzilla.redhat.com/show_bug.cgi?id=1548289": 1,
            "https://bugzilla.redhat.com/show_bug.cgi?id=1549276": 1,
            "https://bugzilla.redhat.com/show_bug.cgi?id=1564405": 1,
            "https://bugzilla.redhat.com/show_bug.cgi?id=1565307": 1,
            "https://bugzilla.redhat.com/show_bug.cgi?id=1571050": 1,
            "https://bugzilla.redhat.com/show_bug.cgi?id=1607591": 1,
            "https://www.redhat.com/security/data/cve/CVE-2017-12617.html": 1,
            "https://www.redhat.com/security/data/cve/CVE-2018-1270.html": 1,
            "https://www.redhat.com/security/data/cve/CVE-2018-1271.html": 1,
            "https://www.redhat.com/security/data/cve/CVE-2018-1275.html": 1,
            "https://www.redhat.com/security/data/cve/CVE-2018-1304.html": 1,
            "https://www.redhat.com/security/data/cve/CVE-2018-1305.html": 1,
            "https://www.redhat.com/security/data/cve/CVE-2018-1336.html": 1,
            "https://www.redhat.com/security/data/cve/CVE-2018-7489.html": 1,
            "https://access.redhat.com/security/updates/classification/#critical": 1
        },
        "affected_products": [
            "Security",
            "Spring Security OAuth",
            "OAuth",
            "Spring"
        ],
        "versions": {
            "status": "affected",
            "version": "2.3 prior to 2.3.3; 2.2 prior to 2.2.2; 2.1 prior to 2.1.2; 2.0 prior to 2.0.15"
        },
        "files": [],
        "keywords": [
            "spring",
            "security",
            "attacker",
            "authorization",
            "execution",
            "lead",
            "craft",
            "vulnerability",
            "request",
            "oauth",
            "owner",
            "resource",
            "contain",
            "user",
            "code",
            "forward",
            "endpoint",
            "version",
            "approval"
        ],
        "files_extension": [],
        "has_fixing_commit": false
    },
    "commits": [
        {
            "commit_id": "3148a7d89a2a5f3349357b32720b745b13afdc69",
            "repository": "https://github.com/spring-projects/spring-security-oauth",
            "timestamp": 1517497450,
            "hunks": 6,
            "message": "Reduce logging severity in TokenEndpoint Issue gh-1232",
            "diff": [
                "diff --git a/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/endpoint/TokenEndpoint.java b/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/endpoint/TokenEndpoint.java",
                "index e0c703d2..0863cd7e 100644",
                "--- a/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/endpoint/TokenEndpoint.java",
                "+++ b/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/endpoint/TokenEndpoint.java",
                "@@ -18,9 +18,2 @@ package org.springframework.security.oauth2.provider.endpoint;",
                "-import java.security.Principal;",
                "-import java.util.Arrays;",
                "-import java.util.Collections;",
                "-import java.util.HashSet;",
                "-import java.util.Map;",
                "-import java.util.Set;",
                "-",
                " import org.springframework.http.HttpHeaders;",
                "@@ -52,2 +45,9 @@ import org.springframework.web.bind.annotation.RequestParam;",
                "+import java.security.Principal;",
                "+import java.util.Arrays;",
                "+import java.util.Collections;",
                "+import java.util.HashSet;",
                "+import java.util.Map;",
                "+import java.util.Set;",
                "+",
                " /**",
                "@@ -159,4 +159,4 @@ public class TokenEndpoint extends AbstractEndpoint {",
                " \tpublic ResponseEntity<OAuth2Exception> handleHttpRequestMethodNotSupportedException(HttpRequestMethodNotSupportedException e) throws Exception {",
                "-\t    if (logger.isErrorEnabled()) {",
                "-\t\t\tlogger.error(\"Handling error: \" + e.getClass().getSimpleName() + \", \" + e.getMessage(), e);",
                "+\t\tif (logger.isInfoEnabled()) {",
                "+\t\t\tlogger.info(\"Handling error: \" + e.getClass().getSimpleName() + \", \" + e.getMessage());",
                " \t\t}",
                "@@ -167,4 +167,4 @@ public class TokenEndpoint extends AbstractEndpoint {",
                " \tpublic ResponseEntity<OAuth2Exception> handleException(Exception e) throws Exception {",
                "-\t\tif (logger.isErrorEnabled()) {",
                "-\t\t\tlogger.error(\"Handling error: \" + e.getClass().getSimpleName() + \", \" + e.getMessage(), e);",
                "+\t\tif (logger.isWarnEnabled()) {",
                "+\t\t\tlogger.warn(\"Handling error: \" + e.getClass().getSimpleName() + \", \" + e.getMessage());",
                " \t\t}",
                "@@ -175,4 +175,4 @@ public class TokenEndpoint extends AbstractEndpoint {",
                " \tpublic ResponseEntity<OAuth2Exception> handleClientRegistrationException(Exception e) throws Exception {",
                "-\t\tif (logger.isErrorEnabled()) {",
                "-\t\t\tlogger.error(\"Handling error: \" + e.getClass().getSimpleName() + \", \" + e.getMessage(), e);",
                "+\t\tif (logger.isWarnEnabled()) {",
                "+\t\t\tlogger.warn(\"Handling error: \" + e.getClass().getSimpleName() + \", \" + e.getMessage());",
                " \t\t}",
                "@@ -183,4 +183,4 @@ public class TokenEndpoint extends AbstractEndpoint {",
                " \tpublic ResponseEntity<OAuth2Exception> handleException(OAuth2Exception e) throws Exception {",
                "-\t\tif (logger.isErrorEnabled()) {",
                "-\t\t\tlogger.error(\"Handling error: \" + e.getClass().getSimpleName() + \", \" + e.getMessage(), e);",
                "+\t\tif (logger.isWarnEnabled()) {",
                "+\t\t\tlogger.warn(\"Handling error: \" + e.getClass().getSimpleName() + \", \" + e.getMessage());",
                " \t\t}"
            ],
            "changed_files": [
                "spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/endpoint/TokenEndpoint.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "1232": "Vulnerability: Information Exposure through exception #1200 TokenEndpoint: Logging generic exception with ERROR level #1181 2.2.1 introduces error logging for each bad credential error - please revise #1271 Log generic exceptions in TokenEndpoint to ERROR #1545"
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "1.0.10.RELEASE",
                "2.3.0.RC1",
                "2.3.0.RELEASE",
                "2.3.1.RELEASE",
                "2.3.2.RELEASE",
                "2.3.3.RELEASE",
                "2.3.4.RELEASE",
                "2.3.5.RELEASE",
                "2.3.6.RELEASE",
                "2.3.7.RELEASE",
                "2.3.8.RELEASE",
                "2.4.0.RELEASE",
                "2.4.1.RELEASE",
                "2.4.2.RELEASE",
                "2.5.0.M1",
                "2.5.0.RC1",
                "2.5.0.RELEASE",
                "2.5.1.RELEASE",
                "2.5.2.RELEASE",
                "jwt1.0.11.RELEASE",
                "jwt1.1.0.RELEASE",
                "jwt1.1.1.RELEASE"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: endpoint",
                    "relevance": 4
                },
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: endpoint",
                    "relevance": 4
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 1232",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "0bc2a67ff6ce5069652d7a5412e61e0f147ff78e",
            "repository": "https://github.com/spring-projects/spring-security-oauth",
            "timestamp": 1511271354,
            "hunks": 4,
            "message": "Improve logging in TokenEndpoint Fixes gh-1232",
            "diff": [
                "diff --git a/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/endpoint/TokenEndpoint.java b/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/endpoint/TokenEndpoint.java",
                "index ff75badb..e0c703d2 100644",
                "--- a/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/endpoint/TokenEndpoint.java",
                "+++ b/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/endpoint/TokenEndpoint.java",
                "@@ -159,3 +159,5 @@ public class TokenEndpoint extends AbstractEndpoint {",
                " \tpublic ResponseEntity<OAuth2Exception> handleHttpRequestMethodNotSupportedException(HttpRequestMethodNotSupportedException e) throws Exception {",
                "-\t    logger.info(\"Handling error: \" + e.getClass().getSimpleName() + \", \" + e.getMessage());",
                "+\t    if (logger.isErrorEnabled()) {",
                "+\t\t\tlogger.error(\"Handling error: \" + e.getClass().getSimpleName() + \", \" + e.getMessage(), e);",
                "+\t\t}",
                " \t    return getExceptionTranslator().translate(e);",
                "@@ -165,4 +167,6 @@ public class TokenEndpoint extends AbstractEndpoint {",
                " \tpublic ResponseEntity<OAuth2Exception> handleException(Exception e) throws Exception {",
                "-\t    logger.info(\"Handling error: \" + e.getClass().getSimpleName() + \", \" + e.getMessage());",
                "-\t    return getExceptionTranslator().translate(e);",
                "+\t\tif (logger.isErrorEnabled()) {",
                "+\t\t\tlogger.error(\"Handling error: \" + e.getClass().getSimpleName() + \", \" + e.getMessage(), e);",
                "+\t\t}",
                "+\t\treturn getExceptionTranslator().translate(e);",
                " \t}",
                "@@ -171,3 +175,5 @@ public class TokenEndpoint extends AbstractEndpoint {",
                " \tpublic ResponseEntity<OAuth2Exception> handleClientRegistrationException(Exception e) throws Exception {",
                "-\t\tlogger.info(\"Handling error: \" + e.getClass().getSimpleName() + \", \" + e.getMessage());",
                "+\t\tif (logger.isErrorEnabled()) {",
                "+\t\t\tlogger.error(\"Handling error: \" + e.getClass().getSimpleName() + \", \" + e.getMessage(), e);",
                "+\t\t}",
                " \t\treturn getExceptionTranslator().translate(new BadClientCredentialsException());",
                "@@ -177,3 +183,5 @@ public class TokenEndpoint extends AbstractEndpoint {",
                " \tpublic ResponseEntity<OAuth2Exception> handleException(OAuth2Exception e) throws Exception {",
                "-\t\tlogger.info(\"Handling error: \" + e.getClass().getSimpleName() + \", \" + e.getMessage());",
                "+\t\tif (logger.isErrorEnabled()) {",
                "+\t\t\tlogger.error(\"Handling error: \" + e.getClass().getSimpleName() + \", \" + e.getMessage(), e);",
                "+\t\t}",
                " \t\treturn getExceptionTranslator().translate(e);"
            ],
            "changed_files": [
                "spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/endpoint/TokenEndpoint.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "1232": "Vulnerability: Information Exposure through exception #1200 TokenEndpoint: Logging generic exception with ERROR level #1181 2.2.1 introduces error logging for each bad credential error - please revise #1271 Log generic exceptions in TokenEndpoint to ERROR #1545"
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "1.0.10.RELEASE",
                "2.2.1.RELEASE",
                "2.2.2.RELEASE",
                "2.2.3.RELEASE",
                "2.2.4.RELEASE",
                "2.2.5.RELEASE",
                "2.2.6.RELEASE",
                "2.3.0.RC1",
                "2.3.0.RELEASE",
                "2.3.1.RELEASE",
                "2.3.2.RELEASE",
                "2.3.3.RELEASE",
                "2.3.4.RELEASE",
                "2.3.5.RELEASE",
                "2.3.6.RELEASE",
                "2.3.7.RELEASE",
                "2.3.8.RELEASE",
                "2.4.0.RELEASE",
                "2.4.1.RELEASE",
                "2.4.2.RELEASE",
                "2.5.0.M1",
                "2.5.0.RC1",
                "2.5.0.RELEASE",
                "2.5.1.RELEASE",
                "2.5.2.RELEASE",
                "jwt1.0.11.RELEASE",
                "jwt1.0.9.RELEASE",
                "jwt1.1.0.RELEASE",
                "jwt1.1.1.RELEASE"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: endpoint",
                    "relevance": 4
                },
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: endpoint",
                    "relevance": 4
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 1232",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "7219ba461534d8c5eb437568d513baf1fc8ef790",
            "repository": "https://github.com/spring-projects/spring-security-oauth",
            "timestamp": 1511232472,
            "hunks": 2,
            "message": "Fix sslOnly in AuthorizationServerSecurityConfigurer Fixes gh-638",
            "diff": [
                "diff --git a/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/config/annotation/web/configurers/AuthorizationServerSecurityConfigurer.java b/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/config/annotation/web/configurers/AuthorizationServerSecurityConfigurer.java",
                "index b15057d4..3e37e2b4 100644",
                "--- a/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/config/annotation/web/configurers/AuthorizationServerSecurityConfigurer.java",
                "+++ b/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/config/annotation/web/configurers/AuthorizationServerSecurityConfigurer.java",
                "@@ -144,2 +144,5 @@ public final class AuthorizationServerSecurityConfigurer extends",
                " \t\t\t\t.httpBasic().realmName(realm);",
                "+\t\tif (sslOnly) {",
                "+\t\t\thttp.requiresChannel().anyRequest().requiresSecure();",
                "+\t\t}",
                " \t}",
                "@@ -200,6 +203,2 @@ public final class AuthorizationServerSecurityConfigurer extends",
                " \t\thttp.exceptionHandling().accessDeniedHandler(accessDeniedHandler);",
                "-\t\tif (sslOnly) {",
                "-\t\t\thttp.requiresChannel().anyRequest().requiresSecure();",
                "-\t\t}",
                "-",
                " \t}"
            ],
            "changed_files": [
                "spring-security-oauth2/src/main/java/org/springframework/security/oauth2/config/annotation/web/configurers/AuthorizationServerSecurityConfigurer.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "638": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "1.0.10.RELEASE",
                "2.2.1.RELEASE",
                "2.2.2.RELEASE",
                "2.2.3.RELEASE",
                "2.2.4.RELEASE",
                "2.2.5.RELEASE",
                "2.2.6.RELEASE",
                "2.3.0.RC1",
                "2.3.0.RELEASE",
                "2.3.1.RELEASE",
                "2.3.2.RELEASE",
                "2.3.3.RELEASE",
                "2.3.4.RELEASE",
                "2.3.5.RELEASE",
                "2.3.6.RELEASE",
                "2.3.7.RELEASE",
                "2.3.8.RELEASE",
                "2.4.0.RELEASE",
                "2.4.1.RELEASE",
                "2.4.2.RELEASE",
                "2.5.0.M1",
                "2.5.0.RC1",
                "2.5.0.RELEASE",
                "2.5.1.RELEASE",
                "2.5.2.RELEASE",
                "jwt1.0.11.RELEASE",
                "jwt1.0.9.RELEASE",
                "jwt1.1.0.RELEASE",
                "jwt1.1.1.RELEASE"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: authorization",
                    "relevance": 4
                },
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: authorization",
                    "relevance": 4
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 638",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "fed554e6daaf7b086c2d5f22fa7b72494b6ab40f",
            "repository": "https://github.com/spring-projects/spring-security-oauth",
            "timestamp": 1511292657,
            "hunks": 36,
            "message": "Next development version",
            "diff": [
                "diff --git a/pom.xml b/pom.xml",
                "index 3a383f65..a8880103 100644",
                "--- a/pom.xml",
                "+++ b/pom.xml",
                "@@ -7,3 +7,3 @@",
                "   <packaging>pom</packaging>",
                "-  <version>2.2.1.RELEASE</version>",
                "+  <version>2.2.2.BUILD-SNAPSHOT</version>",
                "   <url>http://static.springframework.org/spring-security/oauth</url>",
                "diff --git a/samples/oauth/sparklr/pom.xml b/samples/oauth/sparklr/pom.xml",
                "index 82b940ff..5a3229ec 100644",
                "--- a/samples/oauth/sparklr/pom.xml",
                "+++ b/samples/oauth/sparklr/pom.xml",
                "@@ -7,3 +7,3 @@",
                " \t\t<artifactId>spring-security-oauth-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t\t<relativePath>../../..</relativePath>",
                "diff --git a/samples/oauth/tonr/pom.xml b/samples/oauth/tonr/pom.xml",
                "index 4e2a73a1..8532e075 100644",
                "--- a/samples/oauth/tonr/pom.xml",
                "+++ b/samples/oauth/tonr/pom.xml",
                "@@ -7,3 +7,3 @@",
                " \t\t<artifactId>spring-security-oauth-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t\t<relativePath>../../..</relativePath>",
                "diff --git a/samples/oauth2/sparklr/pom.xml b/samples/oauth2/sparklr/pom.xml",
                "index c2375528..5abff362 100644",
                "--- a/samples/oauth2/sparklr/pom.xml",
                "+++ b/samples/oauth2/sparklr/pom.xml",
                "@@ -7,3 +7,3 @@",
                " \t\t<artifactId>spring-security-oauth-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t\t<relativePath>../../..</relativePath>",
                "diff --git a/samples/oauth2/tonr/pom.xml b/samples/oauth2/tonr/pom.xml",
                "index 9432d513..1495e9f4 100644",
                "--- a/samples/oauth2/tonr/pom.xml",
                "+++ b/samples/oauth2/tonr/pom.xml",
                "@@ -8,3 +8,3 @@",
                " \t\t<artifactId>spring-security-oauth-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t\t<relativePath>../../..</relativePath>",
                "diff --git a/samples/pom.xml b/samples/pom.xml",
                "index 560e2811..0f09d585 100755",
                "--- a/samples/pom.xml",
                "+++ b/samples/pom.xml",
                "@@ -6,3 +6,3 @@",
                "     <artifactId>spring-security-oauth-parent</artifactId>",
                "-    <version>2.2.1.RELEASE</version>",
                "+    <version>2.2.2.BUILD-SNAPSHOT</version>",
                "   </parent>",
                "diff --git a/spring-security-oauth/pom.xml b/spring-security-oauth/pom.xml",
                "index a0ee0b17..38be1fec 100644",
                "--- a/spring-security-oauth/pom.xml",
                "+++ b/spring-security-oauth/pom.xml",
                "@@ -6,3 +6,3 @@",
                " \t\t<artifactId>spring-security-oauth-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/spring-security-oauth2/pom.xml b/spring-security-oauth2/pom.xml",
                "index 20df59ed..f1688143 100644",
                "--- a/spring-security-oauth2/pom.xml",
                "+++ b/spring-security-oauth2/pom.xml",
                "@@ -7,3 +7,3 @@",
                " \t\t<artifactId>spring-security-oauth-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/approval/pom.xml b/tests/annotation/approval/pom.xml",
                "index 4396ab94..ecf9c1aa 100644",
                "--- a/tests/annotation/approval/pom.xml",
                "+++ b/tests/annotation/approval/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/client/pom.xml b/tests/annotation/client/pom.xml",
                "index 6eadb2af..fcb5f24d 100644",
                "--- a/tests/annotation/client/pom.xml",
                "+++ b/tests/annotation/client/pom.xml",
                "@@ -13,3 +13,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/common/pom.xml b/tests/annotation/common/pom.xml",
                "index f60f1870..bdc14012 100644",
                "--- a/tests/annotation/common/pom.xml",
                "+++ b/tests/annotation/common/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/custom-authentication/pom.xml b/tests/annotation/custom-authentication/pom.xml",
                "index cc29623b..5c44beb5 100644",
                "--- a/tests/annotation/custom-authentication/pom.xml",
                "+++ b/tests/annotation/custom-authentication/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/custom-grant/pom.xml b/tests/annotation/custom-grant/pom.xml",
                "index 89fb195a..551ee17a 100644",
                "--- a/tests/annotation/custom-grant/pom.xml",
                "+++ b/tests/annotation/custom-grant/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/form/pom.xml b/tests/annotation/form/pom.xml",
                "index 2fbc4619..2c4eec5c 100644",
                "--- a/tests/annotation/form/pom.xml",
                "+++ b/tests/annotation/form/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/jaxb/pom.xml b/tests/annotation/jaxb/pom.xml",
                "index 7dfc0883..4a85e179 100644",
                "--- a/tests/annotation/jaxb/pom.xml",
                "+++ b/tests/annotation/jaxb/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/jdbc/pom.xml b/tests/annotation/jdbc/pom.xml",
                "index 63854122..10202139 100644",
                "--- a/tests/annotation/jdbc/pom.xml",
                "+++ b/tests/annotation/jdbc/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/jpa/pom.xml b/tests/annotation/jpa/pom.xml",
                "index 3a70af28..f7f2a353 100644",
                "--- a/tests/annotation/jpa/pom.xml",
                "+++ b/tests/annotation/jpa/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/jwt/pom.xml b/tests/annotation/jwt/pom.xml",
                "index 67ba427a..45fb7eab 100644",
                "--- a/tests/annotation/jwt/pom.xml",
                "+++ b/tests/annotation/jwt/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/mappings/pom.xml b/tests/annotation/mappings/pom.xml",
                "index 403e589c..de137cfb 100644",
                "--- a/tests/annotation/mappings/pom.xml",
                "+++ b/tests/annotation/mappings/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/multi/pom.xml b/tests/annotation/multi/pom.xml",
                "index de1d98b6..442d8e2e 100644",
                "--- a/tests/annotation/multi/pom.xml",
                "+++ b/tests/annotation/multi/pom.xml",
                "@@ -11,3 +11,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/pom.xml b/tests/annotation/pom.xml",
                "index 6a5b004e..0fa78bf4 100644",
                "--- a/tests/annotation/pom.xml",
                "+++ b/tests/annotation/pom.xml",
                "@@ -6,3 +6,3 @@",
                " \t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t<version>2.2.1.RELEASE</version>",
                "+\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "     <packaging>pom</packaging>",
                "@@ -41,3 +41,3 @@",
                " \t\t\t<artifactId>spring-security-oauth2</artifactId>",
                "-\t\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t\t\t<exclusions>",
                "diff --git a/tests/annotation/resource/pom.xml b/tests/annotation/resource/pom.xml",
                "index 5dbd79a8..d5f1c455 100644",
                "--- a/tests/annotation/resource/pom.xml",
                "+++ b/tests/annotation/resource/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/ssl/pom.xml b/tests/annotation/ssl/pom.xml",
                "index adce8d2f..ed17a75e 100644",
                "--- a/tests/annotation/ssl/pom.xml",
                "+++ b/tests/annotation/ssl/pom.xml",
                "@@ -13,3 +13,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/vanilla/pom.xml b/tests/annotation/vanilla/pom.xml",
                "index ab71663a..7d9a5bac 100644",
                "--- a/tests/annotation/vanilla/pom.xml",
                "+++ b/tests/annotation/vanilla/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/pom.xml b/tests/pom.xml",
                "index cf215ce7..f7903cb2 100644",
                "--- a/tests/pom.xml",
                "+++ b/tests/pom.xml",
                "@@ -6,3 +6,3 @@",
                "     <artifactId>spring-security-oauth-parent</artifactId>",
                "-    <version>2.2.1.RELEASE</version>",
                "+    <version>2.2.2.BUILD-SNAPSHOT</version>",
                "   </parent>",
                "diff --git a/tests/xml/approval/pom.xml b/tests/xml/approval/pom.xml",
                "index 1c38f3f1..8e53cb44 100644",
                "--- a/tests/xml/approval/pom.xml",
                "+++ b/tests/xml/approval/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-xml-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/xml/client/pom.xml b/tests/xml/client/pom.xml",
                "index 0d737e2d..64df452e 100644",
                "--- a/tests/xml/client/pom.xml",
                "+++ b/tests/xml/client/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-xml-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/xml/common/pom.xml b/tests/xml/common/pom.xml",
                "index a64bc876..2d96a730 100644",
                "--- a/tests/xml/common/pom.xml",
                "+++ b/tests/xml/common/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-xml-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/xml/form/pom.xml b/tests/xml/form/pom.xml",
                "index 6d73cd25..dbf000eb 100644",
                "--- a/tests/xml/form/pom.xml",
                "+++ b/tests/xml/form/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-xml-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/xml/jdbc/pom.xml b/tests/xml/jdbc/pom.xml",
                "index f2f194bc..12b70266 100644",
                "--- a/tests/xml/jdbc/pom.xml",
                "+++ b/tests/xml/jdbc/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-xml-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/xml/jwt/pom.xml b/tests/xml/jwt/pom.xml",
                "index f7ba05f1..d114439c 100644",
                "--- a/tests/xml/jwt/pom.xml",
                "+++ b/tests/xml/jwt/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-xml-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/xml/mappings/pom.xml b/tests/xml/mappings/pom.xml",
                "index 30db2339..bcf69018 100644",
                "--- a/tests/xml/mappings/pom.xml",
                "+++ b/tests/xml/mappings/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-xml-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/xml/pom.xml b/tests/xml/pom.xml",
                "index 92ddda1f..fc50dbc3 100644",
                "--- a/tests/xml/pom.xml",
                "+++ b/tests/xml/pom.xml",
                "@@ -6,3 +6,3 @@",
                " \t<artifactId>spring-oauth2-tests-xml-parent</artifactId>",
                "-\t<version>2.2.1.RELEASE</version>",
                "+\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "     <packaging>pom</packaging>",
                "@@ -35,3 +35,3 @@",
                " \t\t\t<artifactId>spring-security-oauth2</artifactId>",
                "-\t\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t\t\t<exclusions>",
                "diff --git a/tests/xml/vanilla/pom.xml b/tests/xml/vanilla/pom.xml",
                "index acd2c4fb..2aec4de3 100644",
                "--- a/tests/xml/vanilla/pom.xml",
                "+++ b/tests/xml/vanilla/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-xml-parent</artifactId>",
                "-\t\t<version>2.2.1.RELEASE</version>",
                "+\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                " \t</parent>"
            ],
            "changed_files": [
                "pom.xml",
                "samples/oauth/sparklr/pom.xml",
                "samples/oauth/tonr/pom.xml",
                "samples/oauth2/sparklr/pom.xml",
                "samples/oauth2/tonr/pom.xml",
                "samples/pom.xml",
                "spring-security-oauth/pom.xml",
                "spring-security-oauth2/pom.xml",
                "tests/annotation/approval/pom.xml",
                "tests/annotation/client/pom.xml",
                "tests/annotation/common/pom.xml",
                "tests/annotation/custom-authentication/pom.xml",
                "tests/annotation/custom-grant/pom.xml",
                "tests/annotation/form/pom.xml",
                "tests/annotation/jaxb/pom.xml",
                "tests/annotation/jdbc/pom.xml",
                "tests/annotation/jpa/pom.xml",
                "tests/annotation/jwt/pom.xml",
                "tests/annotation/mappings/pom.xml",
                "tests/annotation/multi/pom.xml",
                "tests/annotation/pom.xml",
                "tests/annotation/resource/pom.xml",
                "tests/annotation/ssl/pom.xml",
                "tests/annotation/vanilla/pom.xml",
                "tests/pom.xml",
                "tests/xml/approval/pom.xml",
                "tests/xml/client/pom.xml",
                "tests/xml/common/pom.xml",
                "tests/xml/form/pom.xml",
                "tests/xml/jdbc/pom.xml",
                "tests/xml/jwt/pom.xml",
                "tests/xml/mappings/pom.xml",
                "tests/xml/pom.xml",
                "tests/xml/vanilla/pom.xml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "1.0.10.RELEASE",
                "2.2.2.RELEASE",
                "2.2.3.RELEASE",
                "2.2.4.RELEASE",
                "2.2.5.RELEASE",
                "2.2.6.RELEASE",
                "2.3.0.RC1",
                "2.3.0.RELEASE",
                "2.3.1.RELEASE",
                "2.3.2.RELEASE",
                "2.3.3.RELEASE",
                "2.3.4.RELEASE",
                "2.3.5.RELEASE",
                "2.3.6.RELEASE",
                "2.3.7.RELEASE",
                "2.3.8.RELEASE",
                "2.4.0.RELEASE",
                "2.4.1.RELEASE",
                "2.4.2.RELEASE",
                "2.5.0.M1",
                "2.5.0.RC1",
                "2.5.0.RELEASE",
                "2.5.1.RELEASE",
                "2.5.2.RELEASE",
                "jwt1.0.11.RELEASE",
                "jwt1.0.9.RELEASE",
                "jwt1.1.0.RELEASE",
                "jwt1.1.1.RELEASE"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: version",
                    "relevance": 4
                },
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: resource, approval",
                    "relevance": 4
                }
            ]
        },
        {
            "commit_id": "ffd9d4b90fbb2e3601601c3674260df99fb65f98",
            "repository": "https://github.com/spring-projects/spring-security-oauth",
            "timestamp": 1511288230,
            "hunks": 36,
            "message": "Release version 2.2.1.RELEASE",
            "diff": [
                "diff --git a/pom.xml b/pom.xml",
                "index e376220d..3a383f65 100644",
                "--- a/pom.xml",
                "+++ b/pom.xml",
                "@@ -7,3 +7,3 @@",
                "   <packaging>pom</packaging>",
                "-  <version>2.2.1.BUILD-SNAPSHOT</version>",
                "+  <version>2.2.1.RELEASE</version>",
                "   <url>http://static.springframework.org/spring-security/oauth</url>",
                "diff --git a/samples/oauth/sparklr/pom.xml b/samples/oauth/sparklr/pom.xml",
                "index 336e8333..82b940ff 100644",
                "--- a/samples/oauth/sparklr/pom.xml",
                "+++ b/samples/oauth/sparklr/pom.xml",
                "@@ -7,3 +7,3 @@",
                " \t\t<artifactId>spring-security-oauth-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t\t<relativePath>../../..</relativePath>",
                "diff --git a/samples/oauth/tonr/pom.xml b/samples/oauth/tonr/pom.xml",
                "index 1d7f39bf..4e2a73a1 100644",
                "--- a/samples/oauth/tonr/pom.xml",
                "+++ b/samples/oauth/tonr/pom.xml",
                "@@ -7,3 +7,3 @@",
                " \t\t<artifactId>spring-security-oauth-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t\t<relativePath>../../..</relativePath>",
                "diff --git a/samples/oauth2/sparklr/pom.xml b/samples/oauth2/sparklr/pom.xml",
                "index 72ebfeae..c2375528 100644",
                "--- a/samples/oauth2/sparklr/pom.xml",
                "+++ b/samples/oauth2/sparklr/pom.xml",
                "@@ -7,3 +7,3 @@",
                " \t\t<artifactId>spring-security-oauth-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t\t<relativePath>../../..</relativePath>",
                "diff --git a/samples/oauth2/tonr/pom.xml b/samples/oauth2/tonr/pom.xml",
                "index 174a5eca..9432d513 100644",
                "--- a/samples/oauth2/tonr/pom.xml",
                "+++ b/samples/oauth2/tonr/pom.xml",
                "@@ -8,3 +8,3 @@",
                " \t\t<artifactId>spring-security-oauth-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t\t<relativePath>../../..</relativePath>",
                "diff --git a/samples/pom.xml b/samples/pom.xml",
                "index d4220dba..560e2811 100755",
                "--- a/samples/pom.xml",
                "+++ b/samples/pom.xml",
                "@@ -6,3 +6,3 @@",
                "     <artifactId>spring-security-oauth-parent</artifactId>",
                "-    <version>2.2.1.BUILD-SNAPSHOT</version>",
                "+    <version>2.2.1.RELEASE</version>",
                "   </parent>",
                "diff --git a/spring-security-oauth/pom.xml b/spring-security-oauth/pom.xml",
                "index cd7489f2..a0ee0b17 100644",
                "--- a/spring-security-oauth/pom.xml",
                "+++ b/spring-security-oauth/pom.xml",
                "@@ -6,3 +6,3 @@",
                " \t\t<artifactId>spring-security-oauth-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t</parent>",
                "diff --git a/spring-security-oauth2/pom.xml b/spring-security-oauth2/pom.xml",
                "index 5f196125..20df59ed 100644",
                "--- a/spring-security-oauth2/pom.xml",
                "+++ b/spring-security-oauth2/pom.xml",
                "@@ -7,3 +7,3 @@",
                " \t\t<artifactId>spring-security-oauth-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/approval/pom.xml b/tests/annotation/approval/pom.xml",
                "index a333cda4..4396ab94 100644",
                "--- a/tests/annotation/approval/pom.xml",
                "+++ b/tests/annotation/approval/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/client/pom.xml b/tests/annotation/client/pom.xml",
                "index a71fd9f1..6eadb2af 100644",
                "--- a/tests/annotation/client/pom.xml",
                "+++ b/tests/annotation/client/pom.xml",
                "@@ -13,3 +13,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/common/pom.xml b/tests/annotation/common/pom.xml",
                "index 56115b7b..f60f1870 100644",
                "--- a/tests/annotation/common/pom.xml",
                "+++ b/tests/annotation/common/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/custom-authentication/pom.xml b/tests/annotation/custom-authentication/pom.xml",
                "index ab17ad92..cc29623b 100644",
                "--- a/tests/annotation/custom-authentication/pom.xml",
                "+++ b/tests/annotation/custom-authentication/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/custom-grant/pom.xml b/tests/annotation/custom-grant/pom.xml",
                "index df895e26..89fb195a 100644",
                "--- a/tests/annotation/custom-grant/pom.xml",
                "+++ b/tests/annotation/custom-grant/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/form/pom.xml b/tests/annotation/form/pom.xml",
                "index 2c5f568a..2fbc4619 100644",
                "--- a/tests/annotation/form/pom.xml",
                "+++ b/tests/annotation/form/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/jaxb/pom.xml b/tests/annotation/jaxb/pom.xml",
                "index 69fe5d5f..7dfc0883 100644",
                "--- a/tests/annotation/jaxb/pom.xml",
                "+++ b/tests/annotation/jaxb/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/jdbc/pom.xml b/tests/annotation/jdbc/pom.xml",
                "index 60b12458..63854122 100644",
                "--- a/tests/annotation/jdbc/pom.xml",
                "+++ b/tests/annotation/jdbc/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/jpa/pom.xml b/tests/annotation/jpa/pom.xml",
                "index 0e94bcb1..3a70af28 100644",
                "--- a/tests/annotation/jpa/pom.xml",
                "+++ b/tests/annotation/jpa/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/jwt/pom.xml b/tests/annotation/jwt/pom.xml",
                "index 4568117f..67ba427a 100644",
                "--- a/tests/annotation/jwt/pom.xml",
                "+++ b/tests/annotation/jwt/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/mappings/pom.xml b/tests/annotation/mappings/pom.xml",
                "index ddd25283..403e589c 100644",
                "--- a/tests/annotation/mappings/pom.xml",
                "+++ b/tests/annotation/mappings/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/multi/pom.xml b/tests/annotation/multi/pom.xml",
                "index 65f738aa..de1d98b6 100644",
                "--- a/tests/annotation/multi/pom.xml",
                "+++ b/tests/annotation/multi/pom.xml",
                "@@ -11,3 +11,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/pom.xml b/tests/annotation/pom.xml",
                "index c7cc34a7..6a5b004e 100644",
                "--- a/tests/annotation/pom.xml",
                "+++ b/tests/annotation/pom.xml",
                "@@ -6,3 +6,3 @@",
                " \t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t<version>2.2.1.RELEASE</version>",
                "     <packaging>pom</packaging>",
                "@@ -41,3 +41,3 @@",
                " \t\t\t<artifactId>spring-security-oauth2</artifactId>",
                "-\t\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t\t<version>2.2.1.RELEASE</version>",
                " \t\t\t<exclusions>",
                "diff --git a/tests/annotation/resource/pom.xml b/tests/annotation/resource/pom.xml",
                "index d7069d0d..5dbd79a8 100644",
                "--- a/tests/annotation/resource/pom.xml",
                "+++ b/tests/annotation/resource/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/ssl/pom.xml b/tests/annotation/ssl/pom.xml",
                "index c6078d6d..adce8d2f 100644",
                "--- a/tests/annotation/ssl/pom.xml",
                "+++ b/tests/annotation/ssl/pom.xml",
                "@@ -13,3 +13,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/vanilla/pom.xml b/tests/annotation/vanilla/pom.xml",
                "index 9c5d6009..ab71663a 100644",
                "--- a/tests/annotation/vanilla/pom.xml",
                "+++ b/tests/annotation/vanilla/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t</parent>",
                "diff --git a/tests/pom.xml b/tests/pom.xml",
                "index a3769eb4..cf215ce7 100644",
                "--- a/tests/pom.xml",
                "+++ b/tests/pom.xml",
                "@@ -6,3 +6,3 @@",
                "     <artifactId>spring-security-oauth-parent</artifactId>",
                "-    <version>2.2.1.BUILD-SNAPSHOT</version>",
                "+    <version>2.2.1.RELEASE</version>",
                "   </parent>",
                "diff --git a/tests/xml/approval/pom.xml b/tests/xml/approval/pom.xml",
                "index 9c2b464d..1c38f3f1 100644",
                "--- a/tests/xml/approval/pom.xml",
                "+++ b/tests/xml/approval/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-xml-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t</parent>",
                "diff --git a/tests/xml/client/pom.xml b/tests/xml/client/pom.xml",
                "index 14193833..0d737e2d 100644",
                "--- a/tests/xml/client/pom.xml",
                "+++ b/tests/xml/client/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-xml-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t</parent>",
                "diff --git a/tests/xml/common/pom.xml b/tests/xml/common/pom.xml",
                "index 48f338ec..a64bc876 100644",
                "--- a/tests/xml/common/pom.xml",
                "+++ b/tests/xml/common/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-xml-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t</parent>",
                "diff --git a/tests/xml/form/pom.xml b/tests/xml/form/pom.xml",
                "index cfd0eaf9..6d73cd25 100644",
                "--- a/tests/xml/form/pom.xml",
                "+++ b/tests/xml/form/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-xml-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t</parent>",
                "diff --git a/tests/xml/jdbc/pom.xml b/tests/xml/jdbc/pom.xml",
                "index 0f2971c5..f2f194bc 100644",
                "--- a/tests/xml/jdbc/pom.xml",
                "+++ b/tests/xml/jdbc/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-xml-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t</parent>",
                "diff --git a/tests/xml/jwt/pom.xml b/tests/xml/jwt/pom.xml",
                "index a41f8cd8..f7ba05f1 100644",
                "--- a/tests/xml/jwt/pom.xml",
                "+++ b/tests/xml/jwt/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-xml-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t</parent>",
                "diff --git a/tests/xml/mappings/pom.xml b/tests/xml/mappings/pom.xml",
                "index 5dae238c..30db2339 100644",
                "--- a/tests/xml/mappings/pom.xml",
                "+++ b/tests/xml/mappings/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-xml-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t</parent>",
                "diff --git a/tests/xml/pom.xml b/tests/xml/pom.xml",
                "index 846180f5..92ddda1f 100644",
                "--- a/tests/xml/pom.xml",
                "+++ b/tests/xml/pom.xml",
                "@@ -6,3 +6,3 @@",
                " \t<artifactId>spring-oauth2-tests-xml-parent</artifactId>",
                "-\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t<version>2.2.1.RELEASE</version>",
                "     <packaging>pom</packaging>",
                "@@ -35,3 +35,3 @@",
                " \t\t\t<artifactId>spring-security-oauth2</artifactId>",
                "-\t\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t\t<version>2.2.1.RELEASE</version>",
                " \t\t\t<exclusions>",
                "diff --git a/tests/xml/vanilla/pom.xml b/tests/xml/vanilla/pom.xml",
                "index 6865bd4b..acd2c4fb 100644",
                "--- a/tests/xml/vanilla/pom.xml",
                "+++ b/tests/xml/vanilla/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-xml-parent</artifactId>",
                "-\t\t<version>2.2.1.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.2.1.RELEASE</version>",
                " \t</parent>"
            ],
            "changed_files": [
                "pom.xml",
                "samples/oauth/sparklr/pom.xml",
                "samples/oauth/tonr/pom.xml",
                "samples/oauth2/sparklr/pom.xml",
                "samples/oauth2/tonr/pom.xml",
                "samples/pom.xml",
                "spring-security-oauth/pom.xml",
                "spring-security-oauth2/pom.xml",
                "tests/annotation/approval/pom.xml",
                "tests/annotation/client/pom.xml",
                "tests/annotation/common/pom.xml",
                "tests/annotation/custom-authentication/pom.xml",
                "tests/annotation/custom-grant/pom.xml",
                "tests/annotation/form/pom.xml",
                "tests/annotation/jaxb/pom.xml",
                "tests/annotation/jdbc/pom.xml",
                "tests/annotation/jpa/pom.xml",
                "tests/annotation/jwt/pom.xml",
                "tests/annotation/mappings/pom.xml",
                "tests/annotation/multi/pom.xml",
                "tests/annotation/pom.xml",
                "tests/annotation/resource/pom.xml",
                "tests/annotation/ssl/pom.xml",
                "tests/annotation/vanilla/pom.xml",
                "tests/pom.xml",
                "tests/xml/approval/pom.xml",
                "tests/xml/client/pom.xml",
                "tests/xml/common/pom.xml",
                "tests/xml/form/pom.xml",
                "tests/xml/jdbc/pom.xml",
                "tests/xml/jwt/pom.xml",
                "tests/xml/mappings/pom.xml",
                "tests/xml/pom.xml",
                "tests/xml/vanilla/pom.xml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "1.0.10.RELEASE",
                "2.2.1.RELEASE",
                "2.2.2.RELEASE",
                "2.2.3.RELEASE",
                "2.2.4.RELEASE",
                "2.2.5.RELEASE",
                "2.2.6.RELEASE",
                "2.3.0.RC1",
                "2.3.0.RELEASE",
                "2.3.1.RELEASE",
                "2.3.2.RELEASE",
                "2.3.3.RELEASE",
                "2.3.4.RELEASE",
                "2.3.5.RELEASE",
                "2.3.6.RELEASE",
                "2.3.7.RELEASE",
                "2.3.8.RELEASE",
                "2.4.0.RELEASE",
                "2.4.1.RELEASE",
                "2.4.2.RELEASE",
                "2.5.0.M1",
                "2.5.0.RC1",
                "2.5.0.RELEASE",
                "2.5.1.RELEASE",
                "2.5.2.RELEASE",
                "jwt1.0.11.RELEASE",
                "jwt1.0.9.RELEASE",
                "jwt1.1.0.RELEASE",
                "jwt1.1.1.RELEASE"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: version",
                    "relevance": 4
                },
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: resource, approval",
                    "relevance": 4
                }
            ]
        },
        {
            "commit_id": "af031939a1011b7b21c6b10b2f79b14387bfd60f",
            "repository": "https://github.com/spring-projects/spring-security-oauth",
            "timestamp": 1505474753,
            "hunks": 2,
            "message": "Add Elliptic Curve verification support for spring-security-jwt The implementation is inspired by the RSAVerifier and uses code from org.apache.xml.security.algorithms.implementations.SignatureECDSA to transcode from JWK to JCE compatible signatures. It is meant to be used by the patch to `spring-security-oauth2` which introduces support for *Elliptic Curve* based *JWK* keys. This PR is one of the two PRs to deliver #1159 Fixes gh-1161",
            "diff": [
                "diff --git a/spring-security-jwt/src/main/java/org/springframework/security/jwt/crypto/sign/EllipticCurveKeyHelper.java b/spring-security-jwt/src/main/java/org/springframework/security/jwt/crypto/sign/EllipticCurveKeyHelper.java",
                "new file mode 100644",
                "index 00000000..a9f28307",
                "--- /dev/null",
                "+++ b/spring-security-jwt/src/main/java/org/springframework/security/jwt/crypto/sign/EllipticCurveKeyHelper.java",
                "@@ -0,0 +1,47 @@",
                "+/*",
                "+ * Copyright 2006-2011 the original author or authors.",
                "+ *",
                "+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with",
                "+ * the License. You may obtain a copy of the License at",
                "+ *",
                "+ * http://www.apache.org/licenses/LICENSE-2.0",
                "+ *",
                "+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on",
                "+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the",
                "+ * specific language governing permissions and limitations under the License.",
                "+ */",
                "+package org.springframework.security.jwt.crypto.sign;",
                "+",
                "+import org.bouncycastle.jce.ECNamedCurveTable;",
                "+import org.bouncycastle.jce.spec.ECNamedCurveParameterSpec;",
                "+import org.bouncycastle.jce.spec.ECNamedCurveSpec;",
                "+",
                "+import java.math.BigInteger;",
                "+import java.security.KeyFactory;",
                "+import java.security.interfaces.ECPublicKey;",
                "+import java.security.spec.ECParameterSpec;",
                "+import java.security.spec.ECPoint;",
                "+import java.security.spec.ECPublicKeySpec;",
                "+",
                "+/**",
                "+ * @author Michael Duergner",
                "+ */",
                "+class EllipticCurveKeyHelper {",
                "+",
                "+    static ECPublicKey createPublicKey(final BigInteger x, final BigInteger y, final String curve) {",
                "+        try {",
                "+            ECNamedCurveParameterSpec curveParameterSpec = ECNamedCurveTable.getParameterSpec(curve);",
                "+            ECParameterSpec parameterSpec = new ECNamedCurveSpec(",
                "+                    curveParameterSpec.getName(),",
                "+                    curveParameterSpec.getCurve(),",
                "+                    curveParameterSpec.getG(),",
                "+                    curveParameterSpec.getN());",
                "+            ECPublicKeySpec publicKeySpec = new ECPublicKeySpec(new ECPoint(x, y), parameterSpec);",
                "+",
                "+            return (ECPublicKey) KeyFactory.getInstance(\"EC\").generatePublic(publicKeySpec);",
                "+        }",
                "+        catch (Exception ex) {",
                "+            throw new RuntimeException(ex);",
                "+        }",
                "+    }",
                "+}",
                "diff --git a/spring-security-jwt/src/main/java/org/springframework/security/jwt/crypto/sign/EllipticCurveVerifier.java b/spring-security-jwt/src/main/java/org/springframework/security/jwt/crypto/sign/EllipticCurveVerifier.java",
                "new file mode 100644",
                "index 00000000..10e4e59d",
                "--- /dev/null",
                "+++ b/spring-security-jwt/src/main/java/org/springframework/security/jwt/crypto/sign/EllipticCurveVerifier.java",
                "@@ -0,0 +1,124 @@",
                "+/*",
                "+ * Copyright 2006-2011 the original author or authors.",
                "+ *",
                "+ * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with",
                "+ * the License. You may obtain a copy of the License at",
                "+ *",
                "+ * http://www.apache.org/licenses/LICENSE-2.0",
                "+ *",
                "+ * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on",
                "+ * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the",
                "+ * specific language governing permissions and limitations under the License.",
                "+ */",
                "+package org.springframework.security.jwt.crypto.sign;",
                "+",
                "+import java.math.BigInteger;",
                "+import java.security.GeneralSecurityException;",
                "+import java.security.Signature;",
                "+import java.security.interfaces.ECPublicKey;",
                "+",
                "+/**",
                "+ * @author Michael Duergner",
                "+ */",
                "+public class EllipticCurveVerifier implements SignatureVerifier {",
                "+",
                "+    private final ECPublicKey key;",
                "+",
                "+    private final String algorithm;",
                "+",
                "+    public EllipticCurveVerifier(final BigInteger x, final BigInteger y, final String curve, final String algorithm) {",
                "+        this(EllipticCurveKeyHelper.createPublicKey(x, y, curve), algorithm);",
                "+    }",
                "+",
                "+    public EllipticCurveVerifier(final ECPublicKey key, final String algorithm) {",
                "+        this.key = key;",
                "+        this.algorithm = algorithm;",
                "+    }",
                "+",
                "+    @Override",
                "+    public String algorithm() {",
                "+        return algorithm;",
                "+    }",
                "+",
                "+    @Override",
                "+    public void verify(byte[] content, byte[] sig) {",
                "+        try {",
                "+            Signature signature = Signature.getInstance(algorithm);",
                "+            signature.initVerify(key);",
                "+            signature.update(content);",
                "+",
                "+            if (!signature.verify(transcodeSignatureToDER(sig))) {",
                "+                throw new InvalidSignatureException(\"EC Signature did not match content\");",
                "+            }",
                "+        }",
                "+        catch (GeneralSecurityException e) {",
                "+            throw new RuntimeException(e);",
                "+        }",
                "+    }",
                "+",
                "+    private byte[] transcodeSignatureToDER(byte[] jwsSignature) throws GeneralSecurityException {",
                "+",
                "+        // Adapted from org.apache.xml.security.algorithms.implementations.SignatureECDSA",
                "+",
                "+        int rawLen = jwsSignature.length / 2;",
                "+",
                "+        int i;",
                "+",
                "+        for (i = rawLen; (i > 0) && (jwsSignature[rawLen - i] == 0); i--) {",
                "+            // do nothing",
                "+        }",
                "+",
                "+        int j = i;",
                "+",
                "+        if (jwsSignature[rawLen - i] < 0) {",
                "+            j += 1;",
                "+        }",
                "+",
                "+        int k;",
                "+",
                "+        for (k = rawLen; (k > 0) && (jwsSignature[2 * rawLen - k] == 0); k--) {",
                "+            // do nothing",
                "+        }",
                "+",
                "+        int l = k;",
                "+",
                "+        if (jwsSignature[2 * rawLen - k] < 0) {",
                "+            l += 1;",
                "+        }",
                "+",
                "+        int len = 2 + j + 2 + l;",
                "+",
                "+        if (len > 255) {",
                "+            throw new GeneralSecurityException(\"Invalid ECDSA signature format\");",
                "+        }",
                "+",
                "+        int offset;",
                "+",
                "+        final byte derSignature[];",
                "+",
                "+        if (len < 128) {",
                "+            derSignature = new byte[2 + 2 + j + 2 + l];",
                "+            offset = 1;",
                "+        } else {",
                "+            derSignature = new byte[3 + 2 + j + 2 + l];",
                "+            derSignature[1] = (byte) 0x81;",
                "+            offset = 2;",
                "+        }",
                "+",
                "+        derSignature[0] = 48;",
                "+        derSignature[offset++] = (byte) len;",
                "+        derSignature[offset++] = 2;",
                "+        derSignature[offset++] = (byte) j;",
                "+",
                "+        System.arraycopy(jwsSignature, rawLen - i, derSignature, (offset + j) - i, i);",
                "+",
                "+        offset += j;",
                "+",
                "+        derSignature[offset++] = 2;",
                "+        derSignature[offset++] = (byte) l;",
                "+",
                "+        System.arraycopy(jwsSignature, 2 * rawLen - k, derSignature, (offset + l) - k, k);",
                "+",
                "+        return derSignature;",
                "+    }",
                "+}"
            ],
            "changed_files": [
                "spring-security-jwt/src/main/java/org/springframework/security/jwt/crypto/sign/EllipticCurveKeyHelper.java",
                "spring-security-jwt/src/main/java/org/springframework/security/jwt/crypto/sign/EllipticCurveVerifier.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "1159": "Add Elliptic Curve verification support for spring-security-jwt #1161 Add support for Elliptic Curve JWK signatures #1162 JWK Set parsing fails if provider's set contains non-RSA keys #1213 Add support for Elliptic key as relaying party signing credentials' private key spring-projects/spring-boot#27689",
                "1161": "Add support for Elliptic Curve JWK signatures #1162"
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "1.0.10.RELEASE",
                "2.3.0.RC1",
                "2.3.0.RELEASE",
                "2.3.1.RELEASE",
                "2.3.2.RELEASE",
                "2.3.3.RELEASE",
                "2.3.4.RELEASE",
                "2.3.5.RELEASE",
                "2.3.6.RELEASE",
                "2.3.7.RELEASE",
                "2.3.8.RELEASE",
                "2.4.0.RELEASE",
                "2.4.1.RELEASE",
                "2.4.2.RELEASE",
                "2.5.0.M1",
                "2.5.0.RC1",
                "2.5.0.RELEASE",
                "2.5.1.RELEASE",
                "2.5.2.RELEASE",
                "jwt1.0.11.RELEASE",
                "jwt1.0.9.RELEASE",
                "jwt1.1.0.RELEASE",
                "jwt1.1.1.RELEASE"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: code",
                    "relevance": 4
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 1159, 1161",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "bfdde455698b0213a43ef0d930a598e75347bab4",
            "repository": "https://github.com/spring-projects/spring-security-oauth",
            "timestamp": 1511214397,
            "hunks": 1,
            "message": "Return generic message when error code 'server_error' Fixes gh-1229",
            "diff": [
                "diff --git a/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/error/DefaultWebResponseExceptionTranslator.java b/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/error/DefaultWebResponseExceptionTranslator.java",
                "index 39bb4cf0..26b23b10 100644",
                "--- a/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/error/DefaultWebResponseExceptionTranslator.java",
                "+++ b/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/error/DefaultWebResponseExceptionTranslator.java",
                "@@ -68,3 +68,3 @@ public class DefaultWebResponseExceptionTranslator implements WebResponseExcepti",
                "-\t\treturn handleOAuth2Exception(new ServerErrorException(e.getMessage(), e));",
                "+\t\treturn handleOAuth2Exception(new ServerErrorException(HttpStatus.INTERNAL_SERVER_ERROR.getReasonPhrase(), e));"
            ],
            "changed_files": [
                "spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/error/DefaultWebResponseExceptionTranslator.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "1229": "Vulnerability: Information Exposure through exception #1200"
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "1.0.10.RELEASE",
                "2.2.1.RELEASE",
                "2.2.2.RELEASE",
                "2.2.3.RELEASE",
                "2.2.4.RELEASE",
                "2.2.5.RELEASE",
                "2.2.6.RELEASE",
                "2.3.0.RC1",
                "2.3.0.RELEASE",
                "2.3.1.RELEASE",
                "2.3.2.RELEASE",
                "2.3.3.RELEASE",
                "2.3.4.RELEASE",
                "2.3.5.RELEASE",
                "2.3.6.RELEASE",
                "2.3.7.RELEASE",
                "2.3.8.RELEASE",
                "2.4.0.RELEASE",
                "2.4.1.RELEASE",
                "2.4.2.RELEASE",
                "2.5.0.M1",
                "2.5.0.RC1",
                "2.5.0.RELEASE",
                "2.5.1.RELEASE",
                "2.5.2.RELEASE",
                "jwt1.0.11.RELEASE",
                "jwt1.0.9.RELEASE",
                "jwt1.1.0.RELEASE",
                "jwt1.1.1.RELEASE"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: code",
                    "relevance": 4
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 1229",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "181cae9a4f535cf0b22c90017911e1de78b14e67",
            "repository": "https://github.com/spring-projects/spring-security-oauth",
            "timestamp": 1505475068,
            "hunks": 20,
            "message": "Add support for Elliptic Curve JWK signatures This will utilize the changes to spring-security-jwt for handling EC signatures. It integrates fully into the existing codebase and will simply allow to verify signatures based on EC when they are read from a JWK definition. This PR depends on #1161 to be merged. Once this PR is merged a new version of `spring-security-jwt` should be released and this PR needs to be updated to use the final version instead of the `1.0.9.BUILD-SNAPSHOT` version it currently uses. This PR is the seconds part of delivering #1159 Fixes gh-1159",
            "diff": [
                "diff --git a/spring-security-oauth2/pom.xml b/spring-security-oauth2/pom.xml",
                "index 1f62494e..b6fc2504 100644",
                "--- a/spring-security-oauth2/pom.xml",
                "+++ b/spring-security-oauth2/pom.xml",
                "@@ -18,3 +18,3 @@",
                " \t\t<servlet-api.version>3.0.1</servlet-api.version>",
                "-\t\t<spring.security.jwt.version>1.0.8.RELEASE</spring.security.jwt.version>",
                "+\t\t<spring.security.jwt.version>1.0.9.BUILD-SNAPSHOT</spring.security.jwt.version>",
                " \t\t<junit.version>4.11</junit.version>",
                "diff --git a/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/EllipticCurveJwkDefinition.java b/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/EllipticCurveJwkDefinition.java",
                "new file mode 100644",
                "index 00000000..dc5191b2",
                "--- /dev/null",
                "+++ b/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/EllipticCurveJwkDefinition.java",
                "@@ -0,0 +1,52 @@",
                "+package org.springframework.security.oauth2.provider.token.store.jwk;",
                "+",
                "+/**",
                "+ * A JSON Web Key (JWK) representation of an Elliptic Curve key.",
                "+ *",
                "+ * @see <a target=\"_blank\" href=\"https://tools.ietf.org/html/rfc7517\">JSON Web Key (JWK)</a>",
                "+ * @see <a target=\"_blank\" href=\"https://tools.ietf.org/html/rfc7518#page-28\">JSON Web Algorithms (JWA)</a>",
                "+ *",
                "+ * @author Michael Duergner <michael@sprucehill.io>",
                "+ */",
                "+final class EllipticCurveJwkDefinition extends JwkDefinition {",
                "+",
                "+    private final String x;",
                "+",
                "+    private final String y;",
                "+",
                "+    private final String curve;",
                "+",
                "+    /**",
                "+     * Creates an instance of an Elliptic Curve JSON Web Key (JWK).",
                "+     *",
                "+     * @param keyId        the Key ID",
                "+     * @param publicKeyUse the intended use of the Public Key",
                "+     * @param algorithm    the algorithm intended to be used",
                "+     * @param x            the x value to be used",
                "+     * @param y            the y value to be used",
                "+     * @param curve        the curve to be used",
                "+     */",
                "+    EllipticCurveJwkDefinition(String keyId,",
                "+                                         PublicKeyUse publicKeyUse,",
                "+                                         CryptoAlgorithm algorithm,",
                "+                                         String x,",
                "+                                         String y,",
                "+                                         String curve) {",
                "+        super(keyId, KeyType.EC, publicKeyUse, algorithm);",
                "+        this.x = x;",
                "+        this.y = y;",
                "+        this.curve = curve;",
                "+    }",
                "+",
                "+    String getX() {",
                "+        return x;",
                "+    }",
                "+",
                "+    String getY() {",
                "+        return y;",
                "+    }",
                "+",
                "+    String getCurve() {",
                "+        return curve;",
                "+    }",
                "+}",
                "diff --git a/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkAttributes.java b/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkAttributes.java",
                "index 642dcc43..b5a2b333 100644",
                "--- a/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkAttributes.java",
                "+++ b/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkAttributes.java",
                "@@ -21,2 +21,3 @@ package org.springframework.security.oauth2.provider.token.store.jwk;",
                "  * @author Joe Grandja",
                "+ * @author Michael Duergner",
                "  */",
                "@@ -56,2 +57,17 @@ final class JwkAttributes {",
                "+\t/**",
                "+\t * The &quot;x&quot; parameter contains the x value for a EC public key.",
                "+\t */",
                "+\tstatic final String EC_PUBLIC_KEY_X = \"x\";",
                "+",
                "+\t/**",
                "+\t * The &quot;y&quot; parameter contains the y value for a EC public key.",
                "+\t */",
                "+\tstatic final String EC_PUBLIC_KEY_Y = \"y\";",
                "+",
                "+\t/**",
                "+\t * The &quot;crv&quot; (curve) parameter contains the curve value for a EC public key.",
                "+\t */",
                "+\tstatic final String EC_PUBLIC_KEY_CURVE = \"crv\";",
                "+",
                " \t/**",
                "@@ -61,2 +77,2 @@ final class JwkAttributes {",
                " \tstatic final String KEYS = \"keys\";",
                "-}",
                "\\ No newline at end of file",
                "+}",
                "diff --git a/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkDefinition.java b/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkDefinition.java",
                "index 2768ca3f..95e37a21 100644",
                "--- a/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkDefinition.java",
                "+++ b/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkDefinition.java",
                "@@ -23,2 +23,3 @@ package org.springframework.security.oauth2.provider.token.store.jwk;",
                "  * @author Joe Grandja",
                "+ * @author Michael Duergner",
                "  */",
                "@@ -166,3 +167,6 @@ abstract class JwkDefinition {",
                " \t\tRS384(\"SHA384withRSA\", \"RS384\"),",
                "-\t\tRS512(\"SHA512withRSA\", \"RS512\");",
                "+\t\tRS512(\"SHA512withRSA\", \"RS512\"),",
                "+\t\tES256(\"SHA256withECDSA\", \"ES256\"),",
                "+\t\tES384(\"SHA384withECDSA\", \"ES384\"),",
                "+\t\tES512(\"SHA512withECDSA\", \"ES512\");",
                "@@ -195,2 +199,2 @@ abstract class JwkDefinition {",
                " \t}",
                "-}",
                "\\ No newline at end of file",
                "+}",
                "diff --git a/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkDefinitionSource.java b/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkDefinitionSource.java",
                "index 1db5f8e4..079de4de 100644",
                "--- a/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkDefinitionSource.java",
                "+++ b/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkDefinitionSource.java",
                "@@ -18,2 +18,4 @@ package org.springframework.security.oauth2.provider.token.store.jwk;",
                " import org.springframework.security.jwt.codec.Codecs;",
                "+import org.springframework.security.jwt.crypto.sign.EllipticCurveKeyHelper;",
                "+import org.springframework.security.jwt.crypto.sign.EllipticCurveVerifier;",
                " import org.springframework.security.jwt.crypto.sign.RsaVerifier;",
                "@@ -27,2 +29,3 @@ import java.net.URL;",
                " import java.security.KeyFactory;",
                "+import java.security.interfaces.ECPublicKey;",
                " import java.security.interfaces.RSAPublicKey;",
                "@@ -42,2 +45,3 @@ import java.util.concurrent.ConcurrentHashMap;",
                "  * @author Joe Grandja",
                "+ * @author Michael Duergner",
                "  */",
                "@@ -133,2 +137,6 @@ class JwkDefinitionSource {",
                " \t\t\t}",
                "+\t\t\telse if (JwkDefinition.KeyType.EC.equals(jwkDefinition.getKeyType())) {",
                "+\t\t\t\tjwkDefinitions.put(jwkDefinition.getKeyId(),",
                "+\t\t\t\t\t\tnew JwkDefinitionHolder(jwkDefinition, createEcVerifier((EllipticCurveJwkDefinition) jwkDefinition)));",
                "+\t\t\t}",
                " \t\t}",
                "@@ -160,2 +168,19 @@ class JwkDefinitionSource {",
                "+\tprivate static EllipticCurveVerifier createEcVerifier(EllipticCurveJwkDefinition ecDefinition) {",
                "+\t\tEllipticCurveVerifier result;",
                "+\t\ttry {",
                "+\t\t\tBigInteger x = new BigInteger(1, Codecs.b64UrlDecode(ecDefinition.getX()));",
                "+\t\t\tBigInteger y = new BigInteger(1, Codecs.b64UrlDecode(ecDefinition.getY()));",
                "+",
                "+\t\t\tECPublicKey ecPublicKey = EllipticCurveKeyHelper.createPublicKey(x, y, ecDefinition.getCurve());",
                "+",
                "+\t\t\tresult = new EllipticCurveVerifier(ecPublicKey, ecDefinition.getAlgorithm().standardName());",
                "+",
                "+\t\t} catch (Exception ex) {",
                "+\t\t\tthrow new JwkException(\"An error occurred while creating a EC Public Key Verifier for \" +",
                "+\t\t\t\t\tecDefinition.getKeyId() + \" : \" + ex.getMessage(), ex);",
                "+\t\t}",
                "+\t\treturn result;",
                "+\t}",
                "+",
                " \tstatic class JwkDefinitionHolder {",
                "@@ -177,2 +202,2 @@ class JwkDefinitionSource {",
                " \t}",
                "-}",
                "\\ No newline at end of file",
                "+}",
                "diff --git a/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkSetConverter.java b/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkSetConverter.java",
                "index fdfbb929..7775d749 100644",
                "--- a/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkSetConverter.java",
                "+++ b/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkSetConverter.java",
                "@@ -48,2 +48,3 @@ import static org.springframework.security.oauth2.provider.token.store.jwk.JwkAt",
                "  * @author Vedran Pavic",
                "+ * @author Michael Duergner",
                "  */",
                "@@ -117,2 +118,27 @@ class JwkSetConverter implements Converter<InputStream, Set<JwkDefinition>> {",
                "+\t/**",
                "+\t * Creates a {@link JwkDefinition} based on the supplied attributes.",
                "+\t *",
                "+\t * @param attributes the attributes used to create the {@link JwkDefinition}",
                "+\t * @return a {@link JwkDefinition}",
                "+\t * @throws JwkException if the Key Type (&quot;kty&quot;) attribute value is not {@link JwkDefinition.KeyType#RSA}",
                "+\t */",
                "+\tprivate JwkDefinition createJwkDefinition(Map<String, String> attributes) {",
                "+\t\tJwkDefinition.KeyType keyType =",
                "+\t\t\t\tJwkDefinition.KeyType.fromValue(attributes.get(KEY_TYPE));",
                "+",
                "+\t\tif (JwkDefinition.KeyType.RSA.equals(keyType)) {",
                "+\t\t\treturn this.createRsaJwkDefinition(attributes);",
                "+\t\t}",
                "+\t\telse if (JwkDefinition.KeyType.EC.equals(keyType)) {",
                "+\t\t\treturn this.createEllipticCurveJwkDefinition(attributes);",
                "+\t\t}",
                "+\t\telse {",
                "+\t\t\tthrow new JwkException((keyType != null ? keyType.value() : \"unknown\") +",
                "+\t\t\t\t\t\" (\" + KEY_TYPE + \") is currently not supported.\" +",
                "+\t\t\t\t\t\" Valid values for '\" + KEY_TYPE + \"' are: \" + JwkDefinition.KeyType.RSA.value() +",
                "+\t\t\t\t\t\", \" + JwkDefinition.KeyType.EC.value());",
                "+\t\t}",
                "+\t}",
                "+",
                " \t/**",
                "@@ -166,2 +192,58 @@ class JwkSetConverter implements Converter<InputStream, Set<JwkDefinition>> {",
                " \t}",
                "+",
                "+\t/**",
                "+\t * Creates a {@link EllipticCurveJwkDefinition} based on the supplied attributes.",
                "+\t *",
                "+\t * @param attributes the attributes used to create the {@link EllipticCurveJwkDefinition}",
                "+\t * @return a {@link JwkDefinition} representation of a EC Key",
                "+\t * @throws JwkException if at least one attribute value is missing or invalid for a EC Key",
                "+\t */",
                "+\tprivate JwkDefinition createEllipticCurveJwkDefinition(Map<String, String> attributes) {",
                "+\t\t// kid",
                "+\t\tString keyId = attributes.get(KEY_ID);",
                "+\t\tif (!StringUtils.hasText(keyId)) {",
                "+\t\t\tthrow new JwkException(KEY_ID + \" is a required attribute for a JWK.\");",
                "+\t\t}",
                "+",
                "+\t\t// use",
                "+\t\tJwkDefinition.PublicKeyUse publicKeyUse =",
                "+\t\t\t\tJwkDefinition.PublicKeyUse.fromValue(attributes.get(PUBLIC_KEY_USE));",
                "+\t\tif (!JwkDefinition.PublicKeyUse.SIG.equals(publicKeyUse)) {",
                "+\t\t\tthrow new JwkException((publicKeyUse != null ? publicKeyUse.value() : \"unknown\") +",
                "+\t\t\t\t\t\" (\" + PUBLIC_KEY_USE + \") is currently not supported.\");",
                "+\t\t}",
                "+",
                "+\t\t// alg",
                "+\t\tJwkDefinition.CryptoAlgorithm algorithm =",
                "+\t\t\t\tJwkDefinition.CryptoAlgorithm.fromHeaderParamValue(attributes.get(ALGORITHM));",
                "+\t\tif (algorithm != null &&",
                "+\t\t\t\t!JwkDefinition.CryptoAlgorithm.ES256.equals(algorithm) &&",
                "+\t\t\t\t!JwkDefinition.CryptoAlgorithm.ES384.equals(algorithm) &&",
                "+\t\t\t\t!JwkDefinition.CryptoAlgorithm.ES512.equals(algorithm)) {",
                "+\t\t\tthrow new JwkException(algorithm.standardName() + \" (\" + ALGORITHM + \") is currently not supported.\");",
                "+\t\t}",
                "+",
                "+\t\t// x",
                "+\t\tString x = attributes.get(EC_PUBLIC_KEY_X);",
                "+\t\tif (!StringUtils.hasText(x)) {",
                "+\t\t\tthrow new JwkException(EC_PUBLIC_KEY_X + \" is a required attribute for a EC JWK.\");",
                "+\t\t}",
                "+",
                "+\t\t// y",
                "+\t\tString y = attributes.get(EC_PUBLIC_KEY_Y);",
                "+\t\tif (!StringUtils.hasText(y)) {",
                "+\t\t\tthrow new JwkException(EC_PUBLIC_KEY_Y + \" is a required attribute for a EC JWK.\");",
                "+\t\t}",
                "+",
                "+\t\t// crv",
                "+\t\tString curve = attributes.get(EC_PUBLIC_KEY_CURVE);",
                "+\t\tif (!StringUtils.hasText(curve)) {",
                "+\t\t\tthrow new JwkException(EC_PUBLIC_KEY_CURVE + \" is a required attribute for a EC JWK.\");",
                "+\t\t}",
                "+",
                "+\t\tEllipticCurveJwkDefinition jwkDefinition = new EllipticCurveJwkDefinition(",
                "+\t\t\t\tkeyId, publicKeyUse, algorithm, x, y, curve);",
                "+",
                "+\t\treturn jwkDefinition;",
                "+\t}",
                " }"
            ],
            "changed_files": [
                "spring-security-oauth2/pom.xml",
                "spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/EllipticCurveJwkDefinition.java",
                "spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkAttributes.java",
                "spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkDefinition.java",
                "spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkDefinitionSource.java",
                "spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkSetConverter.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "1161": "Add support for Elliptic Curve JWK signatures #1162",
                "1159": "Add Elliptic Curve verification support for spring-security-jwt #1161 Add support for Elliptic Curve JWK signatures #1162 JWK Set parsing fails if provider's set contains non-RSA keys #1213 Add support for Elliptic key as relaying party signing credentials' private key spring-projects/spring-boot#27689"
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "1.0.10.RELEASE",
                "2.3.0.RC1",
                "2.3.0.RELEASE",
                "2.3.1.RELEASE",
                "2.3.2.RELEASE",
                "2.3.3.RELEASE",
                "2.3.4.RELEASE",
                "2.3.5.RELEASE",
                "2.3.6.RELEASE",
                "2.3.7.RELEASE",
                "2.3.8.RELEASE",
                "2.4.0.RELEASE",
                "2.4.1.RELEASE",
                "2.4.2.RELEASE",
                "2.5.0.M1",
                "2.5.0.RC1",
                "2.5.0.RELEASE",
                "2.5.1.RELEASE",
                "2.5.2.RELEASE",
                "jwt1.0.11.RELEASE",
                "jwt1.1.0.RELEASE",
                "jwt1.1.1.RELEASE"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: code, version",
                    "relevance": 4
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 1161, 1159",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "dd9eabd7016ff7863cd307892ef047d3f05912f1",
            "repository": "https://github.com/spring-projects/spring-security-oauth",
            "timestamp": 1511209237,
            "hunks": 1,
            "message": "Disable spring5 travis build Fixes gh-1227",
            "diff": [
                "diff --git a/.travis.yml b/.travis.yml",
                "index 5a871cb6..d9940bd6 100644",
                "--- a/.travis.yml",
                "+++ b/.travis.yml",
                "@@ -14,3 +14,3 @@ script:",
                "   - ./mvnw clean test -P bootstrap",
                "-  - jdk_switcher use oraclejdk8",
                "-  - ./mvnw -U clean test -P spring5",
                "+#  - jdk_switcher use oraclejdk8",
                "+#  - ./mvnw -U clean test -P spring5"
            ],
            "changed_files": [
                ".travis.yml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "1227": "Disable spring5 travis build #1228"
            },
            "cve_refs": [],
            "twins": [
                [
                    "no-tag",
                    "748e15170bd9dad24d2cb8b2702cf3412b2b1fc8"
                ]
            ],
            "tags": [
                "1.0.10.RELEASE",
                "2.2.1.RELEASE",
                "2.2.2.RELEASE",
                "2.2.3.RELEASE",
                "2.2.4.RELEASE",
                "2.2.5.RELEASE",
                "2.2.6.RELEASE",
                "2.3.0.RC1",
                "2.3.0.RELEASE",
                "2.3.1.RELEASE",
                "2.3.2.RELEASE",
                "2.3.3.RELEASE",
                "2.3.4.RELEASE",
                "2.3.5.RELEASE",
                "2.3.6.RELEASE",
                "2.3.7.RELEASE",
                "2.3.8.RELEASE",
                "2.4.0.RELEASE",
                "2.4.1.RELEASE",
                "2.4.2.RELEASE",
                "2.5.0.M1",
                "2.5.0.RC1",
                "2.5.0.RELEASE",
                "2.5.1.RELEASE",
                "2.5.2.RELEASE",
                "jwt1.0.11.RELEASE",
                "jwt1.0.9.RELEASE",
                "jwt1.1.0.RELEASE",
                "jwt1.1.1.RELEASE"
            ],
            "matched_rules": [
                {
                    "id": "COMMIT_HAS_TWINS",
                    "message": "This commit has one or more twins.",
                    "relevance": 2
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 1227",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "0e7e6ced73af209dad6a81f37d09bc4b7a6cb0d9",
            "repository": "https://github.com/spring-projects/spring-security-oauth",
            "timestamp": 1513786727,
            "hunks": 36,
            "message": "Update to 2.3.0.BUILD-SNAPSHOT",
            "diff": [
                "diff --git a/pom.xml b/pom.xml",
                "index a8880103..7a08ceff 100644",
                "--- a/pom.xml",
                "+++ b/pom.xml",
                "@@ -7,3 +7,3 @@",
                "   <packaging>pom</packaging>",
                "-  <version>2.2.2.BUILD-SNAPSHOT</version>",
                "+  <version>2.3.0.BUILD-SNAPSHOT</version>",
                "   <url>http://static.springframework.org/spring-security/oauth</url>",
                "diff --git a/samples/oauth/sparklr/pom.xml b/samples/oauth/sparklr/pom.xml",
                "index 5a3229ec..c1df19f8 100644",
                "--- a/samples/oauth/sparklr/pom.xml",
                "+++ b/samples/oauth/sparklr/pom.xml",
                "@@ -7,3 +7,3 @@",
                " \t\t<artifactId>spring-security-oauth-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t\t<relativePath>../../..</relativePath>",
                "diff --git a/samples/oauth/tonr/pom.xml b/samples/oauth/tonr/pom.xml",
                "index 8532e075..7e2617e9 100644",
                "--- a/samples/oauth/tonr/pom.xml",
                "+++ b/samples/oauth/tonr/pom.xml",
                "@@ -7,3 +7,3 @@",
                " \t\t<artifactId>spring-security-oauth-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t\t<relativePath>../../..</relativePath>",
                "diff --git a/samples/oauth2/sparklr/pom.xml b/samples/oauth2/sparklr/pom.xml",
                "index 5abff362..807a790f 100644",
                "--- a/samples/oauth2/sparklr/pom.xml",
                "+++ b/samples/oauth2/sparklr/pom.xml",
                "@@ -7,3 +7,3 @@",
                " \t\t<artifactId>spring-security-oauth-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t\t<relativePath>../../..</relativePath>",
                "diff --git a/samples/oauth2/tonr/pom.xml b/samples/oauth2/tonr/pom.xml",
                "index 1495e9f4..f154e316 100644",
                "--- a/samples/oauth2/tonr/pom.xml",
                "+++ b/samples/oauth2/tonr/pom.xml",
                "@@ -8,3 +8,3 @@",
                " \t\t<artifactId>spring-security-oauth-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t\t<relativePath>../../..</relativePath>",
                "diff --git a/samples/pom.xml b/samples/pom.xml",
                "index 0f09d585..baa915d3 100755",
                "--- a/samples/pom.xml",
                "+++ b/samples/pom.xml",
                "@@ -6,3 +6,3 @@",
                "     <artifactId>spring-security-oauth-parent</artifactId>",
                "-    <version>2.2.2.BUILD-SNAPSHOT</version>",
                "+    <version>2.3.0.BUILD-SNAPSHOT</version>",
                "   </parent>",
                "diff --git a/spring-security-oauth/pom.xml b/spring-security-oauth/pom.xml",
                "index 38be1fec..0e5c5ffc 100644",
                "--- a/spring-security-oauth/pom.xml",
                "+++ b/spring-security-oauth/pom.xml",
                "@@ -6,3 +6,3 @@",
                " \t\t<artifactId>spring-security-oauth-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/spring-security-oauth2/pom.xml b/spring-security-oauth2/pom.xml",
                "index f1688143..1f62494e 100644",
                "--- a/spring-security-oauth2/pom.xml",
                "+++ b/spring-security-oauth2/pom.xml",
                "@@ -7,3 +7,3 @@",
                " \t\t<artifactId>spring-security-oauth-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/approval/pom.xml b/tests/annotation/approval/pom.xml",
                "index ecf9c1aa..127ad31c 100644",
                "--- a/tests/annotation/approval/pom.xml",
                "+++ b/tests/annotation/approval/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/client/pom.xml b/tests/annotation/client/pom.xml",
                "index fcb5f24d..62acafef 100644",
                "--- a/tests/annotation/client/pom.xml",
                "+++ b/tests/annotation/client/pom.xml",
                "@@ -13,3 +13,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/common/pom.xml b/tests/annotation/common/pom.xml",
                "index bdc14012..09439b8f 100644",
                "--- a/tests/annotation/common/pom.xml",
                "+++ b/tests/annotation/common/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/custom-authentication/pom.xml b/tests/annotation/custom-authentication/pom.xml",
                "index 5c44beb5..b906b375 100644",
                "--- a/tests/annotation/custom-authentication/pom.xml",
                "+++ b/tests/annotation/custom-authentication/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/custom-grant/pom.xml b/tests/annotation/custom-grant/pom.xml",
                "index 551ee17a..0aaf0caa 100644",
                "--- a/tests/annotation/custom-grant/pom.xml",
                "+++ b/tests/annotation/custom-grant/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/form/pom.xml b/tests/annotation/form/pom.xml",
                "index 2c4eec5c..cebdb4ff 100644",
                "--- a/tests/annotation/form/pom.xml",
                "+++ b/tests/annotation/form/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/jaxb/pom.xml b/tests/annotation/jaxb/pom.xml",
                "index 4a85e179..8253c992 100644",
                "--- a/tests/annotation/jaxb/pom.xml",
                "+++ b/tests/annotation/jaxb/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/jdbc/pom.xml b/tests/annotation/jdbc/pom.xml",
                "index 10202139..e653eba2 100644",
                "--- a/tests/annotation/jdbc/pom.xml",
                "+++ b/tests/annotation/jdbc/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/jpa/pom.xml b/tests/annotation/jpa/pom.xml",
                "index f7f2a353..b393b73f 100644",
                "--- a/tests/annotation/jpa/pom.xml",
                "+++ b/tests/annotation/jpa/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/jwt/pom.xml b/tests/annotation/jwt/pom.xml",
                "index 45fb7eab..2d141b0f 100644",
                "--- a/tests/annotation/jwt/pom.xml",
                "+++ b/tests/annotation/jwt/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/mappings/pom.xml b/tests/annotation/mappings/pom.xml",
                "index de137cfb..c105e92c 100644",
                "--- a/tests/annotation/mappings/pom.xml",
                "+++ b/tests/annotation/mappings/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/multi/pom.xml b/tests/annotation/multi/pom.xml",
                "index 442d8e2e..fb232a9f 100644",
                "--- a/tests/annotation/multi/pom.xml",
                "+++ b/tests/annotation/multi/pom.xml",
                "@@ -11,3 +11,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/pom.xml b/tests/annotation/pom.xml",
                "index 0fa78bf4..1eeb1f07 100644",
                "--- a/tests/annotation/pom.xml",
                "+++ b/tests/annotation/pom.xml",
                "@@ -6,3 +6,3 @@",
                " \t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                "     <packaging>pom</packaging>",
                "@@ -41,3 +41,3 @@",
                " \t\t\t<artifactId>spring-security-oauth2</artifactId>",
                "-\t\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t\t\t<exclusions>",
                "diff --git a/tests/annotation/resource/pom.xml b/tests/annotation/resource/pom.xml",
                "index d5f1c455..6c8ecb89 100644",
                "--- a/tests/annotation/resource/pom.xml",
                "+++ b/tests/annotation/resource/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/ssl/pom.xml b/tests/annotation/ssl/pom.xml",
                "index ed17a75e..8d0238da 100644",
                "--- a/tests/annotation/ssl/pom.xml",
                "+++ b/tests/annotation/ssl/pom.xml",
                "@@ -13,3 +13,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/annotation/vanilla/pom.xml b/tests/annotation/vanilla/pom.xml",
                "index 7d9a5bac..18546f8a 100644",
                "--- a/tests/annotation/vanilla/pom.xml",
                "+++ b/tests/annotation/vanilla/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/pom.xml b/tests/pom.xml",
                "index f7903cb2..a9e8a8ba 100644",
                "--- a/tests/pom.xml",
                "+++ b/tests/pom.xml",
                "@@ -6,3 +6,3 @@",
                "     <artifactId>spring-security-oauth-parent</artifactId>",
                "-    <version>2.2.2.BUILD-SNAPSHOT</version>",
                "+    <version>2.3.0.BUILD-SNAPSHOT</version>",
                "   </parent>",
                "diff --git a/tests/xml/approval/pom.xml b/tests/xml/approval/pom.xml",
                "index 8e53cb44..d3e2f065 100644",
                "--- a/tests/xml/approval/pom.xml",
                "+++ b/tests/xml/approval/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-xml-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/xml/client/pom.xml b/tests/xml/client/pom.xml",
                "index 64df452e..df6350bc 100644",
                "--- a/tests/xml/client/pom.xml",
                "+++ b/tests/xml/client/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-xml-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/xml/common/pom.xml b/tests/xml/common/pom.xml",
                "index 2d96a730..7391078b 100644",
                "--- a/tests/xml/common/pom.xml",
                "+++ b/tests/xml/common/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-xml-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/xml/form/pom.xml b/tests/xml/form/pom.xml",
                "index dbf000eb..b1339c5c 100644",
                "--- a/tests/xml/form/pom.xml",
                "+++ b/tests/xml/form/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-xml-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/xml/jdbc/pom.xml b/tests/xml/jdbc/pom.xml",
                "index 12b70266..5c5e2a08 100644",
                "--- a/tests/xml/jdbc/pom.xml",
                "+++ b/tests/xml/jdbc/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-xml-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/xml/jwt/pom.xml b/tests/xml/jwt/pom.xml",
                "index d114439c..8343961f 100644",
                "--- a/tests/xml/jwt/pom.xml",
                "+++ b/tests/xml/jwt/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-xml-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/xml/mappings/pom.xml b/tests/xml/mappings/pom.xml",
                "index bcf69018..40c9b8f5 100644",
                "--- a/tests/xml/mappings/pom.xml",
                "+++ b/tests/xml/mappings/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-xml-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t</parent>",
                "diff --git a/tests/xml/pom.xml b/tests/xml/pom.xml",
                "index fc50dbc3..327c841a 100644",
                "--- a/tests/xml/pom.xml",
                "+++ b/tests/xml/pom.xml",
                "@@ -6,3 +6,3 @@",
                " \t<artifactId>spring-oauth2-tests-xml-parent</artifactId>",
                "-\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                "     <packaging>pom</packaging>",
                "@@ -35,3 +35,3 @@",
                " \t\t\t<artifactId>spring-security-oauth2</artifactId>",
                "-\t\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t\t\t<exclusions>",
                "diff --git a/tests/xml/vanilla/pom.xml b/tests/xml/vanilla/pom.xml",
                "index 2aec4de3..eb648b96 100644",
                "--- a/tests/xml/vanilla/pom.xml",
                "+++ b/tests/xml/vanilla/pom.xml",
                "@@ -12,3 +12,3 @@",
                " \t\t<artifactId>spring-oauth2-tests-xml-parent</artifactId>",
                "-\t\t<version>2.2.2.BUILD-SNAPSHOT</version>",
                "+\t\t<version>2.3.0.BUILD-SNAPSHOT</version>",
                " \t</parent>"
            ],
            "changed_files": [
                "pom.xml",
                "samples/oauth/sparklr/pom.xml",
                "samples/oauth/tonr/pom.xml",
                "samples/oauth2/sparklr/pom.xml",
                "samples/oauth2/tonr/pom.xml",
                "samples/pom.xml",
                "spring-security-oauth/pom.xml",
                "spring-security-oauth2/pom.xml",
                "tests/annotation/approval/pom.xml",
                "tests/annotation/client/pom.xml",
                "tests/annotation/common/pom.xml",
                "tests/annotation/custom-authentication/pom.xml",
                "tests/annotation/custom-grant/pom.xml",
                "tests/annotation/form/pom.xml",
                "tests/annotation/jaxb/pom.xml",
                "tests/annotation/jdbc/pom.xml",
                "tests/annotation/jpa/pom.xml",
                "tests/annotation/jwt/pom.xml",
                "tests/annotation/mappings/pom.xml",
                "tests/annotation/multi/pom.xml",
                "tests/annotation/pom.xml",
                "tests/annotation/resource/pom.xml",
                "tests/annotation/ssl/pom.xml",
                "tests/annotation/vanilla/pom.xml",
                "tests/pom.xml",
                "tests/xml/approval/pom.xml",
                "tests/xml/client/pom.xml",
                "tests/xml/common/pom.xml",
                "tests/xml/form/pom.xml",
                "tests/xml/jdbc/pom.xml",
                "tests/xml/jwt/pom.xml",
                "tests/xml/mappings/pom.xml",
                "tests/xml/pom.xml",
                "tests/xml/vanilla/pom.xml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "1.0.10.RELEASE",
                "2.3.0.RC1",
                "2.3.0.RELEASE",
                "2.3.1.RELEASE",
                "2.3.2.RELEASE",
                "2.3.3.RELEASE",
                "2.3.4.RELEASE",
                "2.3.5.RELEASE",
                "2.3.6.RELEASE",
                "2.3.7.RELEASE",
                "2.3.8.RELEASE",
                "2.4.0.RELEASE",
                "2.4.1.RELEASE",
                "2.4.2.RELEASE",
                "2.5.0.M1",
                "2.5.0.RC1",
                "2.5.0.RELEASE",
                "2.5.1.RELEASE",
                "2.5.2.RELEASE",
                "jwt1.0.11.RELEASE",
                "jwt1.1.0.RELEASE",
                "jwt1.1.1.RELEASE"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: resource, approval",
                    "relevance": 4
                }
            ]
        },
        {
            "commit_id": "bbbdaa5a8e5da52d7a6949c4b1da19c4c37dfe2c",
            "repository": "https://github.com/spring-projects/spring-security-oauth",
            "timestamp": 1511160324,
            "hunks": 5,
            "message": "Ignore unsupported JWK types when parsing JWK set At present, `JwkSetConverter` throws a `JwkException` when it attempts to parse a JWK with unsupported key type. This causes problems with providers that support multiple JWS algorithms, and therefore publish JWK set with keys of different types. This commit updates the behavior of `JwkSetConverter` to ignore JWKs with unsupported key type. Closes gh-1213",
            "diff": [
                "diff --git a/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkSetConverter.java b/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkSetConverter.java",
                "index b92f39b8..fdfbb929 100644",
                "--- a/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkSetConverter.java",
                "+++ b/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkSetConverter.java",
                "@@ -47,2 +47,3 @@ import static org.springframework.security.oauth2.provider.token.store.jwk.JwkAt",
                "  * @author Joe Grandja",
                "+ * @author Vedran Pavic",
                "  */",
                "@@ -93,6 +94,10 @@ class JwkSetConverter implements Converter<InputStream, Set<JwkDefinition>> {",
                " \t\t\t\t}",
                "-\t\t\t\tJwkDefinition jwkDefinition = this.createJwkDefinition(attributes);",
                "-\t\t\t\tif (!jwkDefinitions.add(jwkDefinition)) {",
                "-\t\t\t\t\tthrow new JwkException(\"Duplicate JWK found in Set: \" +",
                "-\t\t\t\t\t\t\tjwkDefinition.getKeyId() + \" (\" + KEY_ID + \")\");",
                "+\t\t\t\tJwkDefinition.KeyType keyType =",
                "+\t\t\t\t\t\tJwkDefinition.KeyType.fromValue(attributes.get(KEY_TYPE));",
                "+\t\t\t\tif (JwkDefinition.KeyType.RSA.equals(keyType)) {",
                "+\t\t\t\t\tJwkDefinition jwkDefinition = createRsaJwkDefinition(attributes);",
                "+\t\t\t\t\tif (!jwkDefinitions.add(jwkDefinition)) {",
                "+\t\t\t\t\t\tthrow new JwkException(\"Duplicate JWK found in Set: \" +",
                "+\t\t\t\t\t\t\t\tjwkDefinition.getKeyId() + \" (\" + KEY_ID + \")\");",
                "+\t\t\t\t\t}",
                " \t\t\t\t}",
                "@@ -112,22 +117,2 @@ class JwkSetConverter implements Converter<InputStream, Set<JwkDefinition>> {",
                "-\t/**",
                "-\t * Creates a {@link JwkDefinition} based on the supplied attributes.",
                "-\t *",
                "-\t * @param attributes the attributes used to create the {@link JwkDefinition}",
                "-\t * @return a {@link JwkDefinition}",
                "-\t * @throws JwkException if the Key Type (&quot;kty&quot;) attribute value is not {@link JwkDefinition.KeyType#RSA}",
                "-\t */",
                "-\tprivate JwkDefinition createJwkDefinition(Map<String, String> attributes) {",
                "-\t\tJwkDefinition.KeyType keyType =",
                "-\t\t\t\tJwkDefinition.KeyType.fromValue(attributes.get(KEY_TYPE));",
                "-",
                "-\t\tif (!JwkDefinition.KeyType.RSA.equals(keyType)) {",
                "-\t\t\tthrow new JwkException((keyType != null ? keyType.value() : \"unknown\") +",
                "-\t\t\t\t\t\" (\" + KEY_TYPE + \") is currently not supported.\" +",
                "-\t\t\t\t\t\" Valid values for '\" + KEY_TYPE + \"' are: \" + JwkDefinition.KeyType.RSA.value());",
                "-\t\t}",
                "-",
                "-\t\treturn this.createRsaJwkDefinition(attributes);",
                "-\t}",
                "-",
                " \t/**",
                "@@ -181,2 +166,2 @@ class JwkSetConverter implements Converter<InputStream, Set<JwkDefinition>> {",
                " \t}",
                "-}",
                "\\ No newline at end of file",
                "+}"
            ],
            "changed_files": [
                "spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkSetConverter.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "1213": "Ignore unsupported JWK types when parsing JWK set #1223 JWK Set parsing fails if provider's set contains non-RSA keys #1225 JWK Set parsing fails if provider's set contains non-RSA keys #1226"
            },
            "cve_refs": [],
            "twins": [
                [
                    "no-tag",
                    "e2e2e4422ad4c5f46ee67e324046731994c6d293"
                ],
                [
                    "no-tag",
                    "0c034e4dfac53c6f736a3d7e858bae37328e0fab"
                ]
            ],
            "tags": [
                "2.1.2.RELEASE",
                "2.1.3.RELEASE",
                "2.1.4.RELEASE",
                "2.1.5.RELEASE",
                "2.1.6.RELEASE"
            ],
            "matched_rules": [
                {
                    "id": "COMMIT_HAS_TWINS",
                    "message": "This commit has one or more twins.",
                    "relevance": 2
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 1213",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "1ff2c7ab434f4cace5777442cc3f5fc34feb855d",
            "repository": "https://github.com/spring-projects/spring-security-oauth",
            "timestamp": 1508505027,
            "hunks": 4,
            "message": "Update ssl tests to Boot 1.5",
            "diff": [
                "diff --git a/tests/annotation/pom.xml b/tests/annotation/pom.xml",
                "index 7ebb50e1..07cb2991 100644",
                "--- a/tests/annotation/pom.xml",
                "+++ b/tests/annotation/pom.xml",
                "@@ -85,2 +85,18 @@",
                "       </pluginManagement>",
                "+      <plugins>",
                "+\t\t  <plugin>",
                "+\t\t\t  <groupId>org.apache.maven.plugins</groupId>",
                "+\t\t\t  <artifactId>maven-source-plugin</artifactId>",
                "+\t\t\t  <version>2.1.2</version>",
                "+\t\t\t  <executions>",
                "+\t\t\t\t  <execution>",
                "+\t\t\t\t\t  <id>attach-sources</id>",
                "+\t\t\t\t\t  <phase>package</phase>",
                "+\t\t\t\t\t  <goals>",
                "+\t\t\t\t\t\t  <goal>jar</goal>",
                "+\t\t\t\t\t  </goals>",
                "+\t\t\t\t  </execution>",
                "+\t\t\t  </executions>",
                "+\t\t  </plugin>",
                "+\t  </plugins>",
                "     </build>",
                "diff --git a/tests/annotation/ssl/src/main/resources/application.yml b/tests/annotation/ssl/src/main/resources/application.yml",
                "index d1b2e81e..db552c19 100644",
                "--- a/tests/annotation/ssl/src/main/resources/application.yml",
                "+++ b/tests/annotation/ssl/src/main/resources/application.yml",
                "@@ -8,5 +8,8 @@ security:",
                "     password: password",
                "+  oauth2:",
                "+    resource:",
                "+      filter-order: 3",
                " logging:",
                "   level:",
                "-    # org.springframework.security: DEBUG",
                "+    org.springframework.security: DEBUG",
                " server:",
                "diff --git a/tests/annotation/ssl/src/main/resources/sample.jks b/tests/annotation/ssl/src/main/resources/sample.jks",
                "index 6aa9a280..91cd44dd 100644",
                "Binary files a/tests/annotation/ssl/src/main/resources/sample.jks and b/tests/annotation/ssl/src/main/resources/sample.jks differ",
                "diff --git a/tests/pom.xml b/tests/pom.xml",
                "index e34a2d60..c1c3a653 100644",
                "--- a/tests/pom.xml",
                "+++ b/tests/pom.xml",
                "@@ -31,2 +31,16 @@",
                " \t  </plugin>",
                "+      <plugin>",
                "+        <groupId>org.apache.maven.plugins</groupId>",
                "+        <artifactId>maven-source-plugin</artifactId>",
                "+        <version>2.1.2</version>",
                "+        <executions>",
                "+          <execution>",
                "+            <id>attach-sources</id>",
                "+            <phase>package</phase>",
                "+            <goals>",
                "+              <goal>jar</goal>",
                "+            </goals>",
                "+          </execution>",
                "+        </executions>",
                "+      </plugin>",
                " \t</plugins>"
            ],
            "changed_files": [
                "tests/annotation/pom.xml",
                "tests/annotation/ssl/src/main/resources/application.yml",
                "tests/annotation/ssl/src/main/resources/sample.jks",
                "tests/pom.xml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "2.0.15.RELEASE",
                "2.0.16.RELEASE",
                "2.0.17.RELEASE",
                "2.0.18.RELEASE",
                "2.0.19.RELEASE"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: resource",
                    "relevance": 4
                }
            ]
        },
        {
            "commit_id": "cc4c0a52086309a6eed3fd8a2304b31055e7c9d7",
            "repository": "https://github.com/spring-projects/spring-security-oauth",
            "timestamp": 1513790167,
            "hunks": 20,
            "message": "Polish #1162 Add support for Elliptic Curve JWK signatures",
            "diff": [
                "diff --git a/spring-security-oauth2/pom.xml b/spring-security-oauth2/pom.xml",
                "index b6fc2504..a8140407 100644",
                "--- a/spring-security-oauth2/pom.xml",
                "+++ b/spring-security-oauth2/pom.xml",
                "@@ -18,3 +18,3 @@",
                " \t\t<servlet-api.version>3.0.1</servlet-api.version>",
                "-\t\t<spring.security.jwt.version>1.0.9.BUILD-SNAPSHOT</spring.security.jwt.version>",
                "+\t\t<spring.security.jwt.version>1.0.9.RELEASE</spring.security.jwt.version>",
                " \t\t<junit.version>4.11</junit.version>",
                "diff --git a/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/EllipticCurveJwkDefinition.java b/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/EllipticCurveJwkDefinition.java",
                "index dc5191b2..241d0526 100644",
                "--- a/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/EllipticCurveJwkDefinition.java",
                "+++ b/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/EllipticCurveJwkDefinition.java",
                "@@ -1 +1,16 @@",
                "+/*",
                "+ * Copyright 2012-2017 the original author or authors.",
                "+ *",
                "+ * Licensed under the Apache License, Version 2.0 (the \"License\");",
                "+ * you may not use this file except in compliance with the License.",
                "+ * You may obtain a copy of the License at",
                "+ *",
                "+ *      http://www.apache.org/licenses/LICENSE-2.0",
                "+ *",
                "+ * Unless required by applicable law or agreed to in writing, software",
                "+ * distributed under the License is distributed on an \"AS IS\" BASIS,",
                "+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
                "+ * See the License for the specific language governing permissions and",
                "+ * limitations under the License.",
                "+ */",
                " package org.springframework.security.oauth2.provider.token.store.jwk;",
                "@@ -5,48 +20,75 @@ package org.springframework.security.oauth2.provider.token.store.jwk;",
                "  *",
                "+ * @author Michael Duergner <michael@sprucehill.io>",
                "+ * @since 2.3",
                "  * @see <a target=\"_blank\" href=\"https://tools.ietf.org/html/rfc7517\">JSON Web Key (JWK)</a>",
                "  * @see <a target=\"_blank\" href=\"https://tools.ietf.org/html/rfc7518#page-28\">JSON Web Algorithms (JWA)</a>",
                "- *",
                "- * @author Michael Duergner <michael@sprucehill.io>",
                "  */",
                " final class EllipticCurveJwkDefinition extends JwkDefinition {",
                "+\tprivate final String x;",
                "+\tprivate final String y;",
                "+\tprivate final String curve;",
                "+",
                "+\t/**",
                "+\t * Creates an instance of an Elliptic Curve JSON Web Key (JWK).",
                "+\t *",
                "+\t * @param keyId        the Key ID",
                "+\t * @param publicKeyUse the intended use of the Public Key",
                "+\t * @param algorithm    the algorithm intended to be used",
                "+\t * @param x            the x value to be used",
                "+\t * @param y            the y value to be used",
                "+\t * @param curve        the curve to be used",
                "+\t */",
                "+\tEllipticCurveJwkDefinition(String keyId,",
                "+\t\t\t\t\t\t\t   PublicKeyUse publicKeyUse,",
                "+\t\t\t\t\t\t\t   CryptoAlgorithm algorithm,",
                "+\t\t\t\t\t\t\t   String x,",
                "+\t\t\t\t\t\t\t   String y,",
                "+\t\t\t\t\t\t\t   String curve) {",
                "+\t\tsuper(keyId, KeyType.EC, publicKeyUse, algorithm);",
                "+\t\tthis.x = x;",
                "+\t\tthis.y = y;",
                "+\t\tthis.curve = curve;",
                "+\t}",
                "+",
                "+\tString getX() {",
                "+\t\treturn this.x;",
                "+\t}",
                "+",
                "+\tString getY() {",
                "+\t\treturn this.y;",
                "+\t}",
                "+",
                "+\tString getCurve() {",
                "+\t\treturn this.curve;",
                "+\t}",
                "+",
                "+\t/**",
                "+\t * The supported Named Curves.",
                "+\t */",
                "+\tenum NamedCurve {",
                "+\t\tP256(\"P-256\"),",
                "+\t\tP384(\"P-384\"),",
                "+\t\tP521(\"P-521\");",
                "+",
                "+\t\tprivate final String value;",
                "+",
                "+\t\tNamedCurve(String value) {",
                "+\t\t\tthis.value = value;",
                "+\t\t}",
                "+",
                "+\t\tString value() {",
                "+\t\t\treturn this.value;",
                "+\t\t}",
                "-    private final String x;",
                "-",
                "-    private final String y;",
                "-",
                "-    private final String curve;",
                "-",
                "-    /**",
                "-     * Creates an instance of an Elliptic Curve JSON Web Key (JWK).",
                "-     *",
                "-     * @param keyId        the Key ID",
                "-     * @param publicKeyUse the intended use of the Public Key",
                "-     * @param algorithm    the algorithm intended to be used",
                "-     * @param x            the x value to be used",
                "-     * @param y            the y value to be used",
                "-     * @param curve        the curve to be used",
                "-     */",
                "-    EllipticCurveJwkDefinition(String keyId,",
                "-                                         PublicKeyUse publicKeyUse,",
                "-                                         CryptoAlgorithm algorithm,",
                "-                                         String x,",
                "-                                         String y,",
                "-                                         String curve) {",
                "-        super(keyId, KeyType.EC, publicKeyUse, algorithm);",
                "-        this.x = x;",
                "-        this.y = y;",
                "-        this.curve = curve;",
                "-    }",
                "-",
                "-    String getX() {",
                "-        return x;",
                "-    }",
                "-",
                "-    String getY() {",
                "-        return y;",
                "-    }",
                "-",
                "-    String getCurve() {",
                "-        return curve;",
                "-    }",
                "+\t\tstatic EllipticCurveJwkDefinition.NamedCurve fromValue(String curveName) {",
                "+\t\t\tEllipticCurveJwkDefinition.NamedCurve result = null;",
                "+\t\t\tfor (EllipticCurveJwkDefinition.NamedCurve namedCurve : values()) {",
                "+\t\t\t\tif (namedCurve.value().equals(curveName)) {",
                "+\t\t\t\t\tresult = namedCurve;",
                "+\t\t\t\t\tbreak;",
                "+\t\t\t\t}",
                "+\t\t\t}",
                "+\t\t\treturn result;",
                "+\t\t}",
                "+\t}",
                " }",
                "diff --git a/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkDefinitionSource.java b/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkDefinitionSource.java",
                "index 079de4de..8cea751e 100644",
                "--- a/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkDefinitionSource.java",
                "+++ b/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkDefinitionSource.java",
                "@@ -18,3 +18,2 @@ package org.springframework.security.oauth2.provider.token.store.jwk;",
                " import org.springframework.security.jwt.codec.Codecs;",
                "-import org.springframework.security.jwt.crypto.sign.EllipticCurveKeyHelper;",
                " import org.springframework.security.jwt.crypto.sign.EllipticCurveVerifier;",
                "@@ -29,6 +28,10 @@ import java.net.URL;",
                " import java.security.KeyFactory;",
                "-import java.security.interfaces.ECPublicKey;",
                " import java.security.interfaces.RSAPublicKey;",
                " import java.security.spec.RSAPublicKeySpec;",
                "-import java.util.*;",
                "+import java.util.ArrayList;",
                "+import java.util.Arrays;",
                "+import java.util.LinkedHashMap;",
                "+import java.util.List;",
                "+import java.util.Map;",
                "+import java.util.Set;",
                " import java.util.concurrent.ConcurrentHashMap;",
                "@@ -136,4 +139,3 @@ class JwkDefinitionSource {",
                " \t\t\t\t\t\tnew JwkDefinitionHolder(jwkDefinition, createRsaVerifier((RsaJwkDefinition) jwkDefinition)));",
                "-\t\t\t}",
                "-\t\t\telse if (JwkDefinition.KeyType.EC.equals(jwkDefinition.getKeyType())) {",
                "+\t\t\t} else if (JwkDefinition.KeyType.EC.equals(jwkDefinition.getKeyType())) {",
                " \t\t\t\tjwkDefinitions.put(jwkDefinition.getKeyId(),",
                "@@ -174,8 +176,15 @@ class JwkDefinitionSource {",
                "-\t\t\tECPublicKey ecPublicKey = EllipticCurveKeyHelper.createPublicKey(x, y, ecDefinition.getCurve());",
                "+\t\t\tString algorithm = null;",
                "+\t\t\tif (EllipticCurveJwkDefinition.NamedCurve.P256.value().equals(ecDefinition.getCurve())) {",
                "+\t\t\t\talgorithm = JwkDefinition.CryptoAlgorithm.ES256.standardName();",
                "+\t\t\t} else if (EllipticCurveJwkDefinition.NamedCurve.P384.value().equals(ecDefinition.getCurve())) {",
                "+\t\t\t\talgorithm = JwkDefinition.CryptoAlgorithm.ES384.standardName();",
                "+\t\t\t} else if (EllipticCurveJwkDefinition.NamedCurve.P521.value().equals(ecDefinition.getCurve())) {",
                "+\t\t\t\talgorithm = JwkDefinition.CryptoAlgorithm.ES512.standardName();",
                "+\t\t\t}",
                "-\t\t\tresult = new EllipticCurveVerifier(ecPublicKey, ecDefinition.getAlgorithm().standardName());",
                "+\t\t\tresult = new EllipticCurveVerifier(x, y, ecDefinition.getCurve(), algorithm);",
                " \t\t} catch (Exception ex) {",
                "-\t\t\tthrow new JwkException(\"An error occurred while creating a EC Public Key Verifier for \" +",
                "+\t\t\tthrow new JwkException(\"An error occurred while creating an EC Public Key Verifier for \" +",
                " \t\t\t\t\tecDefinition.getKeyId() + \" : \" + ex.getMessage(), ex);",
                "diff --git a/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkSetConverter.java b/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkSetConverter.java",
                "index 7775d749..0054de7c 100644",
                "--- a/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkSetConverter.java",
                "+++ b/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkSetConverter.java",
                "@@ -95,2 +95,4 @@ class JwkSetConverter implements Converter<InputStream, Set<JwkDefinition>> {",
                " \t\t\t\t}",
                "+",
                "+\t\t\t\tJwkDefinition jwkDefinition = null;",
                " \t\t\t\tJwkDefinition.KeyType keyType =",
                "@@ -98,3 +100,7 @@ class JwkSetConverter implements Converter<InputStream, Set<JwkDefinition>> {",
                " \t\t\t\tif (JwkDefinition.KeyType.RSA.equals(keyType)) {",
                "-\t\t\t\t\tJwkDefinition jwkDefinition = createRsaJwkDefinition(attributes);",
                "+\t\t\t\t\tjwkDefinition = this.createRsaJwkDefinition(attributes);",
                "+\t\t\t\t} else if (JwkDefinition.KeyType.EC.equals(keyType)) {",
                "+\t\t\t\t\tjwkDefinition = this.createEllipticCurveJwkDefinition(attributes);",
                "+\t\t\t\t}",
                "+\t\t\t\tif (jwkDefinition != null) {",
                " \t\t\t\t\tif (!jwkDefinitions.add(jwkDefinition)) {",
                "@@ -118,27 +124,2 @@ class JwkSetConverter implements Converter<InputStream, Set<JwkDefinition>> {",
                "-\t/**",
                "-\t * Creates a {@link JwkDefinition} based on the supplied attributes.",
                "-\t *",
                "-\t * @param attributes the attributes used to create the {@link JwkDefinition}",
                "-\t * @return a {@link JwkDefinition}",
                "-\t * @throws JwkException if the Key Type (&quot;kty&quot;) attribute value is not {@link JwkDefinition.KeyType#RSA}",
                "-\t */",
                "-\tprivate JwkDefinition createJwkDefinition(Map<String, String> attributes) {",
                "-\t\tJwkDefinition.KeyType keyType =",
                "-\t\t\t\tJwkDefinition.KeyType.fromValue(attributes.get(KEY_TYPE));",
                "-",
                "-\t\tif (JwkDefinition.KeyType.RSA.equals(keyType)) {",
                "-\t\t\treturn this.createRsaJwkDefinition(attributes);",
                "-\t\t}",
                "-\t\telse if (JwkDefinition.KeyType.EC.equals(keyType)) {",
                "-\t\t\treturn this.createEllipticCurveJwkDefinition(attributes);",
                "-\t\t}",
                "-\t\telse {",
                "-\t\t\tthrow new JwkException((keyType != null ? keyType.value() : \"unknown\") +",
                "-\t\t\t\t\t\" (\" + KEY_TYPE + \") is currently not supported.\" +",
                "-\t\t\t\t\t\" Valid values for '\" + KEY_TYPE + \"' are: \" + JwkDefinition.KeyType.RSA.value() +",
                "-\t\t\t\t\t\", \" + JwkDefinition.KeyType.EC.value());",
                "-\t\t}",
                "-\t}",
                "-",
                " \t/**",
                "@@ -194,7 +175,7 @@ class JwkSetConverter implements Converter<InputStream, Set<JwkDefinition>> {",
                " \t/**",
                "-\t * Creates a {@link EllipticCurveJwkDefinition} based on the supplied attributes.",
                "+\t * Creates an {@link EllipticCurveJwkDefinition} based on the supplied attributes.",
                " \t *",
                " \t * @param attributes the attributes used to create the {@link EllipticCurveJwkDefinition}",
                "-\t * @return a {@link JwkDefinition} representation of a EC Key",
                "-\t * @throws JwkException if at least one attribute value is missing or invalid for a EC Key",
                "+\t * @return a {@link JwkDefinition} representation of an EC Key",
                "+\t * @throws JwkException if at least one attribute value is missing or invalid for an EC Key",
                " \t */",
                "@@ -204,3 +185,3 @@ class JwkSetConverter implements Converter<InputStream, Set<JwkDefinition>> {",
                " \t\tif (!StringUtils.hasText(keyId)) {",
                "-\t\t\tthrow new JwkException(KEY_ID + \" is a required attribute for a JWK.\");",
                "+\t\t\tthrow new JwkException(KEY_ID + \" is a required attribute for an EC JWK.\");",
                " \t\t}",
                "@@ -228,3 +209,3 @@ class JwkSetConverter implements Converter<InputStream, Set<JwkDefinition>> {",
                " \t\tif (!StringUtils.hasText(x)) {",
                "-\t\t\tthrow new JwkException(EC_PUBLIC_KEY_X + \" is a required attribute for a EC JWK.\");",
                "+\t\t\tthrow new JwkException(EC_PUBLIC_KEY_X + \" is a required attribute for an EC JWK.\");",
                " \t\t}",
                "@@ -234,3 +215,3 @@ class JwkSetConverter implements Converter<InputStream, Set<JwkDefinition>> {",
                " \t\tif (!StringUtils.hasText(y)) {",
                "-\t\t\tthrow new JwkException(EC_PUBLIC_KEY_Y + \" is a required attribute for a EC JWK.\");",
                "+\t\t\tthrow new JwkException(EC_PUBLIC_KEY_Y + \" is a required attribute for an EC JWK.\");",
                " \t\t}",
                "@@ -240,3 +221,3 @@ class JwkSetConverter implements Converter<InputStream, Set<JwkDefinition>> {",
                " \t\tif (!StringUtils.hasText(curve)) {",
                "-\t\t\tthrow new JwkException(EC_PUBLIC_KEY_CURVE + \" is a required attribute for a EC JWK.\");",
                "+\t\t\tthrow new JwkException(EC_PUBLIC_KEY_CURVE + \" is a required attribute for an EC JWK.\");",
                " \t\t}"
            ],
            "changed_files": [
                "spring-security-oauth2/pom.xml",
                "spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/EllipticCurveJwkDefinition.java",
                "spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkDefinitionSource.java",
                "spring-security-oauth2/src/main/java/org/springframework/security/oauth2/provider/token/store/jwk/JwkSetConverter.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "1162": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "1.0.10.RELEASE",
                "2.3.0.RC1",
                "2.3.0.RELEASE",
                "2.3.1.RELEASE",
                "2.3.2.RELEASE",
                "2.3.3.RELEASE",
                "2.3.4.RELEASE",
                "2.3.5.RELEASE",
                "2.3.6.RELEASE",
                "2.3.7.RELEASE",
                "2.3.8.RELEASE",
                "2.4.0.RELEASE",
                "2.4.1.RELEASE",
                "2.4.2.RELEASE",
                "2.5.0.M1",
                "2.5.0.RC1",
                "2.5.0.RELEASE",
                "2.5.1.RELEASE",
                "2.5.2.RELEASE",
                "jwt1.0.11.RELEASE",
                "jwt1.1.0.RELEASE",
                "jwt1.1.1.RELEASE"
            ],
            "matched_rules": [
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 1162",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "8fc19343fdc21671ba036c45627b9b7f51637b4b",
            "repository": "https://github.com/spring-projects/spring-security-oauth",
            "timestamp": 1513739748,
            "hunks": 15,
            "message": "Polish #1161 Add Elliptic Curve verification support for spring-security-jwt",
            "diff": [
                "diff --git a/spring-security-jwt/src/main/java/org/springframework/security/jwt/crypto/sign/EllipticCurveKeyHelper.java b/spring-security-jwt/src/main/java/org/springframework/security/jwt/crypto/sign/EllipticCurveKeyHelper.java",
                "index a9f28307..f9b88f41 100644",
                "--- a/spring-security-jwt/src/main/java/org/springframework/security/jwt/crypto/sign/EllipticCurveKeyHelper.java",
                "+++ b/spring-security-jwt/src/main/java/org/springframework/security/jwt/crypto/sign/EllipticCurveKeyHelper.java",
                "@@ -1,12 +1,15 @@",
                " /*",
                "- * Copyright 2006-2011 the original author or authors.",
                "+ * Copyright 2002-2017 the original author or authors.",
                "  *",
                "- * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with",
                "- * the License. You may obtain a copy of the License at",
                "+ * Licensed under the Apache License, Version 2.0 (the \"License\");",
                "+ * you may not use this file except in compliance with the License.",
                "+ * You may obtain a copy of the License at",
                "  *",
                "- * http://www.apache.org/licenses/LICENSE-2.0",
                "+ *      http://www.apache.org/licenses/LICENSE-2.0",
                "  *",
                "- * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on",
                "- * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the",
                "- * specific language governing permissions and limitations under the License.",
                "+ * Unless required by applicable law or agreed to in writing, software",
                "+ * distributed under the License is distributed on an \"AS IS\" BASIS,",
                "+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
                "+ * See the License for the specific language governing permissions and",
                "+ * limitations under the License.",
                "  */",
                "@@ -26,22 +29,28 @@ import java.security.spec.ECPublicKeySpec;",
                " /**",
                "+ * Utilities for Elliptic Curve keys.",
                "+ *",
                "  * @author Michael Duergner",
                "+ * @since 2.3",
                "  */",
                "-class EllipticCurveKeyHelper {",
                "+final class EllipticCurveKeyHelper {",
                "+",
                "+\tstatic ECPublicKey createPublicKey(final BigInteger x, final BigInteger y, final String curve) {",
                "+\t\tECNamedCurveParameterSpec curveParameterSpec;",
                "+\t\tif ((curveParameterSpec = ECNamedCurveTable.getParameterSpec(curve)) == null) {",
                "+\t\t\tthrow new IllegalArgumentException(\"Unsupported named curve: \" + curve);",
                "+\t\t}",
                "-    static ECPublicKey createPublicKey(final BigInteger x, final BigInteger y, final String curve) {",
                "-        try {",
                "-            ECNamedCurveParameterSpec curveParameterSpec = ECNamedCurveTable.getParameterSpec(curve);",
                "-            ECParameterSpec parameterSpec = new ECNamedCurveSpec(",
                "-                    curveParameterSpec.getName(),",
                "-                    curveParameterSpec.getCurve(),",
                "-                    curveParameterSpec.getG(),",
                "-                    curveParameterSpec.getN());",
                "-            ECPublicKeySpec publicKeySpec = new ECPublicKeySpec(new ECPoint(x, y), parameterSpec);",
                "+\t\tECParameterSpec parameterSpec = new ECNamedCurveSpec(",
                "+\t\t\t\tcurveParameterSpec.getName(),",
                "+\t\t\t\tcurveParameterSpec.getCurve(),",
                "+\t\t\t\tcurveParameterSpec.getG(),",
                "+\t\t\t\tcurveParameterSpec.getN());",
                "+\t\tECPublicKeySpec publicKeySpec = new ECPublicKeySpec(new ECPoint(x, y), parameterSpec);",
                "-            return (ECPublicKey) KeyFactory.getInstance(\"EC\").generatePublic(publicKeySpec);",
                "-        }",
                "-        catch (Exception ex) {",
                "-            throw new RuntimeException(ex);",
                "-        }",
                "-    }",
                "+\t\ttry {",
                "+\t\t\treturn (ECPublicKey) KeyFactory.getInstance(\"EC\").generatePublic(publicKeySpec);",
                "+\t\t} catch (Exception ex) {",
                "+\t\t\tthrow new RuntimeException(ex);",
                "+\t\t}",
                "+\t}",
                " }",
                "diff --git a/spring-security-jwt/src/main/java/org/springframework/security/jwt/crypto/sign/EllipticCurveSignatureHelper.java b/spring-security-jwt/src/main/java/org/springframework/security/jwt/crypto/sign/EllipticCurveSignatureHelper.java",
                "new file mode 100644",
                "index 00000000..d1ee99dd",
                "--- /dev/null",
                "+++ b/spring-security-jwt/src/main/java/org/springframework/security/jwt/crypto/sign/EllipticCurveSignatureHelper.java",
                "@@ -0,0 +1,163 @@",
                "+/*",
                "+ * Copyright 2002-2017 the original author or authors.",
                "+ *",
                "+ * Licensed under the Apache License, Version 2.0 (the \"License\");",
                "+ * you may not use this file except in compliance with the License.",
                "+ * You may obtain a copy of the License at",
                "+ *",
                "+ *      http://www.apache.org/licenses/LICENSE-2.0",
                "+ *",
                "+ * Unless required by applicable law or agreed to in writing, software",
                "+ * distributed under the License is distributed on an \"AS IS\" BASIS,",
                "+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
                "+ * See the License for the specific language governing permissions and",
                "+ * limitations under the License.",
                "+ */",
                "+package org.springframework.security.jwt.crypto.sign;",
                "+",
                "+import java.security.GeneralSecurityException;",
                "+",
                "+/**",
                "+ * Elliptic Curve Digital Signature Algorithm (ECDSA) utilities.",
                "+ *",
                "+ * <p>",
                "+ * Borrowed from <code>com.nimbusds.jose.crypto.ECDSA</code>.",
                "+ */",
                "+final class EllipticCurveSignatureHelper {",
                "+",
                "+\t/**",
                "+\t * Transcodes the JCA ASN.1/DER-encoded signature into the concatenated",
                "+\t * R + S format expected by ECDSA JWS.",
                "+\t *",
                "+\t * @param derSignature The ASN.1/DER-encoded. Must not be {@code null}.",
                "+\t * @param outputLength The expected length of the ECDSA JWS signature.",
                "+\t *",
                "+\t * @return The ECDSA JWS encoded signature.",
                "+\t *",
                "+\t * @throws GeneralSecurityException If the ASN.1/DER signature format is invalid.",
                "+\t */",
                "+\tstatic byte[] transcodeSignatureToJWS(final byte[] derSignature, int outputLength) throws GeneralSecurityException {",
                "+",
                "+\t\tif (derSignature.length < 8 || derSignature[0] != 48) {",
                "+\t\t\tthrow new GeneralSecurityException(\"Invalid ECDSA signature format\");",
                "+\t\t}",
                "+",
                "+\t\tint offset;",
                "+\t\tif (derSignature[1] > 0) {",
                "+\t\t\toffset = 2;",
                "+\t\t} else if (derSignature[1] == (byte) 0x81) {",
                "+\t\t\toffset = 3;",
                "+\t\t} else {",
                "+\t\t\tthrow new GeneralSecurityException(\"Invalid ECDSA signature format\");",
                "+\t\t}",
                "+",
                "+\t\tbyte rLength = derSignature[offset + 1];",
                "+",
                "+\t\tint i;",
                "+\t\tfor (i = rLength; (i > 0) && (derSignature[(offset + 2 + rLength) - i] == 0); i--) {",
                "+\t\t\t// do nothing",
                "+\t\t}",
                "+",
                "+\t\tbyte sLength = derSignature[offset + 2 + rLength + 1];",
                "+",
                "+\t\tint j;",
                "+\t\tfor (j = sLength; (j > 0) && (derSignature[(offset + 2 + rLength + 2 + sLength) - j] == 0); j--) {",
                "+\t\t\t// do nothing",
                "+\t\t}",
                "+",
                "+\t\tint rawLen = Math.max(i, j);",
                "+\t\trawLen = Math.max(rawLen, outputLength / 2);",
                "+",
                "+\t\tif ((derSignature[offset - 1] & 0xff) != derSignature.length - offset",
                "+\t\t\t\t|| (derSignature[offset - 1] & 0xff) != 2 + rLength + 2 + sLength",
                "+\t\t\t\t|| derSignature[offset] != 2",
                "+\t\t\t\t|| derSignature[offset + 2 + rLength] != 2) {",
                "+\t\t\tthrow new GeneralSecurityException(\"Invalid ECDSA signature format\");",
                "+\t\t}",
                "+",
                "+\t\tfinal byte[] concatSignature = new byte[2 * rawLen];",
                "+",
                "+\t\tSystem.arraycopy(derSignature, (offset + 2 + rLength) - i, concatSignature, rawLen - i, i);",
                "+\t\tSystem.arraycopy(derSignature, (offset + 2 + rLength + 2 + sLength) - j, concatSignature, 2 * rawLen - j, j);",
                "+",
                "+\t\treturn concatSignature;",
                "+\t}",
                "+",
                "+\t/**",
                "+\t * Transcodes the ECDSA JWS signature into ASN.1/DER format for use by",
                "+\t * the JCA verifier.",
                "+\t *",
                "+\t * @param jwsSignature The JWS signature, consisting of the",
                "+\t *                     concatenated R and S values. Must not be",
                "+\t *                     {@code null}.",
                "+\t *",
                "+\t * @return The ASN.1/DER encoded signature.",
                "+\t *",
                "+\t * @throws GeneralSecurityException If the ECDSA JWS signature format is invalid.",
                "+\t */",
                "+\tstatic byte[] transcodeSignatureToDER(byte[] jwsSignature) throws GeneralSecurityException {",
                "+",
                "+\t\t// Adapted from org.apache.xml.security.algorithms.implementations.SignatureECDSA",
                "+",
                "+\t\tint rawLen = jwsSignature.length / 2;",
                "+",
                "+\t\tint i;",
                "+",
                "+\t\tfor (i = rawLen; (i > 0) && (jwsSignature[rawLen - i] == 0); i--) {",
                "+\t\t\t// do nothing",
                "+\t\t}",
                "+",
                "+\t\tint j = i;",
                "+",
                "+\t\tif (jwsSignature[rawLen - i] < 0) {",
                "+\t\t\tj += 1;",
                "+\t\t}",
                "+",
                "+\t\tint k;",
                "+",
                "+\t\tfor (k = rawLen; (k > 0) && (jwsSignature[2 * rawLen - k] == 0); k--) {",
                "+\t\t\t// do nothing",
                "+\t\t}",
                "+",
                "+\t\tint l = k;",
                "+",
                "+\t\tif (jwsSignature[2 * rawLen - k] < 0) {",
                "+\t\t\tl += 1;",
                "+\t\t}",
                "+",
                "+\t\tint len = 2 + j + 2 + l;",
                "+",
                "+\t\tif (len > 255) {",
                "+\t\t\tthrow new GeneralSecurityException(\"Invalid ECDSA signature format\");",
                "+\t\t}",
                "+",
                "+\t\tint offset;",
                "+",
                "+\t\tfinal byte derSignature[];",
                "+",
                "+\t\tif (len < 128) {",
                "+\t\t\tderSignature = new byte[2 + 2 + j + 2 + l];",
                "+\t\t\toffset = 1;",
                "+\t\t} else {",
                "+\t\t\tderSignature = new byte[3 + 2 + j + 2 + l];",
                "+\t\t\tderSignature[1] = (byte) 0x81;",
                "+\t\t\toffset = 2;",
                "+\t\t}",
                "+",
                "+\t\tderSignature[0] = 48;",
                "+\t\tderSignature[offset++] = (byte) len;",
                "+\t\tderSignature[offset++] = 2;",
                "+\t\tderSignature[offset++] = (byte) j;",
                "+",
                "+\t\tSystem.arraycopy(jwsSignature, rawLen - i, derSignature, (offset + j) - i, i);",
                "+",
                "+\t\toffset += j;",
                "+",
                "+\t\tderSignature[offset++] = 2;",
                "+\t\tderSignature[offset++] = (byte) l;",
                "+",
                "+\t\tSystem.arraycopy(jwsSignature, 2 * rawLen - k, derSignature, (offset + l) - k, k);",
                "+",
                "+\t\treturn derSignature;",
                "+\t}",
                "+}",
                "\\ No newline at end of file",
                "diff --git a/spring-security-jwt/src/main/java/org/springframework/security/jwt/crypto/sign/EllipticCurveVerifier.java b/spring-security-jwt/src/main/java/org/springframework/security/jwt/crypto/sign/EllipticCurveVerifier.java",
                "index 10e4e59d..00e52582 100644",
                "--- a/spring-security-jwt/src/main/java/org/springframework/security/jwt/crypto/sign/EllipticCurveVerifier.java",
                "+++ b/spring-security-jwt/src/main/java/org/springframework/security/jwt/crypto/sign/EllipticCurveVerifier.java",
                "@@ -1,12 +1,15 @@",
                " /*",
                "- * Copyright 2006-2011 the original author or authors.",
                "+ * Copyright 2002-2017 the original author or authors.",
                "  *",
                "- * Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with",
                "- * the License. You may obtain a copy of the License at",
                "+ * Licensed under the Apache License, Version 2.0 (the \"License\");",
                "+ * you may not use this file except in compliance with the License.",
                "+ * You may obtain a copy of the License at",
                "  *",
                "- * http://www.apache.org/licenses/LICENSE-2.0",
                "+ *      http://www.apache.org/licenses/LICENSE-2.0",
                "  *",
                "- * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on",
                "- * an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the",
                "- * specific language governing permissions and limitations under the License.",
                "+ * Unless required by applicable law or agreed to in writing, software",
                "+ * distributed under the License is distributed on an \"AS IS\" BASIS,",
                "+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.",
                "+ * See the License for the specific language governing permissions and",
                "+ * limitations under the License.",
                "  */",
                "@@ -20,105 +23,40 @@ import java.security.interfaces.ECPublicKey;",
                " /**",
                "+ * Verifies signatures using an Elliptic Curve public key.",
                "+ *",
                "  * @author Michael Duergner",
                "+ * @since 2.3",
                "  */",
                " public class EllipticCurveVerifier implements SignatureVerifier {",
                "-",
                "-    private final ECPublicKey key;",
                "-",
                "-    private final String algorithm;",
                "-",
                "-    public EllipticCurveVerifier(final BigInteger x, final BigInteger y, final String curve, final String algorithm) {",
                "-        this(EllipticCurveKeyHelper.createPublicKey(x, y, curve), algorithm);",
                "-    }",
                "-",
                "-    public EllipticCurveVerifier(final ECPublicKey key, final String algorithm) {",
                "-        this.key = key;",
                "-        this.algorithm = algorithm;",
                "-    }",
                "-",
                "-    @Override",
                "-    public String algorithm() {",
                "-        return algorithm;",
                "-    }",
                "-",
                "-    @Override",
                "-    public void verify(byte[] content, byte[] sig) {",
                "-        try {",
                "-            Signature signature = Signature.getInstance(algorithm);",
                "-            signature.initVerify(key);",
                "-            signature.update(content);",
                "-",
                "-            if (!signature.verify(transcodeSignatureToDER(sig))) {",
                "-                throw new InvalidSignatureException(\"EC Signature did not match content\");",
                "-            }",
                "-        }",
                "-        catch (GeneralSecurityException e) {",
                "-            throw new RuntimeException(e);",
                "-        }",
                "-    }",
                "-",
                "-    private byte[] transcodeSignatureToDER(byte[] jwsSignature) throws GeneralSecurityException {",
                "-",
                "-        // Adapted from org.apache.xml.security.algorithms.implementations.SignatureECDSA",
                "-",
                "-        int rawLen = jwsSignature.length / 2;",
                "-",
                "-        int i;",
                "-",
                "-        for (i = rawLen; (i > 0) && (jwsSignature[rawLen - i] == 0); i--) {",
                "-            // do nothing",
                "-        }",
                "-",
                "-        int j = i;",
                "-",
                "-        if (jwsSignature[rawLen - i] < 0) {",
                "-            j += 1;",
                "-        }",
                "-",
                "-        int k;",
                "-",
                "-        for (k = rawLen; (k > 0) && (jwsSignature[2 * rawLen - k] == 0); k--) {",
                "-            // do nothing",
                "-        }",
                "-",
                "-        int l = k;",
                "-",
                "-        if (jwsSignature[2 * rawLen - k] < 0) {",
                "-            l += 1;",
                "-        }",
                "-",
                "-        int len = 2 + j + 2 + l;",
                "-",
                "-        if (len > 255) {",
                "-            throw new GeneralSecurityException(\"Invalid ECDSA signature format\");",
                "-        }",
                "-",
                "-        int offset;",
                "-",
                "-        final byte derSignature[];",
                "-",
                "-        if (len < 128) {",
                "-            derSignature = new byte[2 + 2 + j + 2 + l];",
                "-            offset = 1;",
                "-        } else {",
                "-            derSignature = new byte[3 + 2 + j + 2 + l];",
                "-            derSignature[1] = (byte) 0x81;",
                "-            offset = 2;",
                "-        }",
                "-",
                "-        derSignature[0] = 48;",
                "-        derSignature[offset++] = (byte) len;",
                "-        derSignature[offset++] = 2;",
                "-        derSignature[offset++] = (byte) j;",
                "-",
                "-        System.arraycopy(jwsSignature, rawLen - i, derSignature, (offset + j) - i, i);",
                "-",
                "-        offset += j;",
                "-",
                "-        derSignature[offset++] = 2;",
                "-        derSignature[offset++] = (byte) l;",
                "-",
                "-        System.arraycopy(jwsSignature, 2 * rawLen - k, derSignature, (offset + l) - k, k);",
                "-",
                "-        return derSignature;",
                "-    }",
                "+\tprivate final ECPublicKey key;",
                "+\tprivate final String algorithm;",
                "+",
                "+\tpublic EllipticCurveVerifier(final BigInteger x, final BigInteger y,",
                "+\t\t\t\t\t\t\t\t final String curve, final String algorithm) {",
                "+\t\tthis(EllipticCurveKeyHelper.createPublicKey(x, y, curve), algorithm);",
                "+\t}",
                "+",
                "+\tpublic EllipticCurveVerifier(final ECPublicKey key, final String algorithm) {",
                "+\t\tthis.key = key;",
                "+\t\tthis.algorithm = algorithm;",
                "+\t}",
                "+",
                "+\t@Override",
                "+\tpublic String algorithm() {",
                "+\t\treturn this.algorithm;",
                "+\t}",
                "+",
                "+\t@Override",
                "+\tpublic void verify(byte[] content, byte[] sig) {",
                "+\t\ttry {",
                "+\t\t\tSignature signature = Signature.getInstance(this.algorithm);",
                "+\t\t\tsignature.initVerify(this.key);",
                "+\t\t\tsignature.update(content);",
                "+",
                "+\t\t\tif (!signature.verify(EllipticCurveSignatureHelper.transcodeSignatureToDER(sig))) {",
                "+\t\t\t\tthrow new InvalidSignatureException(\"EC Signature did not match content\");",
                "+\t\t\t}",
                "+\t\t} catch (GeneralSecurityException ex) {",
                "+\t\t\tthrow new RuntimeException(ex);",
                "+\t\t}",
                "+\t}",
                " }"
            ],
            "changed_files": [
                "spring-security-jwt/src/main/java/org/springframework/security/jwt/crypto/sign/EllipticCurveKeyHelper.java",
                "spring-security-jwt/src/main/java/org/springframework/security/jwt/crypto/sign/EllipticCurveSignatureHelper.java",
                "spring-security-jwt/src/main/java/org/springframework/security/jwt/crypto/sign/EllipticCurveVerifier.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "1161": "Add support for Elliptic Curve JWK signatures #1162"
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "1.0.10.RELEASE",
                "2.3.0.RC1",
                "2.3.0.RELEASE",
                "2.3.1.RELEASE",
                "2.3.2.RELEASE",
                "2.3.3.RELEASE",
                "2.3.4.RELEASE",
                "2.3.5.RELEASE",
                "2.3.6.RELEASE",
                "2.3.7.RELEASE",
                "2.3.8.RELEASE",
                "2.4.0.RELEASE",
                "2.4.1.RELEASE",
                "2.4.2.RELEASE",
                "2.5.0.M1",
                "2.5.0.RC1",
                "2.5.0.RELEASE",
                "2.5.1.RELEASE",
                "2.5.2.RELEASE",
                "jwt1.0.11.RELEASE",
                "jwt1.0.9.RELEASE",
                "jwt1.1.0.RELEASE",
                "jwt1.1.1.RELEASE"
            ],
            "matched_rules": [
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 1161",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "af51eaea694d64bd733a9f00f0c0db13b967c8fd",
            "repository": "https://github.com/spring-projects/spring-security-oauth",
            "timestamp": 1511217496,
            "hunks": 1,
            "message": "Remove logging of form data in OAuth2AuthTokenCallback Fixes gh-1218",
            "diff": [
                "diff --git a/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/client/token/OAuth2AccessTokenSupport.java b/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/client/token/OAuth2AccessTokenSupport.java",
                "index 022882b1..865a0be4 100644",
                "--- a/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/client/token/OAuth2AccessTokenSupport.java",
                "+++ b/spring-security-oauth2/src/main/java/org/springframework/security/oauth2/client/token/OAuth2AccessTokenSupport.java",
                "@@ -220,3 +220,2 @@ public abstract class OAuth2AccessTokenSupport {",
                " \t\t\t\t\tArrays.asList(MediaType.APPLICATION_JSON, MediaType.APPLICATION_FORM_URLENCODED));",
                "-\t\t\tlogger.debug(\"Encoding and sending form: \" + form);",
                " \t\t\tFORM_MESSAGE_CONVERTER.write(this.form, MediaType.APPLICATION_FORM_URLENCODED, request);"
            ],
            "changed_files": [
                "spring-security-oauth2/src/main/java/org/springframework/security/oauth2/client/token/OAuth2AccessTokenSupport.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "1218": "OAuth2AccessTokenSupport class logs sensitive data in debug #1233"
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "1.0.10.RELEASE",
                "2.2.1.RELEASE",
                "2.2.2.RELEASE",
                "2.2.3.RELEASE",
                "2.2.4.RELEASE",
                "2.2.5.RELEASE",
                "2.2.6.RELEASE",
                "2.3.0.RC1",
                "2.3.0.RELEASE",
                "2.3.1.RELEASE",
                "2.3.2.RELEASE",
                "2.3.3.RELEASE",
                "2.3.4.RELEASE",
                "2.3.5.RELEASE",
                "2.3.6.RELEASE",
                "2.3.7.RELEASE",
                "2.3.8.RELEASE",
                "2.4.0.RELEASE",
                "2.4.1.RELEASE",
                "2.4.2.RELEASE",
                "2.5.0.M1",
                "2.5.0.RC1",
                "2.5.0.RELEASE",
                "2.5.1.RELEASE",
                "2.5.2.RELEASE",
                "jwt1.0.11.RELEASE",
                "jwt1.0.9.RELEASE",
                "jwt1.1.0.RELEASE",
                "jwt1.1.1.RELEASE"
            ],
            "matched_rules": [
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 1218",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "f2592c1e15aeafe9e44c4001d3ee26615d6efa42",
            "repository": "https://github.com/spring-projects/spring-security-oauth",
            "timestamp": 1513783715,
            "hunks": 1,
            "message": "Revert to snapshots spring-security-jwt",
            "diff": [
                "diff --git a/spring-security-jwt/pom.xml b/spring-security-jwt/pom.xml",
                "index 5fc10257..5aea0acb 100755",
                "--- a/spring-security-jwt/pom.xml",
                "+++ b/spring-security-jwt/pom.xml",
                "@@ -7,3 +7,3 @@",
                " \t<artifactId>spring-security-jwt</artifactId>",
                "-\t<version>1.0.9.RELEASE</version>",
                "+\t<version>1.0.10.BUILD-SNAPSHOT</version>",
                " \t<packaging>jar</packaging>"
            ],
            "changed_files": [
                "spring-security-jwt/pom.xml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "1.0.10.RELEASE",
                "2.3.0.RC1",
                "2.3.0.RELEASE",
                "2.3.1.RELEASE",
                "2.3.2.RELEASE",
                "2.3.3.RELEASE",
                "2.3.4.RELEASE",
                "2.3.5.RELEASE",
                "2.3.6.RELEASE",
                "2.3.7.RELEASE",
                "2.3.8.RELEASE",
                "2.4.0.RELEASE",
                "2.4.1.RELEASE",
                "2.4.2.RELEASE",
                "2.5.0.M1",
                "2.5.0.RC1",
                "2.5.0.RELEASE",
                "2.5.1.RELEASE",
                "2.5.2.RELEASE",
                "jwt1.0.11.RELEASE",
                "jwt1.1.0.RELEASE",
                "jwt1.1.1.RELEASE"
            ],
            "matched_rules": []
        },
        {
            "commit_id": "095a64999ddb9a24d01200d9ca49e90124722e32",
            "repository": "https://github.com/spring-projects/spring-security-oauth",
            "timestamp": 1513781796,
            "hunks": 1,
            "message": "Release jwt1.0.9.RELEASE",
            "diff": [
                "diff --git a/spring-security-jwt/pom.xml b/spring-security-jwt/pom.xml",
                "index 75334b89..5fc10257 100755",
                "--- a/spring-security-jwt/pom.xml",
                "+++ b/spring-security-jwt/pom.xml",
                "@@ -7,3 +7,3 @@",
                " \t<artifactId>spring-security-jwt</artifactId>",
                "-\t<version>1.0.9.BUILD-SNAPSHOT</version>",
                "+\t<version>1.0.9.RELEASE</version>",
                " \t<packaging>jar</packaging>"
            ],
            "changed_files": [
                "spring-security-jwt/pom.xml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "1.0.10.RELEASE",
                "2.3.0.RC1",
                "2.3.0.RELEASE",
                "2.3.1.RELEASE",
                "2.3.2.RELEASE",
                "2.3.3.RELEASE",
                "2.3.4.RELEASE",
                "2.3.5.RELEASE",
                "2.3.6.RELEASE",
                "2.3.7.RELEASE",
                "2.3.8.RELEASE",
                "2.4.0.RELEASE",
                "2.4.1.RELEASE",
                "2.4.2.RELEASE",
                "2.5.0.M1",
                "2.5.0.RC1",
                "2.5.0.RELEASE",
                "2.5.1.RELEASE",
                "2.5.2.RELEASE",
                "jwt1.0.11.RELEASE",
                "jwt1.0.9.RELEASE",
                "jwt1.1.0.RELEASE",
                "jwt1.1.1.RELEASE"
            ],
            "matched_rules": []
        }
    ]
}
