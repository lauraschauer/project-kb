{
    "advisory_record": {
        "cve_id": "CVE-2018-3732",
        "description": "resolve-path node module before 1.4.0 suffers from a Path Traversal vulnerability due to lack of validation of paths with certain special characters, which allows a malicious user to read content of any file with known path.",
        "reserved_timestamp": 1514419200,
        "published_timestamp": 1524700800,
        "updated_timestamp": 1528336621,
        "repository_url": null,
        "references": {
            "commit::fe5b8052cafd35fcdafe9210e100e9050b37d2a0": 2,
            "https://hackerone.com/reports/315760": 2
        },
        "affected_products": [
            "node",
            "resolve-path node module",
            "Path",
            "Traversal"
        ],
        "versions": {
            "status": "affected",
            "version": "Versions before 1.4.0"
        },
        "files": [
            "resolve-path"
        ],
        "keywords": [
            "file",
            "character",
            "vulnerability",
            "know",
            "suffer",
            "user",
            "resolve",
            "path",
            "validation",
            "allow",
            "traversal",
            "read",
            "content",
            "module",
            "lack",
            "node"
        ],
        "files_extension": [],
        "has_fixing_commit": true
    },
    "commits": [
        {
            "commit_id": "fe5b8052cafd35fcdafe9210e100e9050b37d2a0",
            "repository": "https://github.com/pillarjs/resolve-path",
            "timestamp": 1518542516,
            "hunks": 4,
            "message": "Fix resolving paths with certain special characters",
            "diff": [
                "diff --git a/index.js b/index.js",
                "index f62b8a2..1e668c2 100644",
                "--- a/index.js",
                "+++ b/index.js",
                "@@ -15,2 +15,3 @@",
                " var createError = require('http-errors')",
                "+var join = require('path').join",
                " var normalize = require('path').normalize",
                "@@ -84,7 +85,4 @@ function resolvePath (rootPath, relativePath) {",
                "-  // resolve & normalize the root path",
                "-  root = normalize(resolve(root) + sep)",
                "-",
                "-  // resolve the path",
                "-  return resolve(root, path)",
                "+  // join the relative path",
                "+  return normalize(join(resolve(root), path))",
                " }",
                "diff --git a/test/resolvePath.js b/test/resolvePath.js",
                "index 2b1377d..9267540 100644",
                "--- a/test/resolvePath.js",
                "+++ b/test/resolvePath.js",
                "@@ -33,2 +33,7 @@ describe('resolvePath(relativePath)', function () {",
                "+      it('should resolve relative with special characters', function () {",
                "+        assert.equal(normalize(resolvePath('f:oo$bar')),",
                "+          normalize(join(process.cwd(), './f:oo$bar')))",
                "+      })",
                "+",
                "       it('should accept empty string', function () {",
                "@@ -91,2 +96,7 @@ describe('resolvePath(rootPath, relativePath)', function () {",
                "+      it('should resolve relative to rootPath with special characters', function () {",
                "+        assert.equal(normalize(resolvePath(__dirname, 'f:oo$bar')),",
                "+        normalize(resolve(__dirname, './f:oo$bar')))",
                "+      })",
                "+",
                "       it('should accept relative path', function () {"
            ],
            "changed_files": [
                "index.js",
                "test/resolvePath.js"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "v1.4.0"
            ],
            "matched_rules": [
                {
                    "id": "COMMIT_IN_REFERENCE",
                    "message": "This commit is mentioned 2 times in the references.",
                    "relevance": 64
                },
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: character",
                    "relevance": 4
                }
            ]
        },
        {
            "commit_id": "a92d2bd35e538ae84261b4cfa1f9f22c02e751b8",
            "repository": "https://github.com/pillarjs/resolve-path",
            "timestamp": 1518542586,
            "hunks": 2,
            "message": "build: support Node.js 9.x",
            "diff": [
                "diff --git a/.travis.yml b/.travis.yml",
                "index a7db443..661de53 100644",
                "--- a/.travis.yml",
                "+++ b/.travis.yml",
                "@@ -13,2 +13,3 @@ node_js:",
                "   - \"8.9\"",
                "+  - \"9.4\"",
                " sudo: false",
                "diff --git a/appveyor.yml b/appveyor.yml",
                "index 180040c..1b1fa29 100644",
                "--- a/appveyor.yml",
                "+++ b/appveyor.yml",
                "@@ -13,2 +13,3 @@ environment:",
                "     - nodejs_version: \"8.9\"",
                "+    - nodejs_version: \"9.4\"",
                " cache:"
            ],
            "changed_files": [
                ".travis.yml",
                "appveyor.yml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "v1.4.0"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: node",
                    "relevance": 4
                }
            ]
        },
        {
            "commit_id": "b025ad5c7ee9f564c1da7a1a43c550c8187b6da0",
            "repository": "https://github.com/pillarjs/resolve-path",
            "timestamp": 1518543367,
            "hunks": 4,
            "message": "build: use yaml eslint configuration",
            "diff": [
                "diff --git a/.eslintrc b/.eslintrc",
                "deleted file mode 100644",
                "index e3578aa..0000000",
                "--- a/.eslintrc",
                "+++ /dev/null",
                "@@ -1,3 +0,0 @@",
                "-{",
                "-  \"extends\": \"standard\"",
                "-}",
                "diff --git a/.eslintrc.yml b/.eslintrc.yml",
                "new file mode 100644",
                "index 0000000..1eece14",
                "--- /dev/null",
                "+++ b/.eslintrc.yml",
                "@@ -0,0 +1,2 @@",
                "+root: true",
                "+extends: standard",
                "diff --git a/test/.eslintrc b/test/.eslintrc",
                "deleted file mode 100644",
                "index 7eeefc3..0000000",
                "--- a/test/.eslintrc",
                "+++ /dev/null",
                "@@ -1,5 +0,0 @@",
                "-{",
                "-  \"env\": {",
                "-    \"mocha\": true",
                "-  }",
                "-}",
                "diff --git a/test/.eslintrc.yml b/test/.eslintrc.yml",
                "new file mode 100644",
                "index 0000000..9808c3b",
                "--- /dev/null",
                "+++ b/test/.eslintrc.yml",
                "@@ -0,0 +1,2 @@",
                "+env:",
                "+  mocha: true"
            ],
            "changed_files": [
                ".eslintrc",
                ".eslintrc.yml",
                "test/.eslintrc",
                "test/.eslintrc.yml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "v1.4.0"
            ],
            "matched_rules": []
        },
        {
            "commit_id": "6debcf642f055d9b9d4d9c63b631af354030d3e0",
            "repository": "https://github.com/pillarjs/resolve-path",
            "timestamp": 1518543458,
            "hunks": 1,
            "message": "docs: update license",
            "diff": [
                "diff --git a/index.js b/index.js",
                "index 1e668c2..e889d9b 100644",
                "--- a/index.js",
                "+++ b/index.js",
                "@@ -3,3 +3,3 @@",
                "  * Copyright(c) 2014 Jonathan Ong",
                "- * Copyright(c) 2015 Douglas Christopher Wilson",
                "+ * Copyright(c) 2015-2018 Douglas Christopher Wilson",
                "  * MIT Licensed"
            ],
            "changed_files": [
                "index.js"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "v1.4.0"
            ],
            "matched_rules": []
        },
        {
            "commit_id": "a42cc4e93ed227a77444bdb269ce1c4723d9b76d",
            "repository": "https://github.com/pillarjs/resolve-path",
            "timestamp": 1518549760,
            "hunks": 1,
            "message": "1.4.0",
            "diff": [
                "diff --git a/package.json b/package.json",
                "index 76c0c6d..1823da0 100644",
                "--- a/package.json",
                "+++ b/package.json",
                "@@ -3,3 +3,3 @@",
                "   \"description\": \"Resolve a relative path against a root path with validation\",",
                "-  \"version\": \"1.3.3\",",
                "+  \"version\": \"1.4.0\",",
                "   \"author\": \"Jonathan Ong <me@jongleberry.com> (http://jongleberry.com)\","
            ],
            "changed_files": [
                "package.json"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "v1.4.0"
            ],
            "matched_rules": []
        }
    ]
}
