{
    "advisory_record": {
        "cve_id": "CVE-2018-1263",
        "description": "Addresses partial fix in CVE-2018-1261. Pivotal spring-integration-zip, versions prior to 1.0.2, exposes an arbitrary file write vulnerability, that can be achieved using a specially crafted zip archive (affects other archives as well, bzip2, tar, xz, war, cpio, 7z), that holds path traversal filenames. So when the filename gets concatenated to the target extraction directory, the final path ends up outside of the target folder.",
        "reserved_timestamp": 1512518400,
        "published_timestamp": 1525824000,
        "updated_timestamp": 1526464621,
        "repository_url": null,
        "references": {
            "http://www.securityfocus.com/bid/104179": 2,
            "https://pivotal.io/security/cve-2018-1263": 2
        },
        "affected_products": [
            "tar",
            "cpio",
            "Spring Integration Zip"
        ],
        "versions": {
            "status": "affected",
            "version": "versions prior to 1.0.2"
        },
        "files": [
            "CVE-2018-1261",
            "spring-integration-zip"
        ],
        "keywords": [
            "affect",
            "folder",
            "file",
            "address",
            "expose",
            "directory",
            "version",
            "archive",
            "cpio",
            "hold",
            "filename",
            "integration",
            "spring",
            "achieve",
            "write",
            "craft",
            "vulnerability",
            "concatenate",
            "path",
            "extraction",
            "target"
        ],
        "files_extension": [],
        "has_fixing_commit": false
    },
    "commits": [
        {
            "commit_id": "8c347877d97714e7888616f2639bb76bba3fddc9",
            "repository": "https://github.com/spring-projects/spring-integration-extensions",
            "timestamp": 1508794377,
            "hunks": 1,
            "message": "ZipTransformer: Use FILENAME header if specified If FILENAME is present at headers we must use this value as the name  of zip file without conversion",
            "diff": [
                "diff --git a/spring-integration-zip/src/main/java/org/springframework/integration/zip/transformer/ZipTransformer.java b/spring-integration-zip/src/main/java/org/springframework/integration/zip/transformer/ZipTransformer.java",
                "index b0f3545..71aa473 100644",
                "--- a/spring-integration-zip/src/main/java/org/springframework/integration/zip/transformer/ZipTransformer.java",
                "+++ b/spring-integration-zip/src/main/java/org/springframework/integration/zip/transformer/ZipTransformer.java",
                "@@ -115,3 +115,3 @@ public class ZipTransformer extends AbstractZipTransformer {",
                " \t\tif (message.getHeaders().containsKey(FileHeaders.FILENAME)) {",
                "-\t\t\tzipFileName = baseFileName;",
                "+\t\t\tzipFileName = (String) message.getHeaders().get(FileHeaders.FILENAME);",
                " \t\t}"
            ],
            "changed_files": [
                "spring-integration-zip/src/main/java/org/springframework/integration/zip/transformer/ZipTransformer.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "cass.v0.6.0.RELEASE",
                "cass.v0.7.0.RELEASE",
                "cass.v0.8.0.RELEASE",
                "cass.v0.9.0",
                "gr.v0.0.1",
                "hz.v2.0.0.RELEASE",
                "hz.v3.0.0",
                "kdsl.v0.0.1.RELEASE",
                "kdsl.v0.0.2.RELEASE",
                "sitw.v1.0.0.M1",
                "sitw.v1.0.0.RELEASE",
                "smb.v1.0.0.RELEASE",
                "smb.v1.1.0.RELEASE",
                "smb.v1.2.0.RELEASE",
                "smb.v1.2.1.RELEASE",
                "smb.v1.2.2.RELEASE",
                "zip.v1.0.1.RELEASE",
                "zip.v1.0.2.RELEASE",
                "zip.v1.0.3.RELEASE",
                "zip.v1.0.4.RELEASE",
                "zip.v2.0.0"
            ],
            "matched_rules": [
                {
                    "id": "CHANGES_RELEVANT_FILES",
                    "message": "The commit changes some relevant files: spring-integration-zip/src/main/java/org/springframework/integration/zip/transformer/ZipTransformer.java",
                    "relevance": 8
                },
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: filename, file, version",
                    "relevance": 4
                }
            ]
        }
    ]
}
