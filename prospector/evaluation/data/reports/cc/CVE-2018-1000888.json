{
    "advisory_record": {
        "cve_id": "CVE-2018-1000888",
        "description": "PEAR Archive_Tar version 1.4.3 and earlier contains a CWE-502, CWE-915 vulnerability in the Archive_Tar class. There are several file operations with `$v_header['filename']` as parameter (such as file_exists, is_file, is_dir, etc). When extract is called without a specific prefix path, we can trigger unserialization by crafting a tar file with `phar://[path_to_malicious_phar_file]` as path. Object injection can be used to trigger destruct in the loaded PHP classes, e.g. the Archive_Tar class itself. With Archive_Tar object injection, arbitrary file deletion can occur because `@unlink($this->_temp_tarname)` is called. If another class with useful gadget is loaded, it may possible to cause remote code execution that can result in files being deleted or possibly modified. This vulnerability appears to have been fixed in 1.4.4.",
        "reserved_timestamp": 1545264000,
        "published_timestamp": 1545933600,
        "updated_timestamp": 1592240811,
        "repository_url": null,
        "references": {
            "": 129,
            "https://pear.php.net/bugs/bug.php?id=23782": 6,
            "https://access.redhat.com/support/": 5,
            "https://cdn2.hubspot.net/hubfs/3853213/us-18-Thomas-It%27s-A-PHP-Unserialization-Vulnerability-Jim-But-Not-As-We-....pdf": 4,
            "https://blog.ripstech.com/2018/new-php-exploitation-technique/": 4,
            "commit::59ace120ac5ceb5f0d36e40e48e1884de1badf76": 4,
            "https://access.redhat.com/downloads/": 4,
            "https://access.redhat.com/errata/": 3,
            "https://access.redhat.com/labs/": 3,
            "https://lists.debian.org/debian-lts-announce/2019/02/msg00020.html": 2,
            "https://usn.ubuntu.com/3857-1/": 2,
            "https://www.debian.org/security/2019/dsa-4378": 2,
            "https://www.exploit-db.com/exploits/46108/": 2,
            "https://pear.php.net/package/Archive_Tar/download/": 2,
            "https://security.gentoo.org/glsa/202006-14": 2,
            "https://access.redhat.com/support/policy/updates/errata/": 2,
            "https://access.redhat.com/management/": 2,
            "https://access.redhat.com/": 2,
            "https://access.redhat.com/documentation": 2,
            "https://access.redhat.com/product-life-cycles/": 2,
            "https://access.redhat.com/security": 2,
            "https://access.redhat.com/security/security-updates/#/security-advisories": 2,
            "https://access.redhat.com/security/security-updates/#/cve": 2,
            "https://access.redhat.com/support/contact/": 2,
            "https://status.redhat.com": 2,
            "https://wiki.debian.org/LTS": 1,
            "https://get.gentoo.org/": 1,
            "https://www.gentoo.org/": 1,
            "https://wiki.gentoo.org/": 1,
            "https://bugs.gentoo.org/": 1,
            "https://forums.gentoo.org/": 1,
            "https://packages.gentoo.org/": 1,
            "https://planet.gentoo.org/": 1,
            "https://archives.gentoo.org/": 1,
            "https://sources.gentoo.org/": 1,
            "https://infra-status.gentoo.org/": 1,
            "https://nvd.nist.gov/vuln/detail/CVE-2018-1000888": 1,
            "https://bugs.gentoo.org/show_bug.cgi?id=675576": 1,
            "https://twitter.com/gentoo": 1,
            "https://www.facebook.com/gentoo.org": 1,
            "https://creativecommons.org/licenses/by-sa/4.0/": 1,
            "https://www.gentoo.org/inside-gentoo/foundation/name-logo-guidelines.html": 1,
            "https://access.redhat.com/products/red-hat-enterprise-linux/": 1,
            "https://access.redhat.com/products/red-hat-openshift-container-platform": 1,
            "https://access.redhat.com/products/red-hat-ansible-automation-platform/": 1,
            "https://access.redhat.com/products/": 1,
            "https://access.redhat.com/downloads/content/package-browser": 1,
            "https://catalog.redhat.com/software/containers/explore/": 1,
            "https://access.redhat.com/articles/1202803": 1,
            "https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution": 1,
            "https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article": 1,
            "https://access.redhat.com/documentation/en/red_hat_enterprise_linux": 1,
            "https://access.redhat.com/documentation/en/openshift_container_platform": 1,
            "https://access.redhat.com/documentation/en/red_hat_ansible_automation_platform": 1,
            "https://access.redhat.com/documentation/": 1,
            "https://access.redhat.com/security/": 1,
            "https://access.redhat.com/security/vulnerabilities": 1,
            "https://access.redhat.com/security/data": 1,
            "https://access.redhat.com/security/security-updates/#/security-labs": 1,
            "https://access.redhat.com/security/updates/backporting/": 1,
            "https://access.redhat.com/support/cases/": 1,
            "https://access.redhat.com/support/cases/#/troubleshoot": 1,
            "https://access.redhat.com/community": 1,
            "https://access.redhat.com/community/": 1,
            "https://access.redhat.com/discussions/": 1,
            "https://access.redhat.com/announcements/": 1,
            "https://access.redhat.com/accelerators/": 1,
            "https://access.redhat.com/jbossnetwork/restricted/listSoftware.html": 1,
            "https://cloud.redhat.com/insights": 1,
            "https://access.redhat.com/changeLanguage?language=en": 1,
            "https://access.redhat.com/changeLanguage?language=ko": 1,
            "https://access.redhat.com/changeLanguage?language=ja": 1,
            "https://access.redhat.com/changeLanguage?language=zh_CN": 1,
            "https://access.redhat.com/articles/rhel9-eus-faq": 1,
            "https://access.redhat.com/support/policy/updates/rhel7-els-support-maintenance-policy": 1,
            "http://www.redhat.com/resourcelibrary/articles/enterprise-linux-virtualization-support": 1,
            "https://redhat.com/en": 1,
            "https://twitter.com/RedHat": 1,
            "https://access.redhat.com/management": 1,
            "https://access.redhat.com/support": 1,
            "https://access.redhat.com/support/customer-service": 1,
            "https://access.redhat.com/articles/33844": 1,
            "https://access.redhat.com/help/login_assistance": 1,
            "https://www.redhat.com/en/trust": 1,
            "https://www.redhat.com/en/about/browser-support": 1,
            "https://www.redhat.com/en/about/digital-accessibility": 1,
            "https://access.redhat.com/recognition/": 1,
            "https://access.redhat.com/help/colophon/": 1,
            "https://www.redhat.com/": 1,
            "http://developers.redhat.com/": 1,
            "https://connect.redhat.com/": 1,
            "https://cloud.redhat.com/": 1,
            "https://access.redhat.com/subscription-value": 1,
            "https://www.redhat.com/about/": 1,
            "http://jobs.redhat.com": 1,
            "https://redhat.com/en/about/company": 1,
            "https://redhat.com/en/jobs": 1,
            "https://redhat.com/en/events": 1,
            "https://redhat.com/en/about/office-locations": 1,
            "https://redhat.com/en/contact": 1,
            "https://redhat.com/en/blog": 1,
            "https://redhat.com/en/about/our-culture/diversity-equity-inclusion": 1,
            "https://coolstuff.redhat.com/": 1,
            "https://www.redhat.com/en/summit": 1,
            "https://redhat.com/en/about/privacy-policy": 1,
            "https://redhat.com/en/about/terms-use": 1,
            "https://redhat.com/en/about/all-policies-guidelines": 1,
            "https://redhat.com/en/about/digital-accessibility": 1
        },
        "affected_products": [
            "n/a",
            "PHP"
        ],
        "versions": {
            "status": "affected",
            "version": "n/a"
        },
        "files": [
            "PEAR",
            "file_exists",
            "Archive_Tar",
            "is_dir",
            "unlink($this->_temp_tarname",
            "CWE-915",
            "CWE-502",
            "PHP",
            "is_file",
            "[path_to_malicious_phar_file"
        ],
        "keywords": [
            "trigger",
            "load",
            "result",
            "file",
            "class",
            "occur",
            "deletion",
            "delete",
            "parameter",
            "execution",
            "call",
            "craft",
            "destruct",
            "extract",
            "unserialization",
            "vulnerability",
            "operation",
            "appear",
            "contain",
            "prefix",
            "path",
            "injection",
            "object",
            "modify",
            "version",
            "pear",
            "gadget",
            "cause",
            "code"
        ],
        "files_extension": [],
        "has_fixing_commit": true
    },
    "commits": [
        {
            "commit_id": "59ace120ac5ceb5f0d36e40e48e1884de1badf76",
            "repository": "https://github.com/pear/Archive_Tar",
            "timestamp": 1545329497,
            "hunks": 1,
            "message": "Don't allow filenames to start with phar://",
            "diff": [
                "diff --git a/Archive/Tar.php b/Archive/Tar.php",
                "index 0bd1c6c..57a6d87 100644",
                "--- a/Archive/Tar.php",
                "+++ b/Archive/Tar.php",
                "@@ -1769,2 +1769,5 @@ class Archive_Tar extends PEAR",
                "     {",
                "+        if (strpos($file, 'phar://') === 0) {",
                "+            return true;",
                "+        }",
                "         if (strpos($file, '/../') !== false) {"
            ],
            "changed_files": [
                "Archive/Tar.php"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "1.4.10",
                "1.4.11",
                "1.4.12",
                "1.4.13",
                "1.4.14",
                "1.4.4",
                "1.4.5",
                "1.4.6",
                "1.4.7",
                "1.4.8",
                "1.4.9",
                "1.5.0"
            ],
            "matched_rules": [
                {
                    "id": "COMMIT_IN_REFERENCE",
                    "message": "This commit is mentioned 4 times in the references.",
                    "relevance": 64
                },
                {
                    "id": "CHANGES_RELEVANT_CODE",
                    "message": "The commit modifies code containing relevant filename or methods: Archive_Tar",
                    "relevance": 8
                },
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: file",
                    "relevance": 4
                }
            ]
        },
        {
            "commit_id": "58715c9f4ab8543a6a1fb11bb97893dfc3c7ee3c",
            "repository": "https://github.com/pear/Archive_Tar",
            "timestamp": 1545338160,
            "hunks": 4,
            "message": "Update for new package version",
            "diff": [
                "diff --git a/package.xml b/package.xml",
                "index fd9fc0f..3d40461 100644",
                "--- a/package.xml",
                "+++ b/package.xml",
                "@@ -34,6 +34,6 @@ Also Lzma2 compressed archives are supported with xz extension.</description>",
                "  </helper>",
                "- <date>2017-06-11</date>",
                "- <time>17:31:00</time>",
                "+ <date>2018-12-20</date>",
                "+ <time>20:42:18</time>",
                "  <version>",
                "-  <release>1.4.3</release>",
                "+  <release>1.4.4</release>",
                "   <api>1.4.0</api>",
                "@@ -46,4 +46,4 @@ Also Lzma2 compressed archives are supported with xz extension.</description>",
                "  <notes>",
                "-* Fix Bug #21218: Cannot use result of built-in function in write context in PHP",
                "-   7.2.0alpha1 [mrook]",
                "+* Fix Bug #21058: Long symlinks are not supported [mrook]",
                "+ * Fix Bug #23782: Prevent phar:// files from being extracted [mrook]",
                "  </notes>",
                "@@ -77,2 +77,18 @@ Also Lzma2 compressed archives are supported with xz extension.</description>",
                "  <changelog>",
                "+  <release>",
                "+   <version>",
                "+    <release>1.4.3</release>",
                "+    <api>1.4.0</api>",
                "+   </version>",
                "+   <stability>",
                "+    <release>stable</release>",
                "+    <api>stable</api>",
                "+   </stability>",
                "+   <date>2017-06-11</date>",
                "+   <license uri=\"http://www.opensource.org/licenses/bsd-license.php\">New BSD License</license>",
                "+   <notes>",
                "+* Fix Bug #21218: Cannot use result of built-in function in write context in PHP",
                "+   7.2.0alpha1 [mrook]",
                "+   </notes>",
                "+  </release>",
                "   <release>"
            ],
            "changed_files": [
                "package.xml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "1.4.10",
                "1.4.11",
                "1.4.12",
                "1.4.13",
                "1.4.14",
                "1.4.4",
                "1.4.5",
                "1.4.6",
                "1.4.7",
                "1.4.8",
                "1.4.9",
                "1.5.0"
            ],
            "matched_rules": [
                {
                    "id": "CHANGES_RELEVANT_CODE",
                    "message": "The commit modifies code containing relevant filename or methods: PHP",
                    "relevance": 8
                },
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: version",
                    "relevance": 4
                }
            ]
        },
        {
            "commit_id": "760028904036b1957613cc3f75e22cf9305fefd1",
            "repository": "https://github.com/pear/Archive_Tar",
            "timestamp": 1545338579,
            "hunks": 3,
            "message": "Don't retrieve file info for long headers for now",
            "diff": [
                "diff --git a/Archive/Tar.php b/Archive/Tar.php",
                "index b8b28f4..48bfd3e 100644",
                "--- a/Archive/Tar.php",
                "+++ b/Archive/Tar.php",
                "@@ -1569,6 +1569,5 @@ class Archive_Tar extends PEAR",
                "     {",
                "-        $v_info = lstat($p_filename);",
                "         $v_uid = sprintf(\"%07s\", 0);",
                "         $v_gid = sprintf(\"%07s\", 0);",
                "-        $v_perms = sprintf(\"%07s\", DecOct($v_info['mode'] & 000777));",
                "+        $v_perms = sprintf(\"%07s\", 0);",
                "         $v_size = sprintf(\"%'011s\", DecOct(strlen($p_filename)));",
                "@@ -1579,12 +1578,4 @@ class Archive_Tar extends PEAR",
                "         $v_version = ' ';",
                "-        if (function_exists('posix_getpwuid')) {",
                "-            $userinfo = posix_getpwuid($v_info[4]);",
                "-            $groupinfo = posix_getgrgid($v_info[5]);",
                "-",
                "-            $v_uname = $userinfo['name'];",
                "-            $v_gname = $groupinfo['name'];",
                "-        } else {",
                "-            $v_uname = '';",
                "-            $v_gname = '';",
                "-        }",
                "+        $v_uname = '';",
                "+        $v_gname = '';",
                "         $v_devmajor = '';"
            ],
            "changed_files": [
                "Archive/Tar.php"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "1.4.10",
                "1.4.11",
                "1.4.12",
                "1.4.13",
                "1.4.14",
                "1.4.4",
                "1.4.5",
                "1.4.6",
                "1.4.7",
                "1.4.8",
                "1.4.9",
                "1.5.0"
            ],
            "matched_rules": [
                {
                    "id": "CHANGES_RELEVANT_CODE",
                    "message": "The commit modifies code containing relevant filename or methods: Archive_Tar",
                    "relevance": 8
                },
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: file",
                    "relevance": 4
                }
            ]
        },
        {
            "commit_id": "a798c0511f5bcd67c3d1327301e2edd24bc0b92c",
            "repository": "https://github.com/pear/Archive_Tar",
            "timestamp": 1545337160,
            "hunks": 22,
            "message": "Support symbolic link targets over 100 characters, update long headers",
            "diff": [
                "diff --git a/Archive/Tar.php b/Archive/Tar.php",
                "index 57a6d87..b8b28f4 100644",
                "--- a/Archive/Tar.php",
                "+++ b/Archive/Tar.php",
                "@@ -1339,6 +1339,20 @@ class Archive_Tar extends PEAR",
                "         }",
                "-        $v_reduce_filename = $this->_pathReduction($p_stored_filename);",
                "-        if (strlen($v_reduce_filename) > 99) {",
                "-            if (!$this->_writeLongHeader($v_reduce_filename)) {",
                "+        $v_linkname = '';",
                "+        $v_reduced_linkname = '';",
                "+        if (@is_link($p_filename)) {",
                "+            $v_linkname = readlink($p_filename);",
                "+            $v_reduced_linkname = $this->_pathReduction($v_linkname);",
                "+        }",
                "+",
                "+        $v_reduced_filename = $this->_pathReduction($p_stored_filename);",
                "+",
                "+        if (strlen($v_reduced_filename) > 99) {",
                "+            if (!$this->_writeLongHeader($v_reduced_filename, false)) {",
                "+                return false;",
                "+            }",
                "+        }",
                "+",
                "+        if (strlen($v_reduced_linkname) > 99) {",
                "+            if (!$this->_writeLongHeader($v_reduced_linkname, true)) {",
                "                 return false;",
                "@@ -1351,10 +1365,6 @@ class Archive_Tar extends PEAR",
                "         $v_perms = sprintf(\"%07s\", DecOct($v_info['mode'] & 000777));",
                "-",
                "         $v_mtime = sprintf(\"%011s\", DecOct($v_info['mtime']));",
                "-        $v_linkname = '';",
                "-",
                "-        if (@is_link($p_filename)) {",
                "+        if ($v_linkname !== '') {",
                "             $v_typeflag = '2';",
                "-            $v_linkname = readlink($p_filename);",
                "             $v_size = sprintf(\"%011s\", DecOct(0));",
                "@@ -1370,3 +1380,2 @@ class Archive_Tar extends PEAR",
                "         $v_magic = 'ustar ';",
                "-",
                "         $v_version = ' ';",
                "@@ -1385,5 +1394,3 @@ class Archive_Tar extends PEAR",
                "         $v_devmajor = '';",
                "-",
                "         $v_devminor = '';",
                "-",
                "         $v_prefix = '';",
                "@@ -1392,3 +1399,3 @@ class Archive_Tar extends PEAR",
                "             \"a100a8a8a8a12a12\",",
                "-            $v_reduce_filename,",
                "+            $v_reduced_filename,",
                "             $v_perms,",
                "@@ -1402,3 +1409,3 @@ class Archive_Tar extends PEAR",
                "             $v_typeflag,",
                "-            $v_linkname,",
                "+            $v_reduced_linkname,",
                "             $v_magic,",
                "@@ -1432,3 +1439,3 @@ class Archive_Tar extends PEAR",
                "         // ----- Write the calculated checksum",
                "-        $v_checksum = sprintf(\"%06s \", DecOct($v_checksum));",
                "+        $v_checksum = sprintf(\"%06s\\0 \", DecOct($v_checksum));",
                "         $v_binary_data = pack(\"a8\", $v_checksum);",
                "@@ -1464,3 +1471,3 @@ class Archive_Tar extends PEAR",
                "         if (strlen($p_filename) > 99) {",
                "-            if (!$this->_writeLongHeader($p_filename)) {",
                "+            if (!$this->_writeLongHeader($p_filename, false)) {",
                "                 return false;",
                "@@ -1560,22 +1567,26 @@ class Archive_Tar extends PEAR",
                "      */",
                "-    public function _writeLongHeader($p_filename)",
                "+    public function _writeLongHeader($p_filename, $is_link = false)",
                "     {",
                "-        $v_size = sprintf(\"%11s \", DecOct(strlen($p_filename)));",
                "-",
                "-        $v_typeflag = 'L';",
                "-",
                "+        $v_info = lstat($p_filename);",
                "+        $v_uid = sprintf(\"%07s\", 0);",
                "+        $v_gid = sprintf(\"%07s\", 0);",
                "+        $v_perms = sprintf(\"%07s\", DecOct($v_info['mode'] & 000777));",
                "+        $v_size = sprintf(\"%'011s\", DecOct(strlen($p_filename)));",
                "+        $v_mtime = sprintf(\"%011s\", 0);",
                "+        $v_typeflag = ($is_link ? 'K' : 'L');",
                "         $v_linkname = '';",
                "+        $v_magic = 'ustar ';",
                "+        $v_version = ' ';",
                "+        if (function_exists('posix_getpwuid')) {",
                "+            $userinfo = posix_getpwuid($v_info[4]);",
                "+            $groupinfo = posix_getgrgid($v_info[5]);",
                "-        $v_magic = '';",
                "-",
                "-        $v_version = '';",
                "-",
                "-        $v_uname = '';",
                "-",
                "-        $v_gname = '';",
                "-",
                "+            $v_uname = $userinfo['name'];",
                "+            $v_gname = $groupinfo['name'];",
                "+        } else {",
                "+            $v_uname = '';",
                "+            $v_gname = '';",
                "+        }",
                "         $v_devmajor = '';",
                "-",
                "         $v_devminor = '';",
                "-",
                "         $v_prefix = '';",
                "@@ -1585,7 +1596,7 @@ class Archive_Tar extends PEAR",
                "             '././@LongLink',",
                "-            0,",
                "-            0,",
                "-            0,",
                "+            $v_perms,",
                "+            $v_uid,",
                "+            $v_gid,",
                "             $v_size,",
                "-            0",
                "+            $v_mtime",
                "         );",
                "@@ -1624,3 +1635,3 @@ class Archive_Tar extends PEAR",
                "         // ----- Write the calculated checksum",
                "-        $v_checksum = sprintf(\"%06s \", DecOct($v_checksum));",
                "+        $v_checksum = sprintf(\"%06s\\0 \", DecOct($v_checksum));",
                "         $v_binary_data = pack(\"a8\", $v_checksum);",
                "@@ -1840,7 +1851,16 @@ class Archive_Tar extends PEAR",
                "-            // ----- Look for long filename",
                "-            if ($v_header['typeflag'] == 'L') {",
                "-                if (!$this->_readLongHeader($v_header)) {",
                "-                    return null;",
                "-                }",
                "+            switch ($v_header['typeflag']) {",
                "+                case 'L': {",
                "+                    if (!$this->_readLongHeader($v_header)) {",
                "+                        return null;",
                "+                    }",
                "+                } break;",
                "+",
                "+                case 'K': {",
                "+                    $v_link_header = $v_header;",
                "+                    if (!$this->_readLongHeader($v_link_header)) {",
                "+                        return null;",
                "+                    }",
                "+                    $v_header['link'] = $v_link_header['filename'];",
                "+                } break;",
                "             }",
                "@@ -1945,7 +1965,16 @@ class Archive_Tar extends PEAR",
                "-            // ----- Look for long filename",
                "-            if ($v_header['typeflag'] == 'L') {",
                "-                if (!$this->_readLongHeader($v_header)) {",
                "-                    return false;",
                "-                }",
                "+            switch ($v_header['typeflag']) {",
                "+                case 'L': {",
                "+                    if (!$this->_readLongHeader($v_header)) {",
                "+                        return null;",
                "+                    }",
                "+                } break;",
                "+",
                "+                case 'K': {",
                "+                    $v_link_header = $v_header;",
                "+                    if (!$this->_readLongHeader($v_link_header)) {",
                "+                        return null;",
                "+                    }",
                "+                    $v_header['link'] = $v_link_header['filename'];",
                "+                } break;",
                "             }",
                "diff --git a/tests/longsymlinks.phpt b/tests/longsymlinks.phpt",
                "new file mode 100644",
                "index 0000000..cc7c90c",
                "--- /dev/null",
                "+++ b/tests/longsymlinks.phpt",
                "@@ -0,0 +1,29 @@",
                "+--TEST--",
                "+test trimming of characters in long symbolic link targets",
                "+--SKIPIF--",
                "+--FILE--",
                "+<?php",
                "+require_once dirname(__FILE__) . '/setup.php.inc';",
                "+$dirname = dirname(__FILE__) . '/longsymlink/';",
                "+$longfilename = $dirname . str_repeat(\"b\", 120) . \" \";",
                "+$symlinkfilename = $dirname . \"a\";",
                "+mkdir($dirname, 0777, true);",
                "+touch($longfilename);",
                "+symlink($longfilename, $symlinkfilename);",
                "+$tar = new Archive_Tar(dirname(__FILE__) . '/testlongsymlink.tar');",
                "+$tar->addModify(array($longfilename, $symlinkfilename), '', dirname(__FILE__));",
                "+$tar = new Archive_Tar(dirname(__FILE__) . '/testlongsymlink.tar');",
                "+$files = $tar->listContent();",
                "+$file = end($files);",
                "+$lastChar = $file['link'][strlen($file['link']) - 1];",
                "+$phpunit->assertEquals(' ', $lastChar, 'should contain space as last character');",
                "+echo 'tests done';",
                "+?>",
                "+--CLEAN--",
                "+<?php",
                "+$dirname = dirname(__FILE__);",
                "+unlink($dirname . '/testlongsymlink.tar');",
                "+system(\"rm -r $dirname/longsymlink\");",
                "+?>",
                "+--EXPECT--",
                "+tests done"
            ],
            "changed_files": [
                "Archive/Tar.php",
                "tests/longsymlinks.phpt"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "1.4.10",
                "1.4.11",
                "1.4.12",
                "1.4.13",
                "1.4.14",
                "1.4.4",
                "1.4.5",
                "1.4.6",
                "1.4.7",
                "1.4.8",
                "1.4.9",
                "1.5.0"
            ],
            "matched_rules": [
                {
                    "id": "CHANGES_RELEVANT_CODE",
                    "message": "The commit modifies code containing relevant filename or methods: Archive_Tar",
                    "relevance": 8
                }
            ]
        },
        {
            "commit_id": "7f3fb90149ca3b44667ca0b307d0d817ffb4b077",
            "repository": "https://github.com/pear/Archive_Tar",
            "timestamp": 1545827147,
            "hunks": 3,
            "message": "Fix dangling symlinks",
            "diff": [
                "diff --git a/Archive/Tar.php b/Archive/Tar.php",
                "index 48bfd3e..798a249 100644",
                "--- a/Archive/Tar.php",
                "+++ b/Archive/Tar.php",
                "@@ -1340,9 +1340,2 @@ class Archive_Tar extends PEAR",
                "-        $v_linkname = '';",
                "-        $v_reduced_linkname = '';",
                "-        if (@is_link($p_filename)) {",
                "-            $v_linkname = readlink($p_filename);",
                "-            $v_reduced_linkname = $this->_pathReduction($v_linkname);",
                "-        }",
                "-",
                "         $v_reduced_filename = $this->_pathReduction($p_stored_filename);",
                "@@ -1355,4 +1348,4 @@ class Archive_Tar extends PEAR",
                "-        if (strlen($v_reduced_linkname) > 99) {",
                "-            if (!$this->_writeLongHeader($v_reduced_linkname, true)) {",
                "+        if (strlen($v_linkname) > 99) {",
                "+            if (!$this->_writeLongHeader($v_linkname, true)) {",
                "                 return false;",
                "@@ -1409,3 +1402,3 @@ class Archive_Tar extends PEAR",
                "             $v_typeflag,",
                "-            $v_reduced_linkname,",
                "+            $v_linkname,",
                "             $v_magic,"
            ],
            "changed_files": [
                "Archive/Tar.php"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "1.4.10",
                "1.4.11",
                "1.4.12",
                "1.4.13",
                "1.4.14",
                "1.4.5",
                "1.4.6",
                "1.4.7",
                "1.4.8",
                "1.4.9",
                "1.5.0"
            ],
            "matched_rules": [
                {
                    "id": "CHANGES_RELEVANT_CODE",
                    "message": "The commit modifies code containing relevant filename or methods: Archive_Tar",
                    "relevance": 8
                }
            ]
        },
        {
            "commit_id": "86d7ee6c40b49f1bd46d737415e0e423a28ee4d4",
            "repository": "https://github.com/pear/Archive_Tar",
            "timestamp": 1545828077,
            "hunks": 2,
            "message": "Update Tar.php",
            "diff": [
                "diff --git a/Archive/Tar.php b/Archive/Tar.php",
                "index 798a249..efa394a 100644",
                "--- a/Archive/Tar.php",
                "+++ b/Archive/Tar.php",
                "@@ -1348,2 +1348,7 @@ class Archive_Tar extends PEAR",
                "+        $v_linkname = '';",
                "+        if (@is_link($p_filename)) {",
                "+            $v_linkname = readlink($p_filename);",
                "+        }",
                "+",
                "         if (strlen($v_linkname) > 99) {",
                "@@ -1360,3 +1365,3 @@ class Archive_Tar extends PEAR",
                "-        if ($v_linkname !== '') {",
                "+        if (@is_link($p_filename)) {",
                "             $v_typeflag = '2';"
            ],
            "changed_files": [
                "Archive/Tar.php"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "1.4.10",
                "1.4.11",
                "1.4.12",
                "1.4.13",
                "1.4.14",
                "1.4.5",
                "1.4.6",
                "1.4.7",
                "1.4.8",
                "1.4.9",
                "1.5.0"
            ],
            "matched_rules": [
                {
                    "id": "CHANGES_RELEVANT_CODE",
                    "message": "The commit modifies code containing relevant filename or methods: Archive_Tar",
                    "relevance": 8
                }
            ]
        },
        {
            "commit_id": "63b5f9f1da3207aa5f09ec3d87b693b47d006492",
            "repository": "https://github.com/pear/Archive_Tar",
            "timestamp": 1545898309,
            "hunks": 0,
            "message": "Merge pull request #21 from MPParsley/patch-1 Fix dangling symlinks",
            "diff": [],
            "changed_files": [],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "21": "Lock pear/archive_tar to 1.4.3 district09/robo-digipolis-package#14"
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "1.4.10",
                "1.4.11",
                "1.4.12",
                "1.4.13",
                "1.4.14",
                "1.4.5",
                "1.4.6",
                "1.4.7",
                "1.4.8",
                "1.4.9",
                "1.5.0"
            ],
            "matched_rules": [
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 21",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "b005152d4ed8f23bcc93637611fa94f39ef5b904",
            "repository": "https://github.com/pear/Archive_Tar",
            "timestamp": 1545338844,
            "hunks": 1,
            "message": "Add 7.3 builds",
            "diff": [
                "diff --git a/.travis.yml b/.travis.yml",
                "index 6da7a68..f12ff15 100644",
                "--- a/.travis.yml",
                "+++ b/.travis.yml",
                "@@ -20,2 +20,4 @@ matrix:",
                "     dist: trusty",
                "+  - php: 7.3",
                "+    dist: trusty",
                " install:"
            ],
            "changed_files": [
                ".travis.yml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "1.4.10",
                "1.4.11",
                "1.4.12",
                "1.4.13",
                "1.4.14",
                "1.4.4",
                "1.4.5",
                "1.4.6",
                "1.4.7",
                "1.4.8",
                "1.4.9",
                "1.5.0"
            ],
            "matched_rules": []
        },
        {
            "commit_id": "8495ffb4a8dda472724fd8b2b2b137d130048b20",
            "repository": "https://github.com/pear/Archive_Tar",
            "timestamp": 1545338759,
            "hunks": 1,
            "message": "Always install local package",
            "diff": [
                "diff --git a/.travis.yml b/.travis.yml",
                "index cf16360..6da7a68 100644",
                "--- a/.travis.yml",
                "+++ b/.travis.yml",
                "@@ -22,3 +22,3 @@ install:",
                "   - pear upgrade --force --alldeps pear/pear",
                "-  - pear install package.xml",
                "+  - pear install -f package.xml",
                " script:"
            ],
            "changed_files": [
                ".travis.yml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "1.4.10",
                "1.4.11",
                "1.4.12",
                "1.4.13",
                "1.4.14",
                "1.4.4",
                "1.4.5",
                "1.4.6",
                "1.4.7",
                "1.4.8",
                "1.4.9",
                "1.5.0"
            ],
            "matched_rules": []
        }
    ]
}
