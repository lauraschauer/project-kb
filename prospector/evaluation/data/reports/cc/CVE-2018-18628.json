{
    "advisory_record": {
        "cve_id": "CVE-2018-18628",
        "description": "An issue was discovered in Pippo 1.11.0. The function SerializationSessionDataTranscoder.decode() calls ObjectInputStream.readObject() to deserialize a SessionData object without checking the object types. An attacker can create a malicious object, base64 encode it, and place it in the PIPPO_SESSION field of a cookie. Sending this cookie may lead to remote code execution.",
        "reserved_timestamp": 1664755200,
        "published_timestamp": 1664814123,
        "updated_timestamp": 1664814123,
        "repository_url": null,
        "references": {
            "": 78,
            "https://github.com/pippo-java/pippo/issues/458": 3,
            "commit::a82347d9d3358e98c89b48579d4285d807a57cc0": 3,
            "https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax": 2,
            "https://github.com/features/actions": 1,
            "https://github.com/features/packages": 1,
            "https://github.com/features/security": 1,
            "https://github.com/features/codespaces": 1,
            "https://github.com/features/copilot": 1,
            "https://github.com/features/code-review": 1,
            "https://github.com/features/issues": 1,
            "https://github.com/features/discussions": 1,
            "https://github.com/features": 1,
            "https://docs.github.com": 1,
            "https://skills.github.com": 1,
            "https://github.blog": 1,
            "https://github.com/enterprise": 1,
            "https://github.com/team": 1,
            "https://github.com/enterprise/startups": 1,
            "https://github.com/solutions/industries/healthcare": 1,
            "https://github.com/solutions/industries/financial-services": 1,
            "https://github.com/solutions/industries/manufacturing": 1,
            "https://github.com/solutions/ci-cd": 1,
            "https://github.com/solutions/devops": 1,
            "https://github.com/solutions/devsecops": 1,
            "https://resources.github.com/learn/pathways": 1,
            "https://resources.github.com": 1,
            "https://github.com/customer-stories": 1,
            "https://partner.github.com": 1,
            "https://github.com/readme": 1,
            "https://github.com/topics": 1,
            "https://github.com/trending": 1,
            "https://github.com/collections": 1,
            "https://github.com/enterprise/advanced-security": 1,
            "https://github.com/pricing": 1,
            "https://docs.github.com/terms": 1,
            "https://docs.github.com/privacy": 1,
            "https://issues.apache.org/jira/browse/SHIRO-550": 1,
            "https://www.anquanke.com/post/id/87270": 1,
            "https://github.com/360-A-Team/SerialWriter": 1,
            "https://user-images.githubusercontent.com/8623936/46254251-d28bae80-c4be-11e8-8f94-e6ac49a969bf.jpg": 1,
            "https://github.com/pippo-java/pippo/files/2431312/jre8u20payload_base64.txt": 1,
            "https://nvd.nist.gov/vuln/detail/CVE-2018-18628": 1,
            "https://github.com": 1,
            "https://docs.github.com/site-policy/github-terms/github-terms-of-service": 1,
            "https://docs.github.com/site-policy/privacy-policies/github-privacy-statement": 1,
            "https://github.com/security": 1,
            "https://www.githubstatus.com/": 1,
            "https://docs.github.com/": 1,
            "https://support.github.com?tags=dotcom-footer": 1
        },
        "affected_products": [
            "n/a",
            "Pippo",
            "SessionData"
        ],
        "versions": {
            "status": "affected",
            "version": "n/a"
        },
        "files": [
            "SessionData",
            "PIPPO_SESSION",
            "ObjectInputStream",
            "decode",
            "readObject",
            "SerializationSessionDataTranscoder"
        ],
        "keywords": [
            "base64",
            "function",
            "pippo",
            "code",
            "attacker",
            "execution",
            "sessiondata",
            "field",
            "send",
            "create",
            "type",
            "issue",
            "discover",
            "deserialize",
            "object",
            "check",
            "cookie",
            "call",
            "place",
            "lead"
        ],
        "files_extension": [],
        "has_fixing_commit": false
    },
    "commits": [
        {
            "commit_id": "41ffad914151113ecc922b1c5cb91e7660ba8f54",
            "repository": "https://github.com/pippo-java/pippo",
            "timestamp": 1669141292,
            "hunks": 2,
            "message": "Add code analyses via Sonar",
            "diff": [
                "diff --git a/.github/workflows/build.yml b/.github/workflows/build.yml",
                "new file mode 100644",
                "index 00000000..8408077a",
                "--- /dev/null",
                "+++ b/.github/workflows/build.yml",
                "@@ -0,0 +1,36 @@",
                "+name: Build",
                "+on:",
                "+    push:",
                "+        branches:",
                "+            - '*'",
                "+    pull_request:",
                "+        types: [opened, synchronize, reopened]",
                "+jobs:",
                "+    build:",
                "+        name: Build",
                "+        runs-on: ubuntu-latest",
                "+        steps:",
                "+            - uses: actions/checkout@v2",
                "+              with:",
                "+                  fetch-depth: 0  # Shallow clones should be disabled for a better relevancy of analysis",
                "+            - name: Set up JDK 8",
                "+              uses: actions/setup-java@v1",
                "+              with:",
                "+                  java-version: 8",
                "+            - name: Cache SonarCloud packages",
                "+              uses: actions/cache@v1",
                "+              with:",
                "+                  path: ~/.sonar/cache",
                "+                  key: ${{ runner.os }}-sonar",
                "+                  restore-keys: ${{ runner.os }}-sonar",
                "+            - name: Cache Maven packages",
                "+              uses: actions/cache@v1",
                "+              with:",
                "+                  path: ~/.m2",
                "+                  key: ${{ runner.os }}-m2-${{ hashFiles('**/pom.xml') }}",
                "+                  restore-keys: ${{ runner.os }}-m2",
                "+            - name: Build and analyze",
                "+              env:",
                "+                  GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}  # Needed to get PR information, if any",
                "+                  SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}",
                "+              run: cd pippo && mvn -B verify org.sonarsource.scanner.maven:sonar-maven-plugin:sonar",
                "diff --git a/pom.xml b/pom.xml",
                "index 73b77848..1fdc4f30 100644",
                "--- a/pom.xml",
                "+++ b/pom.xml",
                "@@ -58,2 +58,6 @@",
                "         <coveralls.version>3.1.0</coveralls.version>",
                "+",
                "+        <sonar.projectKey>pippo-java_pippo</sonar.projectKey>",
                "+        <sonar.organization>pippo</sonar.organization>",
                "+        <sonar.host.url>https://sonarcloud.io</sonar.host.url>",
                "     </properties>"
            ],
            "changed_files": [
                ".github/workflows/build.yml",
                "pom.xml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: code",
                    "relevance": 4
                }
            ]
        },
        {
            "commit_id": "05cde977adc599d27aab831f840f928a3368e57f",
            "repository": "https://github.com/pippo-java/pippo",
            "timestamp": 1669130181,
            "hunks": 1,
            "message": "Bump tomcat-embed-core in /pippo-server-parent/pippo-tomcat Bumps tomcat-embed-core from 8.5.61 to 8.5.63. --- updated-dependencies: - dependency-name: org.apache.tomcat.embed:tomcat-embed-core   dependency-type: direct:production ... Signed-off-by: dependabot[bot] <support@github.com>",
            "diff": [
                "diff --git a/pippo-server-parent/pippo-tomcat/pom.xml b/pippo-server-parent/pippo-tomcat/pom.xml",
                "index df5debb0..2c079682 100644",
                "--- a/pippo-server-parent/pippo-tomcat/pom.xml",
                "+++ b/pippo-server-parent/pippo-tomcat/pom.xml",
                "@@ -16,3 +16,3 @@",
                "     <properties>",
                "-        <tomcat.version>8.5.61</tomcat.version>",
                "+        <tomcat.version>8.5.63</tomcat.version>",
                "     </properties>"
            ],
            "changed_files": [
                "pippo-server-parent/pippo-tomcat/pom.xml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: type",
                    "relevance": 4
                }
            ]
        },
        {
            "commit_id": "d563062cb2ea89d97dfcce285eea205b7de823ab",
            "repository": "https://github.com/pippo-java/pippo",
            "timestamp": 1669130153,
            "hunks": 1,
            "message": "Bumped pac4j to 4.5.7 (#614)",
            "diff": [
                "diff --git a/pippo-security-parent/pippo-pac4j/pom.xml b/pippo-security-parent/pippo-pac4j/pom.xml",
                "index 3f90df99..98ff1875 100644",
                "--- a/pippo-security-parent/pippo-pac4j/pom.xml",
                "+++ b/pippo-security-parent/pippo-pac4j/pom.xml",
                "@@ -16,3 +16,3 @@",
                "     <properties>",
                "-        <pac4j.version>2.2.0</pac4j.version>",
                "+        <pac4j.version>4.5.7</pac4j.version>",
                "     </properties>"
            ],
            "changed_files": [
                "pippo-security-parent/pippo-pac4j/pom.xml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "614": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "release-1.14.0"
            ],
            "matched_rules": [
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 614",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "3118963d7ad11360e6d902ed7ac32ddbcd21af8d",
            "repository": "https://github.com/pippo-java/pippo",
            "timestamp": 1669131251,
            "hunks": 1,
            "message": "Revert \"Bumped pac4j to 4.5.7 (#614)\" This reverts commit d563062cb2ea89d97dfcce285eea205b7de823ab.",
            "diff": [
                "diff --git a/pippo-security-parent/pippo-pac4j/pom.xml b/pippo-security-parent/pippo-pac4j/pom.xml",
                "index 98ff1875..3f90df99 100644",
                "--- a/pippo-security-parent/pippo-pac4j/pom.xml",
                "+++ b/pippo-security-parent/pippo-pac4j/pom.xml",
                "@@ -16,3 +16,3 @@",
                "     <properties>",
                "-        <pac4j.version>4.5.7</pac4j.version>",
                "+        <pac4j.version>2.2.0</pac4j.version>",
                "     </properties>"
            ],
            "changed_files": [
                "pippo-security-parent/pippo-pac4j/pom.xml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "614": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "release-1.14.0"
            ],
            "matched_rules": [
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 614",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "b7dada476f03d462f3ba0cef31b06de50d330818",
            "repository": "https://github.com/pippo-java/pippo",
            "timestamp": 1669145050,
            "hunks": 1,
            "message": "Fix sonar.organization property",
            "diff": [
                "diff --git a/pom.xml b/pom.xml",
                "index 1fdc4f30..e3d93cac 100644",
                "--- a/pom.xml",
                "+++ b/pom.xml",
                "@@ -60,3 +60,3 @@",
                "         <sonar.projectKey>pippo-java_pippo</sonar.projectKey>",
                "-        <sonar.organization>pippo</sonar.organization>",
                "+        <sonar.organization>pippo-java</sonar.organization>",
                "         <sonar.host.url>https://sonarcloud.io</sonar.host.url>"
            ],
            "changed_files": [
                "pom.xml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [],
            "matched_rules": []
        },
        {
            "commit_id": "ac59d5abb131901cc984bd46b5c9aaa1ea72a595",
            "repository": "https://github.com/pippo-java/pippo",
            "timestamp": 1669143937,
            "hunks": 2,
            "message": "Sonar requires Java 11",
            "diff": [
                "diff --git a/.github/workflows/build.yml b/.github/workflows/build.yml",
                "index 8408077a..5d718c50 100644",
                "--- a/.github/workflows/build.yml",
                "+++ b/.github/workflows/build.yml",
                "@@ -15,6 +15,6 @@ jobs:",
                "                   fetch-depth: 0  # Shallow clones should be disabled for a better relevancy of analysis",
                "-            - name: Set up JDK 8",
                "+            - name: Set up JDK 11",
                "               uses: actions/setup-java@v1",
                "               with:",
                "-                  java-version: 8",
                "+                  java-version: 11",
                "             - name: Cache SonarCloud packages"
            ],
            "changed_files": [
                ".github/workflows/build.yml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [],
            "matched_rules": []
        },
        {
            "commit_id": "119c47b35ca29995c043cacaf9b8d654d5a414ea",
            "repository": "https://github.com/pippo-java/pippo",
            "timestamp": 1669314069,
            "hunks": 8,
            "message": "Improve sonar integration",
            "diff": [
                "diff --git a/.github/workflows/build.yml b/.github/workflows/build.yml",
                "index 5d718c50..39c7f195 100644",
                "--- a/.github/workflows/build.yml",
                "+++ b/.github/workflows/build.yml",
                "@@ -35,2 +35,2 @@ jobs:",
                "                   SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}",
                "-              run: cd pippo && mvn -B verify org.sonarsource.scanner.maven:sonar-maven-plugin:sonar",
                "+              run: cd pippo && mvn -B verify -Pcoverage,sonar",
                "diff --git a/pom.xml b/pom.xml",
                "index e3d93cac..c3867c1f 100644",
                "--- a/pom.xml",
                "+++ b/pom.xml",
                "@@ -56,8 +56,2 @@",
                "         <mockito.version>2.24.0</mockito.version>",
                "-        <cobertura.version>2.7</cobertura.version>",
                "-        <coveralls.version>3.1.0</coveralls.version>",
                "-",
                "-        <sonar.projectKey>pippo-java_pippo</sonar.projectKey>",
                "-        <sonar.organization>pippo-java</sonar.organization>",
                "-        <sonar.host.url>https://sonarcloud.io</sonar.host.url>",
                "     </properties>",
                "@@ -126,2 +120,8 @@",
                "             </plugin>",
                "+",
                "+            <plugin>",
                "+                <groupId>org.apache.maven.plugins</groupId>",
                "+                <artifactId>maven-surefire-plugin</artifactId>",
                "+                <version>2.22.2</version>",
                "+            </plugin>",
                "         </plugins>",
                "@@ -195,8 +195,5 @@",
                "         <profile>",
                "-            <id>travis</id>",
                "+            <id>coverage</id>",
                "             <activation>",
                "-                <property>",
                "-                    <name>env.TRAVIS</name>",
                "-                    <value>true</value>",
                "-                </property>",
                "+                <activeByDefault>true</activeByDefault>",
                "             </activation>",
                "@@ -205,15 +202,45 @@",
                "                     <plugin>",
                "-                        <groupId>org.codehaus.mojo</groupId>",
                "-                        <artifactId>cobertura-maven-plugin</artifactId>",
                "-                        <version>${cobertura.version}</version>",
                "-                        <configuration>",
                "-                            <formats>",
                "-                                <format>xml</format>",
                "-                            </formats>",
                "-                        </configuration>",
                "+                        <groupId>org.jacoco</groupId>",
                "+                        <artifactId>jacoco-maven-plugin</artifactId>",
                "+                        <version>0.8.5</version>",
                "+                        <executions>",
                "+                            <execution>",
                "+                                <id>prepare-agent</id>",
                "+                                <goals>",
                "+                                    <goal>prepare-agent</goal>",
                "+                                </goals>",
                "+                            </execution>",
                "+                        </executions>",
                "                     </plugin>",
                "+                </plugins>",
                "+            </build>",
                "+        </profile>",
                "+",
                "+        <profile>",
                "+            <id>sonar</id>",
                "+            <properties>",
                "+                <sonar.host.url>https://sonarcloud.io</sonar.host.url>",
                "+                <sonar.organization>pippo-java</sonar.organization>",
                "+                <sonar.projectKey>pippo-java_pippo</sonar.projectKey>",
                "+                <sonar.projectName>pippo</sonar.projectName>",
                "+                <sonar.moduleKey>${project.groupId}:${project.artifactId}</sonar.moduleKey>",
                "+            </properties>",
                "+            <activation>",
                "+                <activeByDefault>false</activeByDefault>",
                "+            </activation>",
                "+            <build>",
                "+                <plugins>",
                "                     <plugin>",
                "-                        <groupId>org.eluder.coveralls</groupId>",
                "-                        <artifactId>coveralls-maven-plugin</artifactId>",
                "-                        <version>${coveralls.version}</version>",
                "+                        <groupId>org.sonarsource.scanner.maven</groupId>",
                "+                        <artifactId>sonar-maven-plugin</artifactId>",
                "+                        <version>3.9.1.2184</version>",
                "+                        <executions>",
                "+                            <execution>",
                "+                                <id>sonar</id>",
                "+                                <phase>verify</phase>",
                "+                                <goals>",
                "+                                    <goal>sonar</goal>",
                "+                                </goals>",
                "+                            </execution>",
                "+                        </executions>",
                "                     </plugin>"
            ],
            "changed_files": [
                ".github/workflows/build.yml",
                "pom.xml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [],
            "matched_rules": []
        },
        {
            "commit_id": "065388b16b88308764a236cd826c898263d7b470",
            "repository": "https://github.com/pippo-java/pippo",
            "timestamp": 1669314764,
            "hunks": 1,
            "message": "Try to improve github actions",
            "diff": [
                "diff --git a/.github/workflows/build.yml b/.github/workflows/build.yml",
                "index 39c7f195..b0b145a4 100644",
                "--- a/.github/workflows/build.yml",
                "+++ b/.github/workflows/build.yml",
                "@@ -35,2 +35,2 @@ jobs:",
                "                   SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}",
                "-              run: cd pippo && mvn -B verify -Pcoverage,sonar",
                "+              run: mvn -B verify -Pcoverage,sonar"
            ],
            "changed_files": [
                ".github/workflows/build.yml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [],
            "matched_rules": []
        }
    ]
}
