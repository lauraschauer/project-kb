{
    "advisory_record": {
        "cve_id": "CVE-2018-10366",
        "description": "An issue was discovered in the Users (aka Front-end user management) plugin 1.4.5 for October CMS. XSS exists in the name field.",
        "reserved_timestamp": 1524614400,
        "published_timestamp": 1524646800,
        "updated_timestamp": 1524909421,
        "repository_url": null,
        "references": {
            "https://www.exploit-db.com/exploits/44546/": 2,
            "commit::098c2bc907443d67e9e18645f850e3de42941d20": 2
        },
        "affected_products": [
            "Users",
            "October",
            "CMS",
            "n/a",
            "XSS"
        ],
        "versions": {
            "status": "affected",
            "version": "n/a"
        },
        "files": [
            "XSS",
            "Front-end",
            "CMS"
        ],
        "keywords": [
            "exist",
            "management",
            "name",
            "issue",
            "plugin",
            "discover",
            "users",
            "october",
            "field",
            "user"
        ],
        "files_extension": [],
        "has_fixing_commit": true
    },
    "commits": [
        {
            "commit_id": "098c2bc907443d67e9e18645f850e3de42941d20",
            "repository": "https://github.com/rainlab/user-plugin",
            "timestamp": 1522814168,
            "hunks": 5,
            "message": "KISS and form_value() doesn't use escaping",
            "diff": [
                "diff --git a/components/account/update.htm b/components/account/update.htm",
                "index a294dd0..7d980da 100644",
                "--- a/components/account/update.htm",
                "+++ b/components/account/update.htm",
                "@@ -1,2 +1,2 @@",
                "-{{ form_ajax('onUpdate', { model: user }) }}",
                "+{{ form_ajax('onUpdate') }}",
                "@@ -4,3 +4,3 @@",
                "         <label for=\"accountName\">Full Name</label>",
                "-        <input name=\"name\" type=\"text\" class=\"form-control\" id=\"accountName\" value=\"{{ form_value('name') }}\">",
                "+        <input name=\"name\" type=\"text\" class=\"form-control\" id=\"accountName\" value=\"{{ user.name }}\">",
                "     </div>",
                "@@ -9,3 +9,3 @@",
                "         <label for=\"accountEmail\">Email</label>",
                "-        <input name=\"email\" type=\"email\" class=\"form-control\" id=\"accountEmail\" value=\"{{ form_value('email') }}\">",
                "+        <input name=\"email\" type=\"email\" class=\"form-control\" id=\"accountEmail\" value=\"{{ user.email }}\">",
                "     </div>",
                "@@ -24,2 +24,2 @@",
                "-{{ form_close() }}",
                "\\ No newline at end of file",
                "+{{ form_close() }}"
            ],
            "changed_files": [
                "components/account/update.htm"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "v1.5.0",
                "v1.5.1",
                "v1.5.2",
                "v1.5.3",
                "v1.5.4",
                "v1.6.0",
                "v1.6.1",
                "v1.6.2",
                "v1.6.3",
                "v1.6.4",
                "v1.7.0",
                "v1.7.1",
                "v1.7.2",
                "v2.0.0",
                "v2.1.0",
                "v3.0.0",
                "v3.0.1",
                "v3.0.2",
                "v3.0.3",
                "v3.0.4",
                "v3.0.5",
                "v3.0.6",
                "v3.0.7",
                "v3.1.0"
            ],
            "matched_rules": [
                {
                    "id": "COMMIT_IN_REFERENCE",
                    "message": "This commit is mentioned 2 times in the references.",
                    "relevance": 64
                }
            ]
        },
        {
            "commit_id": "582c3a80bf8e298de2a5affd7eeb14e9d47a8373",
            "repository": "https://github.com/rainlab/user-plugin",
            "timestamp": 1523388523,
            "hunks": 1,
            "message": "Bind `rainlab.user.register` event in Plugin.php (#327) Credit to @voveson, correcting missing line from change to using Notify plugin",
            "diff": [
                "diff --git a/Plugin.php b/Plugin.php",
                "index 011dc6d..3cbf003 100644",
                "--- a/Plugin.php",
                "+++ b/Plugin.php",
                "@@ -167,3 +167,4 @@ class Plugin extends PluginBase",
                "         Notifier::bindEvents([",
                "-            'rainlab.user.activate' => \\RainLab\\User\\NotifyRules\\UserActivatedEvent::class",
                "+            'rainlab.user.activate' => \\RainLab\\User\\NotifyRules\\UserActivatedEvent::class,",
                "+            'rainlab.user.register' => \\RainLab\\User\\NotifyRules\\UserRegisteredEvent::class",
                "         ]);"
            ],
            "changed_files": [
                "Plugin.php"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "327": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "v1.5.0",
                "v1.5.1",
                "v1.5.2",
                "v1.5.3",
                "v1.5.4",
                "v1.6.0",
                "v1.6.1",
                "v1.6.2",
                "v1.6.3",
                "v1.6.4",
                "v1.7.0",
                "v1.7.1",
                "v1.7.2",
                "v2.0.0",
                "v2.1.0",
                "v3.0.0",
                "v3.0.1",
                "v3.0.2",
                "v3.0.3",
                "v3.0.4",
                "v3.0.5",
                "v3.0.6",
                "v3.0.7",
                "v3.1.0"
            ],
            "matched_rules": [
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 327",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "2ef30299e22810da42b0cae824a5a63474c39b99",
            "repository": "https://github.com/rainlab/user-plugin",
            "timestamp": 1522622707,
            "hunks": 5,
            "message": "Separate the url.intended session variable between backend and frontend sessions (#325) Fixes #258. Credit to @mjauvin",
            "diff": [
                "diff --git a/Plugin.php b/Plugin.php",
                "index cff8483..011dc6d 100644",
                "--- a/Plugin.php",
                "+++ b/Plugin.php",
                "@@ -9,2 +9,3 @@ use System\\Classes\\SettingsManager;",
                " use Illuminate\\Foundation\\AliasLoader;",
                "+use RainLab\\User\\Classes\\UserRedirector;",
                " use RainLab\\User\\Models\\MailBlocker;",
                "@@ -39,2 +40,17 @@ class Plugin extends PluginBase",
                "+        App::singleton('redirect', function ($app) {",
                "+            // overrides with our own extended version of Redirector to support ",
                "+            // seperate url.intended session variable for frontend",
                "+            $redirector = new UserRedirector($app['url']);",
                "+",
                "+            // If the session is set on the application instance, we'll inject it into",
                "+            // the redirector instance. This allows the redirect responses to allow",
                "+            // for the quite convenient \"with\" methods that flash to the session.",
                "+            if (isset($app['session.store'])) {",
                "+                $redirector->setSession($app['session.store']);",
                "+            }",
                "+",
                "+            return $redirector;",
                "+        });",
                "+",
                "         /*",
                "diff --git a/classes/UserRedirector.php b/classes/UserRedirector.php",
                "new file mode 100644",
                "index 0000000..58f230f",
                "--- /dev/null",
                "+++ b/classes/UserRedirector.php",
                "@@ -0,0 +1,41 @@",
                "+<?php namespace RainLab\\User\\Classes;",
                "+",
                "+use App;",
                "+use Illuminate\\Routing\\Redirector;",
                "+",
                "+class UserRedirector extends Redirector",
                "+{",
                "+    /**",
                "+     * Create a new redirect response, while putting the current URL in the session.",
                "+     *",
                "+     * @param  string  $path",
                "+     * @param  int     $status",
                "+     * @param  array   $headers",
                "+     * @param  bool    $secure",
                "+     * @return \\Illuminate\\Http\\RedirectResponse",
                "+     */",
                "+    public function guest($path, $status = 302, $headers = [], $secure = null)",
                "+    {",
                "+        $sessionKey = App::runningInBackend() ? 'url.intended' : 'url.frontend.intended';",
                "+        $this->session->put($sessionKey, $this->generator->full());",
                "+",
                "+        return $this->to($path, $status, $headers, $secure);",
                "+    }",
                "+",
                "+    /**",
                "+     * Create a new redirect response to the previously intended location.",
                "+     *",
                "+     * @param  string  $default",
                "+     * @param  int     $status",
                "+     * @param  array   $headers",
                "+     * @param  bool    $secure",
                "+     * @return \\Illuminate\\Http\\RedirectResponse",
                "+     */",
                "+    public function intended($default = '/', $status = 302, $headers = [], $secure = null)",
                "+    {",
                "+        $sessionKey = App::runningInBackend() ? 'url.intended' : 'url.frontend.intended';",
                "+        $path = $this->session->pull($sessionKey, $default);",
                "+",
                "+        return $this->to($path, $status, $headers, $secure);",
                "+    }",
                "+}",
                "diff --git a/components/Account.php b/components/Account.php",
                "index e1dfc62..fb8f897 100644",
                "--- a/components/Account.php",
                "+++ b/components/Account.php",
                "@@ -279,9 +279,5 @@ class Account extends ComponentBase",
                "              */",
                "-            $redirectUrl = $this->pageUrl($this->property('redirect'))",
                "-                ?: $this->property('redirect');",
                "-",
                "-            if ($redirectUrl = post('redirect', $redirectUrl)) {",
                "-                return Redirect::intended($redirectUrl);",
                "+            if ($redirect = $this->makeRedirection(true)) {",
                "+                return $redirect;",
                "             }",
                "-",
                "         }"
            ],
            "changed_files": [
                "Plugin.php",
                "classes/UserRedirector.php",
                "components/Account.php"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "325": "Backend login redirects to front end login #258",
                "258": "Session redirect does not works #273 Log in backend redirect to the login of my application #274 Seperate session variable for frontend user session #324 seperate url.intended session variable for frontend #325 Redirect back to requested url after login #290"
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "v1.5.0",
                "v1.5.1",
                "v1.5.2",
                "v1.5.3",
                "v1.5.4",
                "v1.6.0",
                "v1.6.1",
                "v1.6.2",
                "v1.6.3",
                "v1.6.4",
                "v1.7.0",
                "v1.7.1",
                "v1.7.2",
                "v2.0.0",
                "v2.1.0",
                "v3.0.0",
                "v3.0.1",
                "v3.0.2",
                "v3.0.3",
                "v3.0.4",
                "v3.0.5",
                "v3.0.6",
                "v3.0.7",
                "v3.1.0"
            ],
            "matched_rules": [
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 325, 258",
                    "relevance": 2
                }
            ]
        }
    ]
}
