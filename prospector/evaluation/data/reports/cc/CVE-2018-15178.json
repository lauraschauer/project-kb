{
    "advisory_record": {
        "cve_id": "CVE-2018-15178",
        "description": "Open redirect vulnerability in Gogs before 0.12 allows remote attackers to redirect users to arbitrary websites and conduct phishing attacks via an initial /\\ substring in the user/login redirect_to parameter, related to the function isValidRedirect in routes/user/auth.go.",
        "reserved_timestamp": 1533600000,
        "published_timestamp": 1533686400,
        "updated_timestamp": 1533689821,
        "repository_url": null,
        "references": {
            "": 148,
            "https://github.com/gogs/gogs/issues/5364": 5,
            "commit::1f247cf8139cb483276cd8dd06385a800ce9d4b2": 5,
            "https://github.com/gogs/gogs/pull/5365": 4,
            "https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax": 4,
            "https://github.com/features/actions": 2,
            "https://github.com/features/packages": 2,
            "https://github.com/features/security": 2,
            "https://github.com/features/codespaces": 2,
            "https://github.com/features/copilot": 2,
            "https://github.com/features/code-review": 2,
            "https://github.com/features/issues": 2,
            "https://github.com/features/discussions": 2,
            "https://github.com/features": 2,
            "https://docs.github.com": 2,
            "https://skills.github.com": 2,
            "https://github.blog": 2,
            "https://github.com/enterprise": 2,
            "https://github.com/team": 2,
            "https://github.com/enterprise/startups": 2,
            "https://github.com/solutions/industries/healthcare": 2,
            "https://github.com/solutions/industries/financial-services": 2,
            "https://github.com/solutions/industries/manufacturing": 2,
            "https://github.com/solutions/ci-cd": 2,
            "https://github.com/solutions/devops": 2,
            "https://github.com/solutions/devsecops": 2,
            "https://resources.github.com/learn/pathways": 2,
            "https://resources.github.com": 2,
            "https://github.com/customer-stories": 2,
            "https://partner.github.com": 2,
            "https://github.com/readme": 2,
            "https://github.com/topics": 2,
            "https://github.com/trending": 2,
            "https://github.com/collections": 2,
            "https://github.com/enterprise/advanced-security": 2,
            "https://github.com/pricing": 2,
            "https://docs.github.com/terms": 2,
            "https://docs.github.com/privacy": 2,
            "https://github.com": 2,
            "https://docs.github.com/site-policy/github-terms/github-terms-of-service": 2,
            "https://docs.github.com/site-policy/privacy-policies/github-privacy-statement": 2,
            "https://github.com/security": 2,
            "https://www.githubstatus.com/": 2,
            "https://docs.github.com/": 2,
            "https://support.github.com?tags=dotcom-footer": 2,
            "commit::8cf5fa60da6cf81b990650f141777209a383284c": 2,
            "commit::499bff43d935f1334a76b86fe3a44a5a670479ef": 2,
            "https://try.gogs.io": 1,
            "https://try.gogs.io/user/login?redirect_to=%2F%5Cexample.com": 1,
            "https://camo.githubusercontent.com/65b5a895252cd893b4490f4738f4c27d46dc747b3415a5791ac9b4f2e64c0f92/68747470733a2f2f692e696d6775722e636f6d2f64716b777178722e676966": 1,
            "https://github.co/hiddenchars": 1,
            "https://github.com/gogs/gogs/pull/5365#event-1772378649": 1
        },
        "affected_products": [
            "n/a",
            "Gogs"
        ],
        "versions": {
            "status": "affected",
            "version": "n/a"
        },
        "files": [
            "redirect_to",
            "auth",
            "isValidRedirect"
        ],
        "keywords": [
            "function",
            "phishe",
            "route",
            "gogs",
            "isvalidredirect",
            "attacker",
            "conduct",
            "parameter",
            "login",
            "substre",
            "open",
            "redirect",
            "website",
            "vulnerability",
            "allow",
            "attack",
            "relate",
            "user"
        ],
        "files_extension": [
            "go"
        ],
        "has_fixing_commit": true
    },
    "commits": [
        {
            "commit_id": "1f247cf8139cb483276cd8dd06385a800ce9d4b2",
            "repository": "https://github.com/gogs/gogs",
            "timestamp": 1533546616,
            "hunks": 2,
            "message": "routes: fix open redirect vulnerability #5364 (#5365)",
            "diff": [
                "diff --git a/routes/user/auth.go b/routes/user/auth.go",
                "index 16e8bd2d..76e51c36 100644",
                "--- a/routes/user/auth.go",
                "+++ b/routes/user/auth.go",
                "@@ -75,6 +75,6 @@ func AutoLogin(c *context.Context) (bool, error) {",
                " // isValidRedirect returns false if the URL does not redirect to same site.",
                "-// False: //url, http://url",
                "+// False: //url, http://url, /\\url",
                " // True: /url",
                " func isValidRedirect(url string) bool {",
                "-\treturn len(url) >= 2 && url[0] == '/' && url[1] != '/'",
                "+\treturn len(url) >= 2 && url[0] == '/' && url[1] != '/' && url[1] != '\\\\'",
                " }"
            ],
            "changed_files": [
                "routes/user/auth.go"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "5364": "Fix open redirect vulnerability #5364 #5365",
                "5365": "Insecure function isValidRedirect leads to open redirect vulnerability #5364"
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "v0.11.66",
                "v0.11.79",
                "v0.11.86",
                "v0.11.91",
                "v0.12.0",
                "v0.12.1",
                "v0.12.10",
                "v0.12.10-rc.1",
                "v0.12.11",
                "v0.12.11-rc.1",
                "v0.12.2",
                "v0.12.3",
                "v0.12.4",
                "v0.12.4-rc.1",
                "v0.12.5",
                "v0.12.5-rc.1",
                "v0.12.6",
                "v0.12.6-rc.1",
                "v0.12.7",
                "v0.12.7-rc.1",
                "v0.12.8",
                "v0.12.8-rc.1",
                "v0.12.9",
                "v0.12.9-rc.1",
                "v0.13.0",
                "v0.13.0-rc.1"
            ],
            "matched_rules": [
                {
                    "id": "XREF_GH",
                    "message": "The commit and the advisory (including referenced pages) mention the same github issue: 5364, 5365",
                    "relevance": 32
                },
                {
                    "id": "COMMIT_IN_REFERENCE",
                    "message": "This commit is mentioned 5 times in the references.",
                    "relevance": 64
                },
                {
                    "id": "CHANGES_RELEVANT_CODE",
                    "message": "The commit modifies code containing relevant filename or methods: isValidRedirect",
                    "relevance": 8
                },
                {
                    "id": "CHANGES_RELEVANT_FILES",
                    "message": "The commit changes some relevant files: routes/user/auth.go",
                    "relevance": 8
                },
                {
                    "id": "SEC_KEYWORDS_IN_LINKED_GH",
                    "message": "The github issue 5364 contains some security-related terms: vulnerability",
                    "relevance": 4
                },
                {
                    "id": "SEC_KEYWORDS_IN_MESSAGE",
                    "message": "The commit message contains some security-related keywords: vulnerability",
                    "relevance": 4
                },
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: route, redirect, vulnerability, open",
                    "relevance": 4
                },
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: route, user",
                    "relevance": 4
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 5364, 5365",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "4c1a479a60c0cebd7715f6e79d48471b91b28671",
            "repository": "https://github.com/gogs/gogs",
            "timestamp": 1534255844,
            "hunks": 4,
            "message": "models: fix delete public keys ORM syntax (#5376)",
            "diff": [
                "diff --git a/gogs.go b/gogs.go",
                "index fc2292b1..a8386ab5 100644",
                "--- a/gogs.go",
                "+++ b/gogs.go",
                "@@ -18,3 +18,3 @@ import (",
                "-const APP_VER = \"0.11.59.0627\"",
                "+const APP_VER = \"0.11.60.0814\"",
                "diff --git a/models/ssh_key.go b/models/ssh_key.go",
                "index 3a8d205f..3d99f207 100644",
                "--- a/models/ssh_key.go",
                "+++ b/models/ssh_key.go",
                "@@ -27,3 +27,2 @@ import (",
                " \t\"github.com/gogs/gogs/pkg/setting\"",
                "-\t\"github.com/gogs/gogs/pkg/tool\"",
                " )",
                "@@ -481,3 +480,3 @@ func deletePublicKeys(e *xorm.Session, keyIDs ...int64) error {",
                "-\t_, err := e.In(\"id\", strings.Join(tool.Int64sToStrings(keyIDs), \",\")).Delete(new(PublicKey))",
                "+\t_, err := e.In(\"id\", keyIDs).Delete(new(PublicKey))",
                " \treturn err",
                "diff --git a/templates/.VERSION b/templates/.VERSION",
                "index 7906efe7..94168071 100644",
                "--- a/templates/.VERSION",
                "+++ b/templates/.VERSION",
                "@@ -1 +1 @@",
                "-0.11.59.0627",
                "+0.11.60.0814"
            ],
            "changed_files": [
                "gogs.go",
                "models/ssh_key.go",
                "templates/.VERSION"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "5376": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "v0.11.66",
                "v0.11.79",
                "v0.11.86",
                "v0.11.91",
                "v0.12.0",
                "v0.12.1",
                "v0.12.10",
                "v0.12.10-rc.1",
                "v0.12.11",
                "v0.12.11-rc.1",
                "v0.12.2",
                "v0.12.3",
                "v0.12.4",
                "v0.12.4-rc.1",
                "v0.12.5",
                "v0.12.5-rc.1",
                "v0.12.6",
                "v0.12.6-rc.1",
                "v0.12.7",
                "v0.12.7-rc.1",
                "v0.12.8",
                "v0.12.8-rc.1",
                "v0.12.9",
                "v0.12.9-rc.1",
                "v0.13.0",
                "v0.13.0-rc.1"
            ],
            "matched_rules": [
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 5376",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "cc95d251d62903d6e96d9cf9c6ce426bec26556f",
            "repository": "https://github.com/gogs/gogs",
            "timestamp": 1534164625,
            "hunks": 7,
            "message": "docker: add new Dockerfile.docker-ce for docker-ce(>=v17.06) to build docker image (#5322) * add new Dockerfile.docker-ce for docker-ce(>=v17.06) to  build docker image * change default Dockerfile to support docker-ce(>=v17.06) multi-stage build",
            "diff": [
                "diff --git a/.dockerignore b/.dockerignore",
                "index d2b3db5a..823e8dd9 100644",
                "--- a/.dockerignore",
                "+++ b/.dockerignore",
                "@@ -1,3 +1 @@",
                "-.git",
                "-.git/**",
                " packager",
                "diff --git a/Dockerfile b/Dockerfile",
                "index 035b59a4..b946fa7f 100644",
                "--- a/Dockerfile",
                "+++ b/Dockerfile",
                "@@ -1,5 +1,11 @@",
                "-FROM alpine:3.5",
                "+FROM golang:alpine AS binarybuilder",
                "+#\u00c2\u00a0Install build deps",
                "+RUN apk --no-cache --no-progress add --virtual build-deps build-base git linux-pam-dev",
                "+WORKDIR /go/src/github.com/gogs/gogs",
                "+COPY . .",
                "+RUN make build TAGS=\"sqlite cert pam\"",
                "+FROM alpine:latest",
                " #\u00c2\u00a0Install system utils & Gogs runtime dependencies",
                "-ADD https://github.com/tianon/gosu/releases/download/1.9/gosu-amd64 /usr/sbin/gosu",
                "+ADD https://github.com/tianon/gosu/releases/download/1.10/gosu-amd64 /usr/sbin/gosu",
                " RUN chmod +x /usr/sbin/gosu \\",
                "@@ -22,12 +28,10 @@ ENV GOGS_CUSTOM /data/gogs",
                " COPY docker/nsswitch.conf /etc/nsswitch.conf",
                "-COPY docker /app/gogs/docker",
                "-COPY templates /app/gogs/templates",
                "-COPY public /app/gogs/public",
                "-WORKDIR /app/gogs/build",
                "-COPY . .",
                "+WORKDIR /app/gogs",
                "+COPY docker ./docker",
                "+COPY templates ./templates",
                "+COPY public ./public",
                "+COPY --from=binarybuilder /go/src/github.com/gogs/gogs/gogs .",
                "-RUN    ./docker/build-go.sh \\",
                "-    && ./docker/build.sh \\",
                "-    && ./docker/finalize.sh",
                "+RUN ./docker/finalize.sh",
                "diff --git a/docker/build.sh b/docker/build.sh",
                "index 46da4fdd..ebcdb89c 100755",
                "--- a/docker/build.sh",
                "+++ b/docker/build.sh",
                "@@ -25,5 +25,7 @@ apk --no-progress del build-deps",
                "-# Create git user for Gogs",
                "-addgroup -S git",
                "-adduser -G git -H -D -g 'Gogs Git User' git -h /data/git -s /bin/bash && usermod -p '*' git && passwd -u git",
                "-echo \"export GOGS_CUSTOM=${GOGS_CUSTOM}\" >> /etc/profile",
                "+# Move to final place",
                "+mv /app/gogs/build/gogs /app/gogs/",
                "+",
                "+# Cleanup go",
                "+rm -rf /tmp/go",
                "+rm -rf /usr/local/go",
                "diff --git a/docker/finalize.sh b/docker/finalize.sh",
                "index 9adc506a..5880aae3 100755",
                "--- a/docker/finalize.sh",
                "+++ b/docker/finalize.sh",
                "@@ -6,4 +6,6 @@ set -e",
                "-# Move to final place",
                "-mv /app/gogs/build/gogs /app/gogs/",
                "+# Create git user for Gogs",
                "+addgroup -S git",
                "+adduser -G git -H -D -g 'Gogs Git User' git -h /data/git -s /bin/bash && usermod -p '*' git && passwd -u git",
                "+echo \"export GOGS_CUSTOM=${GOGS_CUSTOM}\" >> /etc/profile",
                "@@ -16,4 +18 @@ rm /app/gogs/docker/nsswitch.conf",
                " rm /app/gogs/docker/README.md",
                "-",
                "-rm -rf /tmp/go",
                "-rm -rf /usr/local/go"
            ],
            "changed_files": [
                ".dockerignore",
                "Dockerfile",
                "docker/build.sh",
                "docker/finalize.sh"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "5322": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "v0.11.66",
                "v0.11.79",
                "v0.11.86",
                "v0.11.91",
                "v0.12.0",
                "v0.12.1",
                "v0.12.10",
                "v0.12.10-rc.1",
                "v0.12.11",
                "v0.12.11-rc.1",
                "v0.12.2",
                "v0.12.3",
                "v0.12.4",
                "v0.12.4-rc.1",
                "v0.12.5",
                "v0.12.5-rc.1",
                "v0.12.6",
                "v0.12.6-rc.1",
                "v0.12.7",
                "v0.12.7-rc.1",
                "v0.12.8",
                "v0.12.8-rc.1",
                "v0.12.9",
                "v0.12.9-rc.1",
                "v0.13.0",
                "v0.13.0-rc.1"
            ],
            "matched_rules": [
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 5322",
                    "relevance": 2
                }
            ]
        }
    ]
}
