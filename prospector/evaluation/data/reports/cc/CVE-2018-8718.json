{
    "advisory_record": {
        "cve_id": "CVE-2018-8718",
        "description": "Cross-site request forgery (CSRF) vulnerability in the Mailer Plugin 1.20 for Jenkins 2.111 allows remote authenticated users to send unauthorized mail as an arbitrary user via a /descriptorByName/hudson.tasks.Mailer/sendTestMail request.",
        "reserved_timestamp": 1520985600,
        "published_timestamp": 1522166400,
        "updated_timestamp": 1528365421,
        "repository_url": null,
        "references": {
            "https://jenkins.io/security/advisory/2018-03-26/": 4,
            "http://www.openwall.com/lists/oss-security/2018/03/26/3": 2,
            "https://www.exploit-db.com/exploits/44843/": 2,
            "http://www.securityfocus.com/bid/103691": 2,
            "commit::98e79cf904769907f83894e29f50ed6b3e7eb135": 2,
            "": 2
        },
        "affected_products": [
            "CSRF",
            "Mailer",
            "n/a",
            "Jenkins",
            "Plugin"
        ],
        "versions": {
            "status": "affected",
            "version": "n/a"
        },
        "files": [
            "CSRF",
            "sendTestMail",
            "Cross-site"
        ],
        "keywords": [
            "authenticate",
            "mailer",
            "jenkins",
            "plugin",
            "mail",
            "sendtestmail",
            "csrf",
            "allow",
            "vulnerability",
            "request",
            "send",
            "forgery",
            "user"
        ],
        "files_extension": [],
        "has_fixing_commit": true
    },
    "commits": [
        {
            "commit_id": "98e79cf904769907f83894e29f50ed6b3e7eb135",
            "repository": "https://github.com/jenkinsci/mailer-plugin",
            "timestamp": 1521295418,
            "hunks": 3,
            "message": "[SECURITY-774] Only allow admins to send test email",
            "diff": [
                "diff --git a/src/main/java/hudson/tasks/Mailer.java b/src/main/java/hudson/tasks/Mailer.java",
                "index bb789fe..9a663f0 100644",
                "--- a/src/main/java/hudson/tasks/Mailer.java",
                "+++ b/src/main/java/hudson/tasks/Mailer.java",
                "@@ -88,2 +88,3 @@ import net.sf.json.JSONObject;",
                " import org.kohsuke.accmod.restrictions.DoNotUse;",
                "+import org.kohsuke.stapler.interceptor.RequirePOST;",
                "@@ -553,2 +554,3 @@ public class Mailer extends Notifier implements SimpleBuildStep {",
                "          */",
                "+        @RequirePOST",
                "         public FormValidation doSendTestMail(",
                "@@ -564,2 +566,4 @@ public class Mailer extends Notifier implements SimpleBuildStep {",
                "                 }",
                "+",
                "+                jenkins.checkPermission(Jenkins.ADMINISTER);"
            ],
            "changed_files": [
                "src/main/java/hudson/tasks/Mailer.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "391.ve4a_38c1b_cf4b_",
                "408.vd726a_1130320",
                "414.vcc4c33714601",
                "435.438.v5b_81173f5b_a_1",
                "435.v79ef3972b_5c7",
                "438.v02c7f0a_12fa_4",
                "448.v5b_97805e3767",
                "457.v3f72cb_e015e5",
                "463.vedf8358e006b_",
                "470.vc91f60c5d8e2",
                "472.vf7c289a_4b_420",
                "mailer-1.21",
                "mailer-1.22",
                "mailer-1.23",
                "mailer-1.23-beta-1",
                "mailer-1.23-beta-2",
                "mailer-1.24",
                "mailer-1.25",
                "mailer-1.26",
                "mailer-1.27",
                "mailer-1.28",
                "mailer-1.29",
                "mailer-1.29.1",
                "mailer-1.30",
                "mailer-1.31",
                "mailer-1.31.1",
                "mailer-1.32",
                "mailer-1.32.1",
                "mailer-1.33",
                "mailer-1.34",
                "mailer-1.34.2"
            ],
            "matched_rules": [
                {
                    "id": "COMMIT_IN_REFERENCE",
                    "message": "This commit is mentioned 2 times in the references.",
                    "relevance": 64
                },
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: allow, send",
                    "relevance": 4
                }
            ]
        },
        {
            "commit_id": "a1328409c9ab3723247d1986a6c7b1d96f626dd7",
            "repository": "https://github.com/jenkinsci/mailer-plugin",
            "timestamp": 1521295438,
            "hunks": 2,
            "message": "Item.CONFIGURE check doesn't really make sense on Jenkins",
            "diff": [
                "diff --git a/src/main/java/hudson/cli/MailCommand.java b/src/main/java/hudson/cli/MailCommand.java",
                "index 04722ca..dd8ddef 100644",
                "--- a/src/main/java/hudson/cli/MailCommand.java",
                "+++ b/src/main/java/hudson/cli/MailCommand.java",
                "@@ -50,9 +50,8 @@ public class MailCommand extends CLICommand {",
                "         Jenkins jenkins = Jenkins.getInstance();",
                "-        if (jenkins != null) {",
                "-            jenkins.checkPermission(Item.CONFIGURE);",
                "-            Transport.send(new MimeMessage(Mailer.descriptor().createSession(),stdin));",
                "-            return 0;",
                "-        } else {",
                "+        if (jenkins == null) {",
                "             throw new IllegalStateException(\"Jenkins is not active.\");",
                "         }",
                "+        jenkins.checkPermission(Jenkins.ADMINISTER);",
                "+        Transport.send(new MimeMessage(Mailer.descriptor().createSession(),stdin));",
                "+        return 0;",
                "     }"
            ],
            "changed_files": [
                "src/main/java/hudson/cli/MailCommand.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "391.ve4a_38c1b_cf4b_",
                "408.vd726a_1130320",
                "414.vcc4c33714601",
                "435.438.v5b_81173f5b_a_1",
                "435.v79ef3972b_5c7",
                "438.v02c7f0a_12fa_4",
                "448.v5b_97805e3767",
                "457.v3f72cb_e015e5",
                "463.vedf8358e006b_",
                "470.vc91f60c5d8e2",
                "472.vf7c289a_4b_420",
                "mailer-1.21",
                "mailer-1.22",
                "mailer-1.23",
                "mailer-1.23-beta-1",
                "mailer-1.23-beta-2",
                "mailer-1.24",
                "mailer-1.25",
                "mailer-1.26",
                "mailer-1.27",
                "mailer-1.28",
                "mailer-1.29",
                "mailer-1.29.1",
                "mailer-1.30",
                "mailer-1.31",
                "mailer-1.31.1",
                "mailer-1.32",
                "mailer-1.32.1",
                "mailer-1.33",
                "mailer-1.34",
                "mailer-1.34.2"
            ],
            "matched_rules": []
        },
        {
            "commit_id": "5aaf6af6da7ae6c30a6b41435eddd2219685a54b",
            "repository": "https://github.com/jenkinsci/mailer-plugin",
            "timestamp": 1521482483,
            "hunks": 2,
            "message": "[maven-release-plugin] prepare for next development iteration",
            "diff": [
                "diff --git a/pom.xml b/pom.xml",
                "index 1fcf913..42b63c5 100644",
                "--- a/pom.xml",
                "+++ b/pom.xml",
                "@@ -11,3 +11,3 @@",
                "   <packaging>hpi</packaging>",
                "-  <version>1.21</version>",
                "+  <version>1.22-SNAPSHOT</version>",
                "   <name>Jenkins Mailer Plugin</name>",
                "@@ -104,3 +104,3 @@",
                "     <developerConnection>scm:git:git@github.com:jenkinsci/${project.artifactId}-plugin.git</developerConnection>",
                "-    <tag>mailer-1.21</tag>",
                "+    <tag>HEAD</tag>",
                "   </scm>"
            ],
            "changed_files": [
                "pom.xml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "391.ve4a_38c1b_cf4b_",
                "408.vd726a_1130320",
                "414.vcc4c33714601",
                "435.438.v5b_81173f5b_a_1",
                "435.v79ef3972b_5c7",
                "438.v02c7f0a_12fa_4",
                "448.v5b_97805e3767",
                "457.v3f72cb_e015e5",
                "463.vedf8358e006b_",
                "470.vc91f60c5d8e2",
                "472.vf7c289a_4b_420",
                "mailer-1.22",
                "mailer-1.23",
                "mailer-1.23-beta-1",
                "mailer-1.23-beta-2",
                "mailer-1.24",
                "mailer-1.25",
                "mailer-1.26",
                "mailer-1.27",
                "mailer-1.28",
                "mailer-1.29",
                "mailer-1.29.1",
                "mailer-1.30",
                "mailer-1.31",
                "mailer-1.31.1",
                "mailer-1.32",
                "mailer-1.32.1",
                "mailer-1.33",
                "mailer-1.34",
                "mailer-1.34.2"
            ],
            "matched_rules": []
        },
        {
            "commit_id": "147d6dfc4c88e06d01608e27087cf12a110b0484",
            "repository": "https://github.com/jenkinsci/mailer-plugin",
            "timestamp": 1521482483,
            "hunks": 2,
            "message": "[maven-release-plugin] prepare release mailer-1.21",
            "diff": [
                "diff --git a/pom.xml b/pom.xml",
                "index e6ba165..1fcf913 100644",
                "--- a/pom.xml",
                "+++ b/pom.xml",
                "@@ -11,3 +11,3 @@",
                "   <packaging>hpi</packaging>",
                "-  <version>1.21-SNAPSHOT</version>",
                "+  <version>1.21</version>",
                "   <name>Jenkins Mailer Plugin</name>",
                "@@ -104,3 +104,3 @@",
                "     <developerConnection>scm:git:git@github.com:jenkinsci/${project.artifactId}-plugin.git</developerConnection>",
                "-    <tag>HEAD</tag>",
                "+    <tag>mailer-1.21</tag>",
                "   </scm>"
            ],
            "changed_files": [
                "pom.xml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "391.ve4a_38c1b_cf4b_",
                "408.vd726a_1130320",
                "414.vcc4c33714601",
                "435.438.v5b_81173f5b_a_1",
                "435.v79ef3972b_5c7",
                "438.v02c7f0a_12fa_4",
                "448.v5b_97805e3767",
                "457.v3f72cb_e015e5",
                "463.vedf8358e006b_",
                "470.vc91f60c5d8e2",
                "472.vf7c289a_4b_420",
                "mailer-1.21",
                "mailer-1.22",
                "mailer-1.23",
                "mailer-1.23-beta-1",
                "mailer-1.23-beta-2",
                "mailer-1.24",
                "mailer-1.25",
                "mailer-1.26",
                "mailer-1.27",
                "mailer-1.28",
                "mailer-1.29",
                "mailer-1.29.1",
                "mailer-1.30",
                "mailer-1.31",
                "mailer-1.31.1",
                "mailer-1.32",
                "mailer-1.32.1",
                "mailer-1.33",
                "mailer-1.34",
                "mailer-1.34.2"
            ],
            "matched_rules": []
        }
    ]
}
