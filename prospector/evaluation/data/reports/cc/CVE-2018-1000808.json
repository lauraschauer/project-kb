{
    "advisory_record": {
        "cve_id": "CVE-2018-1000808",
        "description": "Python Cryptographic Authority pyopenssl version Before 17.5.0 contains a CWE - 401 : Failure to Release Memory Before Removing Last Reference vulnerability in PKCS #12 Store that can result in Denial of service if memory runs low or is exhausted. This attack appear to be exploitable via Depends upon calling application, however it could be as simple as initiating a TLS connection. Anything that would cause the calling application to reload certificates from a PKCS #12 store.. This vulnerability appears to have been fixed in 17.5.0.",
        "reserved_timestamp": 1537401600,
        "published_timestamp": 1539010800,
        "updated_timestamp": 1554224770,
        "repository_url": null,
        "references": {
            "": 186,
            "https://github.com/pyca/pyopenssl/pull/723": 6,
            "https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment": 5,
            "https://access.redhat.com/support/": 5,
            "https://access.redhat.com/errata/RHSA-2019:0085": 4,
            "https://codecov.io/gh/pyca/pyopenssl/pull/723?src=pr&el=tree": 4,
            "https://access.redhat.com/downloads/": 4,
            "commit::e73818600065821d588af475b024f4eb518c3509": 3,
            "commit::915d1d82c0fed8c656d1104b71728c1cf9747ede": 3,
            "https://github.com/fusionapp/fusion-index/pull/39": 3,
            "https://access.redhat.com/errata/": 3,
            "https://access.redhat.com/labs/": 3,
            "https://usn.ubuntu.com/3813-1/": 2,
            "http://lists.opensuse.org/opensuse-security-announce/2019-04/msg00014.html": 2,
            "https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax": 2,
            "https://codecov.io/gh/pyca/pyopenssl/pull/723?src=pr&el=h1": 2,
            "https://codecov.io/gh/pyca/pyopenssl/pull/723?src=pr&el=desc": 2,
            "https://codecov.io/gh/pyca/pyopenssl/pull/723?src=pr&el=tree#diff-dGVzdHMvdGVzdF9zc2wucHk=": 2,
            "https://codecov.io/gh/pyca/pyopenssl/pull/723?src=pr&el=tree#diff-c3JjL09wZW5TU0wvU1NMLnB5": 2,
            "https://codecov.io/gh/pyca/pyopenssl/pull/723?src=pr&el=tree#diff-c3JjL09wZW5TU0wvY3J5cHRvLnB5": 2,
            "https://codecov.io/gh/pyca/pyopenssl/pull/723?src=pr&el=continue": 2,
            "https://docs.codecov.io/docs/codecov-delta": 2,
            "https://codecov.io/gh/pyca/pyopenssl/pull/723?src=pr&el=footer": 2,
            "https://codecov.io/gh/pyca/pyopenssl/pull/723?src=pr&el=lastupdated": 2,
            "https://docs.codecov.io/docs/pull-request-comments": 2,
            "https://access.redhat.com/management/": 2,
            "https://access.redhat.com/": 2,
            "https://access.redhat.com/products/red-hat-enterprise-linux/": 2,
            "https://access.redhat.com/products/red-hat-openshift-container-platform": 2,
            "https://access.redhat.com/products/red-hat-ansible-automation-platform/": 2,
            "https://access.redhat.com/products/": 2,
            "https://access.redhat.com/documentation": 2,
            "https://access.redhat.com/product-life-cycles/": 2,
            "https://access.redhat.com/security": 2,
            "https://access.redhat.com/security/security-updates/#/security-advisories": 2,
            "https://access.redhat.com/security/security-updates/#/cve": 2,
            "https://access.redhat.com/support/contact/": 2,
            "https://status.redhat.com": 2,
            "https://github.com/features/actions": 1,
            "https://github.com/features/packages": 1,
            "https://github.com/features/security": 1,
            "https://github.com/features/codespaces": 1,
            "https://github.com/features/copilot": 1,
            "https://github.com/features/code-review": 1,
            "https://github.com/features/issues": 1,
            "https://github.com/features/discussions": 1,
            "https://github.com/features": 1,
            "https://docs.github.com": 1,
            "https://skills.github.com": 1,
            "https://github.blog": 1,
            "https://github.com/enterprise": 1,
            "https://github.com/team": 1,
            "https://github.com/enterprise/startups": 1,
            "https://github.com/solutions/industries/healthcare": 1,
            "https://github.com/solutions/industries/financial-services": 1,
            "https://github.com/solutions/industries/manufacturing": 1,
            "https://github.com/solutions/ci-cd": 1,
            "https://github.com/solutions/devops": 1,
            "https://github.com/solutions/devsecops": 1,
            "https://resources.github.com/learn/pathways": 1,
            "https://resources.github.com": 1,
            "https://github.com/customer-stories": 1,
            "https://partner.github.com": 1,
            "https://github.com/readme": 1,
            "https://github.com/topics": 1,
            "https://github.com/trending": 1,
            "https://github.com/collections": 1,
            "https://github.com/enterprise/advanced-security": 1,
            "https://github.com/pricing": 1,
            "https://docs.github.com/terms": 1,
            "https://docs.github.com/privacy": 1,
            "https://github.co/hiddenchars": 1,
            "https://github.com/pyca/cryptography/pull/4028": 1,
            "https://codecov.io/gh/pyca/pyopenssl/pull/723?src=pr&el=tree#diff-dGVzdHMvdGVzdF9jcnlwdG8ucHk=": 1,
            "https://github.com/pyca/pyopenssl/issues/722": 1,
            "https://github.com/pyca/pyopenssl/pull/723#event-1365572079": 1,
            "https://github.com/fusionapp/fusion-index/pull/170": 1,
            "https://github.com/fusionapp/entropy/pull/163": 1,
            "https://github.com/fusionapp/documint/pull/121": 1,
            "https://github.com": 1,
            "https://docs.github.com/site-policy/github-terms/github-terms-of-service": 1,
            "https://docs.github.com/site-policy/privacy-policies/github-privacy-statement": 1,
            "https://github.com/security": 1,
            "https://www.githubstatus.com/": 1,
            "https://docs.github.com/": 1,
            "https://support.github.com?tags=dotcom-footer": 1,
            "https://access.redhat.com/downloads/content/package-browser": 1,
            "https://catalog.redhat.com/software/containers/explore/": 1,
            "https://access.redhat.com/articles/1202803": 1,
            "https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution": 1,
            "https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article": 1,
            "https://access.redhat.com/documentation/en/red_hat_enterprise_linux": 1,
            "https://access.redhat.com/documentation/en/openshift_container_platform": 1,
            "https://access.redhat.com/documentation/en/red_hat_ansible_automation_platform": 1,
            "https://access.redhat.com/documentation/": 1,
            "https://access.redhat.com/security/": 1,
            "https://access.redhat.com/security/vulnerabilities": 1,
            "https://access.redhat.com/security/data": 1,
            "https://access.redhat.com/security/security-updates/#/security-labs": 1,
            "https://access.redhat.com/security/updates/backporting/": 1,
            "https://access.redhat.com/support/cases/": 1,
            "https://access.redhat.com/support/cases/#/troubleshoot": 1,
            "https://access.redhat.com/community": 1,
            "https://access.redhat.com/community/": 1,
            "https://access.redhat.com/discussions/": 1,
            "https://access.redhat.com/announcements/": 1,
            "https://access.redhat.com/accelerators/": 1,
            "https://access.redhat.com/jbossnetwork/restricted/listSoftware.html": 1,
            "https://cloud.redhat.com/insights": 1,
            "https://access.redhat.com/changeLanguage?language=en": 1,
            "https://access.redhat.com/changeLanguage?language=fr": 1,
            "https://access.redhat.com/changeLanguage?language=ko": 1,
            "https://access.redhat.com/changeLanguage?language=ja": 1,
            "https://access.redhat.com/changeLanguage?language=zh_CN": 1,
            "https://access.redhat.com/products/red-hat-satellite/": 1,
            "https://access.redhat.com/products/red-hat-subscription-management/": 1,
            "https://access.redhat.com/products/red-hat-insights/": 1,
            "https://access.redhat.com/products/red-hat-openstack-platform/": 1,
            "https://access.redhat.com/products/red-hat-openshift-container-platform/": 1,
            "https://access.redhat.com/products/red-hat-openshift-ai/": 1,
            "https://access.redhat.com/products/openshift-dedicated-red-hat/": 1,
            "https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/": 1,
            "https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/": 1,
            "https://access.redhat.com/products/red-hat-quay/": 1,
            "https://access.redhat.com/products/red-hat-openshift-dev-spaces": 1,
            "https://access.redhat.com/products/red-hat-openshift-service-aws": 1,
            "https://access.redhat.com/products/red-hat-storage/": 1,
            "https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/": 1,
            "https://access.redhat.com/products/red-hat-ceph-storage/": 1,
            "https://access.redhat.com/products/red-hat-openshift-data-foundation": 1,
            "https://access.redhat.com/products/red-hat-runtimes/": 1,
            "https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/": 1,
            "https://access.redhat.com/products/red-hat-data-grid/": 1,
            "https://access.redhat.com/products/red-hat-jboss-web-server/": 1,
            "https://access.redhat.com/products/red-hat-build-of-keycloak/": 1,
            "https://access.redhat.com/products/spring-boot/": 1,
            "https://access.redhat.com/products/nodejs/": 1,
            "https://access.redhat.com/products/quarkus/": 1,
            "https://access.redhat.com/products/red-hat-application-foundations/": 1,
            "https://access.redhat.com/products/red-hat-fuse/": 1,
            "https://access.redhat.com/products/red-hat-amq/": 1,
            "https://access.redhat.com/products/red-hat-3scale/": 1,
            "https://console.redhat.com/insights/patch/advisories/RHSA-2019:0085": 1,
            "https://access.redhat.com/articles/11258": 1,
            "https://bugzilla.redhat.com/show_bug.cgi?id=1640216": 1,
            "https://bugzilla.redhat.com/show_bug.cgi?id=1640217": 1,
            "https://bugzilla.redhat.com/show_bug.cgi?id=1642296": 1,
            "https://www.redhat.com/security/data/cve/CVE-2018-1000807.html": 1,
            "https://www.redhat.com/security/data/cve/CVE-2018-1000808.html": 1,
            "https://access.redhat.com/security/updates/classification/#moderate": 1,
            "https://access.redhat.com/security/team/contact/": 1,
            "https://redhat.com/en": 1,
            "https://twitter.com/RedHat": 1,
            "https://access.redhat.com/management": 1,
            "https://access.redhat.com/support": 1,
            "https://access.redhat.com/support/customer-service": 1,
            "https://access.redhat.com/articles/33844": 1,
            "https://access.redhat.com/help/login_assistance": 1,
            "https://www.redhat.com/en/trust": 1,
            "https://www.redhat.com/en/about/browser-support": 1,
            "https://www.redhat.com/en/about/digital-accessibility": 1,
            "https://access.redhat.com/recognition/": 1,
            "https://access.redhat.com/help/colophon/": 1,
            "https://www.redhat.com/": 1,
            "http://developers.redhat.com/": 1,
            "https://connect.redhat.com/": 1,
            "https://cloud.redhat.com/": 1,
            "https://access.redhat.com/subscription-value": 1,
            "https://www.redhat.com/about/": 1,
            "http://jobs.redhat.com": 1,
            "https://redhat.com/en/about/company": 1,
            "https://redhat.com/en/jobs": 1,
            "https://redhat.com/en/events": 1,
            "https://redhat.com/en/about/office-locations": 1,
            "https://redhat.com/en/contact": 1,
            "https://redhat.com/en/blog": 1,
            "https://redhat.com/en/about/our-culture/diversity-equity-inclusion": 1,
            "https://coolstuff.redhat.com/": 1,
            "https://www.redhat.com/en/summit": 1,
            "https://redhat.com/en/about/privacy-policy": 1,
            "https://redhat.com/en/about/terms-use": 1,
            "https://redhat.com/en/about/all-policies-guidelines": 1,
            "https://redhat.com/en/about/digital-accessibility": 1,
            "https://www.suse.com/security/cve/CVE-2018-1000807.html": 1,
            "https://www.suse.com/security/cve/CVE-2018-1000808.html": 1,
            "https://bugzilla.suse.com/1021578": 1,
            "https://bugzilla.suse.com/1052927": 1,
            "https://bugzilla.suse.com/1111634": 1,
            "https://bugzilla.suse.com/1111635": 1,
            "https://bugzilla.suse.com/1119077": 1,
            "http://hyperkitty.readthedocs.org": 1
        },
        "affected_products": [
            "Cryptographic",
            "Denial",
            "Python",
            "Authority",
            "PKCS",
            "CWE",
            "Reference",
            "n/a",
            "TLS"
        ],
        "versions": {
            "status": "affected",
            "version": "n/a"
        },
        "files": [
            "CWE",
            "PKCS",
            "TLS"
        ],
        "keywords": [
            "connection",
            "cause",
            "pyopenssl",
            "result",
            "attack",
            "certificate",
            "reload",
            "service",
            "calling",
            "depend",
            "release",
            "store",
            "reference",
            "call",
            "failure",
            "vulnerability",
            "appear",
            "authority",
            "contain",
            "memory",
            "pkcs",
            "cryptographic",
            "remove",
            "application",
            "initiate",
            "python",
            "denial",
            "version"
        ],
        "files_extension": [],
        "has_fixing_commit": true
    },
    "commits": [
        {
            "commit_id": "e73818600065821d588af475b024f4eb518c3509",
            "repository": "https://github.com/pyca/pyopenssl",
            "timestamp": 1512046525,
            "hunks": 6,
            "message": "fix a memory leak and a potential UAF and also #722 (#723) * fix a memory leak and a potential UAF and also #722 * sanity check * bump cryptography minimum version, add changelog",
            "diff": [
                "diff --git a/setup.py b/setup.py",
                "index 937d556..85252e9 100755",
                "--- a/setup.py",
                "+++ b/setup.py",
                "@@ -97,3 +97,3 @@ if __name__ == \"__main__\":",
                "             # Fix cryptographyMinimum in tox.ini when changing this!",
                "-            \"cryptography>=1.9\",",
                "+            \"cryptography>=2.1.4\",",
                "             \"six>=1.5.2\"",
                "diff --git a/src/OpenSSL/SSL.py b/src/OpenSSL/SSL.py",
                "index 32c038a..ec33814 100644",
                "--- a/src/OpenSSL/SSL.py",
                "+++ b/src/OpenSSL/SSL.py",
                "@@ -311,4 +311,5 @@ class _VerifyHelper(_CallbackExceptionHelper):",
                "         def wrapper(ok, store_ctx):",
                "-            cert = X509.__new__(X509)",
                "-            cert._x509 = _lib.X509_STORE_CTX_get_current_cert(store_ctx)",
                "+            x509 = _lib.X509_STORE_CTX_get_current_cert(store_ctx)",
                "+            _lib.X509_up_ref(x509)",
                "+            cert = X509._from_raw_x509_ptr(x509)",
                "             error_number = _lib.X509_STORE_CTX_get_error(store_ctx)",
                "diff --git a/src/OpenSSL/crypto.py b/src/OpenSSL/crypto.py",
                "index ecd055e..12b4db0 100644",
                "--- a/src/OpenSSL/crypto.py",
                "+++ b/src/OpenSSL/crypto.py",
                "@@ -3060,4 +3060,3 @@ def load_pkcs12(buffer, passphrase=None):",
                "     else:",
                "-        pycert = X509.__new__(X509)",
                "-        pycert._x509 = _ffi.gc(cert[0], _lib.X509_free)",
                "+        pycert = X509._from_raw_x509_ptr(cert[0])",
                "@@ -3075,4 +3074,4 @@ def load_pkcs12(buffer, passphrase=None):",
                "     for i in range(_lib.sk_X509_num(cacerts)):",
                "-        pycacert = X509.__new__(X509)",
                "-        pycacert._x509 = _lib.sk_X509_value(cacerts, i)",
                "+        x509 = _lib.sk_X509_value(cacerts, i)",
                "+        pycacert = X509._from_raw_x509_ptr(x509)",
                "         pycacerts.append(pycacert)",
                "diff --git a/tests/test_ssl.py b/tests/test_ssl.py",
                "index 03f9abd..76d8c4d 100644",
                "--- a/tests/test_ssl.py",
                "+++ b/tests/test_ssl.py",
                "@@ -1281,2 +1281,27 @@ class TestContext(object):",
                "+    def test_x509_in_verify_works(self):",
                "+        \"\"\"",
                "+        We had a bug where the X509 cert instantiated in the callback wrapper",
                "+        didn't __init__ so it was missing objects needed when calling",
                "+        get_subject. This test sets up a handshake where we call get_subject",
                "+        on the cert provided to the verify callback.",
                "+        \"\"\"",
                "+        serverContext = Context(TLSv1_METHOD)",
                "+        serverContext.use_privatekey(",
                "+            load_privatekey(FILETYPE_PEM, cleartextPrivateKeyPEM))",
                "+        serverContext.use_certificate(",
                "+            load_certificate(FILETYPE_PEM, cleartextCertificatePEM))",
                "+        serverConnection = Connection(serverContext, None)",
                "+",
                "+        def verify_cb_get_subject(conn, cert, errnum, depth, ok):",
                "+            assert cert.get_subject()",
                "+            return 1",
                "+",
                "+        clientContext = Context(TLSv1_METHOD)",
                "+        clientContext.set_verify(VERIFY_PEER, verify_cb_get_subject)",
                "+        clientConnection = Connection(clientContext, None)",
                "+        clientConnection.set_connect_state()",
                "+",
                "+        handshake_in_memory(clientConnection, serverConnection)",
                "+",
                "     def test_set_verify_callback_exception(self):",
                "diff --git a/tox.ini b/tox.ini",
                "index a16e690..bcb2f48 100644",
                "--- a/tox.ini",
                "+++ b/tox.ini",
                "@@ -12,3 +12,3 @@ deps =",
                "     cryptographyMaster: git+https://github.com/pyca/cryptography.git",
                "-    cryptographyMinimum: cryptography<=1.9",
                "+    cryptographyMinimum: cryptography==2.1.4",
                " setenv ="
            ],
            "changed_files": [
                "setup.py",
                "src/OpenSSL/SSL.py",
                "src/OpenSSL/crypto.py",
                "tests/test_ssl.py",
                "tox.ini"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "722": "add X509_up_ref pyca/cryptography#4028 exceptions.AttributeError: 'X509' object has no attribute '_subject_invalidator' #724",
                "723": "exceptions.AttributeError: 'X509' object has no attribute '_subject_invalidator' #724 Whitelist pyOpenSSL 0.13.1 for IDs 36533/36534. pyupio/safety-db#2293"
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "17.5.0",
                "18.0.0",
                "19.0.0",
                "19.1.0",
                "20.0.0",
                "20.0.1",
                "21.0.0",
                "22.0.0",
                "22.1.0",
                "23.0.0",
                "23.1.0",
                "23.1.1",
                "23.2.0",
                "23.3.0",
                "24.0.0",
                "24.1.0"
            ],
            "matched_rules": [
                {
                    "id": "XREF_GH",
                    "message": "The commit and the advisory (including referenced pages) mention the same github issue: 722, 723",
                    "relevance": 32
                },
                {
                    "id": "COMMIT_IN_REFERENCE",
                    "message": "This commit is mentioned 3 times in the references.",
                    "relevance": 64
                },
                {
                    "id": "CHANGES_RELEVANT_CODE",
                    "message": "The commit modifies code containing relevant filename or methods: TLS",
                    "relevance": 8
                },
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: memory, version",
                    "relevance": 4
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 722, 723",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "acbd662b62a2de0e7102d560f7e73d7feaf9e600",
            "repository": "https://github.com/pyca/pyopenssl",
            "timestamp": 1511187918,
            "hunks": 2,
            "message": "restore a subset of the rand module (#708) * restore a subset of the rand module * flake * remove cleanup, go ahead and assume status will always be 1 * lighten and add power",
            "diff": [
                "diff --git a/src/OpenSSL/rand.py b/src/OpenSSL/rand.py",
                "new file mode 100644",
                "index 0000000..d2c1767",
                "--- /dev/null",
                "+++ b/src/OpenSSL/rand.py",
                "@@ -0,0 +1,40 @@",
                "+\"\"\"",
                "+PRNG management routines, thin wrappers.",
                "+\"\"\"",
                "+",
                "+from OpenSSL._util import lib as _lib",
                "+",
                "+",
                "+def add(buffer, entropy):",
                "+    \"\"\"",
                "+    Mix bytes from *string* into the PRNG state.",
                "+",
                "+    The *entropy* argument is (the lower bound of) an estimate of how much",
                "+    randomness is contained in *string*, measured in bytes.",
                "+",
                "+    For more information, see e.g. :rfc:`1750`.",
                "+",
                "+    This function is only relevant if you are forking Python processes and",
                "+    need to reseed the CSPRNG after fork.",
                "+",
                "+    :param buffer: Buffer with random data.",
                "+    :param entropy: The entropy (in bytes) measurement of the buffer.",
                "+",
                "+    :return: :obj:`None`",
                "+    \"\"\"",
                "+    if not isinstance(buffer, bytes):",
                "+        raise TypeError(\"buffer must be a byte string\")",
                "+",
                "+    if not isinstance(entropy, int):",
                "+        raise TypeError(\"entropy must be an integer\")",
                "+",
                "+    _lib.RAND_add(buffer, len(buffer), entropy)",
                "+",
                "+",
                "+def status():",
                "+    \"\"\"",
                "+    Check whether the PRNG has been seeded with enough data.",
                "+",
                "+    :return: 1 if the PRNG is seeded enough, 0 otherwise.",
                "+    \"\"\"",
                "+    return _lib.RAND_status()",
                "diff --git a/tests/test_rand.py b/tests/test_rand.py",
                "new file mode 100644",
                "index 0000000..e04a24c",
                "--- /dev/null",
                "+++ b/tests/test_rand.py",
                "@@ -0,0 +1,38 @@",
                "+# Copyright (c) Frederick Dean",
                "+# See LICENSE for details.",
                "+",
                "+\"\"\"",
                "+Unit tests for `OpenSSL.rand`.",
                "+\"\"\"",
                "+",
                "+import pytest",
                "+",
                "+from OpenSSL import rand",
                "+",
                "+",
                "+class TestRand(object):",
                "+",
                "+    @pytest.mark.parametrize('args', [",
                "+        (b\"foo\", None),",
                "+        (None, 3),",
                "+    ])",
                "+    def test_add_wrong_args(self, args):",
                "+        \"\"\"",
                "+        `OpenSSL.rand.add` raises `TypeError` if called with arguments not of",
                "+        type `str` and `int`.",
                "+        \"\"\"",
                "+        with pytest.raises(TypeError):",
                "+            rand.add(*args)",
                "+",
                "+    def test_add(self):",
                "+        \"\"\"",
                "+        `OpenSSL.rand.add` adds entropy to the PRNG.",
                "+        \"\"\"",
                "+        rand.add(b'hamburger', 3)",
                "+",
                "+    def test_status(self):",
                "+        \"\"\"",
                "+        `OpenSSL.rand.status` returns `1` if the PRNG has sufficient entropy,",
                "+        `0` otherwise.",
                "+        \"\"\"",
                "+        assert rand.status() == 1"
            ],
            "changed_files": [
                "src/OpenSSL/rand.py",
                "tests/test_rand.py"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "708": "Security Implications of #675 (Delete rand.py) #706"
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "17.4.0",
                "17.5.0",
                "18.0.0",
                "19.0.0",
                "19.1.0",
                "20.0.0",
                "20.0.1",
                "21.0.0",
                "22.0.0",
                "22.1.0",
                "23.0.0",
                "23.1.0",
                "23.1.1",
                "23.2.0",
                "23.3.0",
                "24.0.0",
                "24.1.0"
            ],
            "matched_rules": [
                {
                    "id": "SEC_KEYWORDS_IN_LINKED_GH",
                    "message": "The github issue 708 contains some security-related terms: security",
                    "relevance": 4
                },
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: remove, store",
                    "relevance": 4
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 708",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "736c62111550972d835e33a3084c3bfc37bb61f7",
            "repository": "https://github.com/pyca/pyopenssl",
            "timestamp": 1511703628,
            "hunks": 2,
            "message": "define __all__ to make wildcard import work (#719)",
            "diff": [
                "diff --git a/src/OpenSSL/SSL.py b/src/OpenSSL/SSL.py",
                "index 39b7bdc..32c038a 100644",
                "--- a/src/OpenSSL/SSL.py",
                "+++ b/src/OpenSSL/SSL.py",
                "@@ -29,2 +29,91 @@ from OpenSSL.crypto import (",
                "+__all__ = [",
                "+    'OPENSSL_VERSION_NUMBER',",
                "+    'SSLEAY_VERSION',",
                "+    'SSLEAY_CFLAGS',",
                "+    'SSLEAY_PLATFORM',",
                "+    'SSLEAY_DIR',",
                "+    'SSLEAY_BUILT_ON',",
                "+    'SENT_SHUTDOWN',",
                "+    'RECEIVED_SHUTDOWN',",
                "+    'SSLv2_METHOD',",
                "+    'SSLv3_METHOD',",
                "+    'SSLv23_METHOD',",
                "+    'TLSv1_METHOD',",
                "+    'TLSv1_1_METHOD',",
                "+    'TLSv1_2_METHOD',",
                "+    'OP_NO_SSLv2',",
                "+    'OP_NO_SSLv3',",
                "+    'OP_NO_TLSv1',",
                "+    'OP_NO_TLSv1_1',",
                "+    'OP_NO_TLSv1_2',",
                "+    'MODE_RELEASE_BUFFERS',",
                "+    'OP_SINGLE_DH_USE',",
                "+    'OP_SINGLE_ECDH_USE',",
                "+    'OP_EPHEMERAL_RSA',",
                "+    'OP_MICROSOFT_SESS_ID_BUG',",
                "+    'OP_NETSCAPE_CHALLENGE_BUG',",
                "+    'OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG',",
                "+    'OP_SSLREF2_REUSE_CERT_TYPE_BUG',",
                "+    'OP_MICROSOFT_BIG_SSLV3_BUFFER',",
                "+    'OP_MSIE_SSLV2_RSA_PADDING',",
                "+    'OP_SSLEAY_080_CLIENT_DH_BUG',",
                "+    'OP_TLS_D5_BUG',",
                "+    'OP_TLS_BLOCK_PADDING_BUG',",
                "+    'OP_DONT_INSERT_EMPTY_FRAGMENTS',",
                "+    'OP_CIPHER_SERVER_PREFERENCE',",
                "+    'OP_TLS_ROLLBACK_BUG',",
                "+    'OP_PKCS1_CHECK_1',",
                "+    'OP_PKCS1_CHECK_2',",
                "+    'OP_NETSCAPE_CA_DN_BUG',",
                "+    'OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG',",
                "+    'OP_NO_COMPRESSION',",
                "+    'OP_NO_QUERY_MTU',",
                "+    'OP_COOKIE_EXCHANGE',",
                "+    'OP_NO_TICKET',",
                "+    'OP_ALL',",
                "+    'VERIFY_PEER',",
                "+    'VERIFY_FAIL_IF_NO_PEER_CERT',",
                "+    'VERIFY_CLIENT_ONCE',",
                "+    'VERIFY_NONE',",
                "+    'SESS_CACHE_OFF',",
                "+    'SESS_CACHE_CLIENT',",
                "+    'SESS_CACHE_SERVER',",
                "+    'SESS_CACHE_BOTH',",
                "+    'SESS_CACHE_NO_AUTO_CLEAR',",
                "+    'SESS_CACHE_NO_INTERNAL_LOOKUP',",
                "+    'SESS_CACHE_NO_INTERNAL_STORE',",
                "+    'SESS_CACHE_NO_INTERNAL',",
                "+    'SSL_ST_CONNECT',",
                "+    'SSL_ST_ACCEPT',",
                "+    'SSL_ST_MASK',",
                "+    'SSL_ST_INIT',",
                "+    'SSL_ST_BEFORE',",
                "+    'SSL_ST_OK',",
                "+    'SSL_ST_RENEGOTIATE',",
                "+    'SSL_CB_LOOP',",
                "+    'SSL_CB_EXIT',",
                "+    'SSL_CB_READ',",
                "+    'SSL_CB_WRITE',",
                "+    'SSL_CB_ALERT',",
                "+    'SSL_CB_READ_ALERT',",
                "+    'SSL_CB_WRITE_ALERT',",
                "+    'SSL_CB_ACCEPT_LOOP',",
                "+    'SSL_CB_ACCEPT_EXIT',",
                "+    'SSL_CB_CONNECT_LOOP',",
                "+    'SSL_CB_CONNECT_EXIT',",
                "+    'SSL_CB_HANDSHAKE_START',",
                "+    'SSL_CB_HANDSHAKE_DONE',",
                "+    'Error',",
                "+    'WantReadError',",
                "+    'WantWriteError',",
                "+    'WantX509LookupError',",
                "+    'ZeroReturnError',",
                "+    'SysCallError',",
                "+    'SSLeay_version',",
                "+    'Session',",
                "+    'Context',",
                "+    'Connection'",
                "+]",
                "+",
                " try:",
                "diff --git a/src/OpenSSL/crypto.py b/src/OpenSSL/crypto.py",
                "index ee422cb..ecd055e 100644",
                "--- a/src/OpenSSL/crypto.py",
                "+++ b/src/OpenSSL/crypto.py",
                "@@ -26,2 +26,41 @@ from OpenSSL._util import (",
                "+__all__ = [",
                "+    'FILETYPE_PEM',",
                "+    'FILETYPE_ASN1',",
                "+    'FILETYPE_TEXT',",
                "+    'TYPE_RSA',",
                "+    'TYPE_DSA',",
                "+    'Error',",
                "+    'PKey',",
                "+    'get_elliptic_curves',",
                "+    'get_elliptic_curve',",
                "+    'X509Name',",
                "+    'X509Extension',",
                "+    'X509Req',",
                "+    'X509',",
                "+    'X509StoreFlags',",
                "+    'X509Store',",
                "+    'X509StoreContextError',",
                "+    'X509StoreContext',",
                "+    'load_certificate',",
                "+    'dump_certificate',",
                "+    'dump_publickey',",
                "+    'dump_privatekey',",
                "+    'Revoked',",
                "+    'CRL',",
                "+    'PKCS7',",
                "+    'PKCS12',",
                "+    'NetscapeSPKI',",
                "+    'load_publickey',",
                "+    'load_privatekey',",
                "+    'dump_certificate_request',",
                "+    'load_certificate_request',",
                "+    'sign',",
                "+    'verify',",
                "+    'dump_crl',",
                "+    'load_crl',",
                "+    'load_pkcs7_data',",
                "+    'load_pkcs12'",
                "+]",
                "+",
                " FILETYPE_PEM = _lib.SSL_FILETYPE_PEM"
            ],
            "changed_files": [
                "src/OpenSSL/SSL.py",
                "src/OpenSSL/crypto.py"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "719": "PKey not imported with from [\u2026] import * #715"
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "17.5.0",
                "18.0.0",
                "19.0.0",
                "19.1.0",
                "20.0.0",
                "20.0.1",
                "21.0.0",
                "22.0.0",
                "22.1.0",
                "23.0.0",
                "23.1.0",
                "23.1.1",
                "23.2.0",
                "23.3.0",
                "24.0.0",
                "24.1.0"
            ],
            "matched_rules": [
                {
                    "id": "CHANGES_RELEVANT_CODE",
                    "message": "The commit modifies code containing relevant filename or methods: PKCS, TLS",
                    "relevance": 8
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 719",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "d21fcd810317aa7579af0c194a61af377ade7f0e",
            "repository": "https://github.com/pyca/pyopenssl",
            "timestamp": 1512094430,
            "hunks": 1,
            "message": "17.5.0 version bump (#726)",
            "diff": [
                "diff --git a/src/OpenSSL/version.py b/src/OpenSSL/version.py",
                "index f328cef..ff6f217 100644",
                "--- a/src/OpenSSL/version.py",
                "+++ b/src/OpenSSL/version.py",
                "@@ -13,3 +13,3 @@ __all__ = [",
                "-__version__ = \"17.5.0.dev0\"",
                "+__version__ = \"17.5.0\""
            ],
            "changed_files": [
                "src/OpenSSL/version.py"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "726": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "17.5.0",
                "18.0.0",
                "19.0.0",
                "19.1.0",
                "20.0.0",
                "20.0.1",
                "21.0.0",
                "22.0.0",
                "22.1.0",
                "23.0.0",
                "23.1.0",
                "23.1.1",
                "23.2.0",
                "23.3.0",
                "24.0.0",
                "24.1.0"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: version",
                    "relevance": 4
                },
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: version",
                    "relevance": 4
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 726",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "bdb7639ad53427fae38695d2dc5bf5bd794787c8",
            "repository": "https://github.com/pyca/pyopenssl",
            "timestamp": 1512075272,
            "hunks": 2,
            "message": "Export keying material support (#725) * added method to export keying material from an ssl connection * updated tests to use bytestrings to avoid breaking python3 tests * added additional comments to test * simplify export_keying_material * add changelog * address review feedback",
            "diff": [
                "diff --git a/src/OpenSSL/SSL.py b/src/OpenSSL/SSL.py",
                "index ec33814..b664254 100644",
                "--- a/src/OpenSSL/SSL.py",
                "+++ b/src/OpenSSL/SSL.py",
                "@@ -2033,2 +2033,26 @@ class Connection(object):",
                "+    def export_keying_material(self, label, olen, context=None):",
                "+        \"\"\"",
                "+        Obtain keying material for application use.",
                "+",
                "+        :param label - a disambiguating label string as described in RFC 5705",
                "+        :param olen - the length of the exported key material in bytes",
                "+        :param context - a per-association context value",
                "+        :return the exported key material bytes or None",
                "+        \"\"\"",
                "+        outp = _no_zero_allocator(\"unsigned char[]\", olen)",
                "+        context_buf = _ffi.NULL",
                "+        context_len = 0",
                "+        use_context = 0",
                "+        if context is not None:",
                "+            context_buf = context",
                "+            context_len = len(context)",
                "+            use_context = 1",
                "+        success = _lib.SSL_export_keying_material(self._ssl, outp, olen,",
                "+                                                  label, len(label),",
                "+                                                  context_buf, context_len,",
                "+                                                  use_context)",
                "+        _openssl_assert(success == 1)",
                "+        return _ffi.buffer(outp, olen)[:]",
                "+",
                "     def sock_shutdown(self, *args, **kwargs):",
                "diff --git a/tests/test_ssl.py b/tests/test_ssl.py",
                "index 76d8c4d..03dd935 100644",
                "--- a/tests/test_ssl.py",
                "+++ b/tests/test_ssl.py",
                "@@ -3381,2 +3381,24 @@ class TestMemoryBIO(object):",
                "+        # Export key material for other uses.",
                "+        cekm = client_conn.export_keying_material(b'LABEL', 32)",
                "+        sekm = server_conn.export_keying_material(b'LABEL', 32)",
                "+        assert cekm is not None",
                "+        assert sekm is not None",
                "+        assert cekm == sekm",
                "+        assert len(sekm) == 32",
                "+",
                "+        # Export key material for other uses with additional context.",
                "+        cekmc = client_conn.export_keying_material(b'LABEL', 32, b'CONTEXT')",
                "+        sekmc = server_conn.export_keying_material(b'LABEL', 32, b'CONTEXT')",
                "+        assert cekmc is not None",
                "+        assert sekmc is not None",
                "+        assert cekmc == sekmc",
                "+        assert cekmc != cekm",
                "+        assert sekmc != sekm",
                "+        # Export with alternate label",
                "+        cekmt = client_conn.export_keying_material(b'test', 32, b'CONTEXT')",
                "+        sekmt = server_conn.export_keying_material(b'test', 32, b'CONTEXT')",
                "+        assert cekmc != cekmt",
                "+        assert sekmc != sekmt",
                "+",
                "         # Here are the bytes we'll try to send."
            ],
            "changed_files": [
                "src/OpenSSL/SSL.py",
                "tests/test_ssl.py"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "725": "added method to export keying material from an ssl connection #686"
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "17.5.0",
                "18.0.0",
                "19.0.0",
                "19.1.0",
                "20.0.0",
                "20.0.1",
                "21.0.0",
                "22.0.0",
                "22.1.0",
                "23.0.0",
                "23.1.0",
                "23.1.1",
                "23.2.0",
                "23.3.0",
                "24.0.0",
                "24.1.0"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: connection, python",
                    "relevance": 4
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 725",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "3d231f03ed24f760d1896f5e2be3adf1cbf13127",
            "repository": "https://github.com/pyca/pyopenssl",
            "timestamp": 1512131466,
            "hunks": 1,
            "message": "open for 17.6.0 (#727)",
            "diff": [
                "diff --git a/src/OpenSSL/version.py b/src/OpenSSL/version.py",
                "index ff6f217..0b508b0 100644",
                "--- a/src/OpenSSL/version.py",
                "+++ b/src/OpenSSL/version.py",
                "@@ -13,3 +13,3 @@ __all__ = [",
                "-__version__ = \"17.5.0\"",
                "+__version__ = \"17.6.0.dev0\""
            ],
            "changed_files": [
                "src/OpenSSL/version.py"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "727": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "18.0.0",
                "19.0.0",
                "19.1.0",
                "20.0.0",
                "20.0.1",
                "21.0.0",
                "22.0.0",
                "22.1.0",
                "23.0.0",
                "23.1.0",
                "23.1.1",
                "23.2.0",
                "23.3.0",
                "24.0.0",
                "24.1.0"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: version",
                    "relevance": 4
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 727",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "5a3fb407b3d7b2f2dcc144055ee707614ead1817",
            "repository": "https://github.com/pyca/pyopenssl",
            "timestamp": 1511288414,
            "hunks": 1,
            "message": "bump to 17.4.0 (#714)",
            "diff": [
                "diff --git a/src/OpenSSL/version.py b/src/OpenSSL/version.py",
                "index 9a2f9d8..4ac2945 100644",
                "--- a/src/OpenSSL/version.py",
                "+++ b/src/OpenSSL/version.py",
                "@@ -13,3 +13,3 @@ __all__ = [",
                "-__version__ = \"17.4.0.dev0\"",
                "+__version__ = \"17.4.0\""
            ],
            "changed_files": [
                "src/OpenSSL/version.py"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "714": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "17.4.0",
                "17.5.0",
                "18.0.0",
                "19.0.0",
                "19.1.0",
                "20.0.0",
                "20.0.1",
                "21.0.0",
                "22.0.0",
                "22.1.0",
                "23.0.0",
                "23.1.0",
                "23.1.1",
                "23.2.0",
                "23.3.0",
                "24.0.0",
                "24.1.0"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: version",
                    "relevance": 4
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 714",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "57051a53e154c2b401ab84d6f01c6512e6c7b346",
            "repository": "https://github.com/pyca/pyopenssl",
            "timestamp": 1511322012,
            "hunks": 1,
            "message": "reopen master (#718)",
            "diff": [
                "diff --git a/src/OpenSSL/version.py b/src/OpenSSL/version.py",
                "index 4ac2945..f328cef 100644",
                "--- a/src/OpenSSL/version.py",
                "+++ b/src/OpenSSL/version.py",
                "@@ -13,3 +13,3 @@ __all__ = [",
                "-__version__ = \"17.4.0\"",
                "+__version__ = \"17.5.0.dev0\""
            ],
            "changed_files": [
                "src/OpenSSL/version.py"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "718": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "17.5.0",
                "18.0.0",
                "19.0.0",
                "19.1.0",
                "20.0.0",
                "20.0.1",
                "21.0.0",
                "22.0.0",
                "22.1.0",
                "23.0.0",
                "23.1.0",
                "23.1.1",
                "23.2.0",
                "23.3.0",
                "24.0.0",
                "24.1.0"
            ],
            "matched_rules": [
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: version",
                    "relevance": 4
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 718",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "4aa52c33d3ee51c632e0e1e10cafb7745fd1028c",
            "repository": "https://github.com/pyca/pyopenssl",
            "timestamp": 1511186648,
            "hunks": 10,
            "message": "Don't use things after they're freed...duh (#709) * Don't use things after they're freed...duh * changelog * more details",
            "diff": [
                "diff --git a/src/OpenSSL/SSL.py b/src/OpenSSL/SSL.py",
                "index 667131b..39b7bdc 100644",
                "--- a/src/OpenSSL/SSL.py",
                "+++ b/src/OpenSSL/SSL.py",
                "@@ -1959,5 +1959,3 @@ class Connection(object):",
                "         if cert != _ffi.NULL:",
                "-            pycert = X509.__new__(X509)",
                "-            pycert._x509 = _ffi.gc(cert, _lib.X509_free)",
                "-            return pycert",
                "+            return X509._from_raw_x509_ptr(cert)",
                "         return None",
                "@@ -1979,4 +1977,3 @@ class Connection(object):",
                "             cert = _lib.X509_dup(_lib.sk_X509_value(cert_stack, i))",
                "-            pycert = X509.__new__(X509)",
                "-            pycert._x509 = _ffi.gc(cert, _lib.X509_free)",
                "+            pycert = X509._from_raw_x509_ptr(cert)",
                "             result.append(pycert)",
                "diff --git a/src/OpenSSL/crypto.py b/src/OpenSSL/crypto.py",
                "index 72c04b0..ee422cb 100644",
                "--- a/src/OpenSSL/crypto.py",
                "+++ b/src/OpenSSL/crypto.py",
                "@@ -164,2 +164,15 @@ def _get_asn1_time(timestamp):",
                "+class _X509NameInvalidator(object):",
                "+    def __init__(self):",
                "+        self._names = []",
                "+",
                "+    def add(self, name):",
                "+        self._names.append(name)",
                "+",
                "+    def clear(self):",
                "+        for name in self._names:",
                "+            # Breaks the object, but also prevents UAF!",
                "+            del name._name",
                "+",
                "+",
                " class PKey(object):",
                "@@ -1034,2 +1047,13 @@ class X509(object):",
                "+        self._issuer_invalidator = _X509NameInvalidator()",
                "+        self._subject_invalidator = _X509NameInvalidator()",
                "+",
                "+    @classmethod",
                "+    def _from_raw_x509_ptr(cls, x509):",
                "+        cert = cls.__new__(cls)",
                "+        cert._x509 = _ffi.gc(x509, _lib.X509_free)",
                "+        cert._issuer_invalidator = _X509NameInvalidator()",
                "+        cert._subject_invalidator = _X509NameInvalidator()",
                "+        return cert",
                "+",
                "     def to_cryptography(self):",
                "@@ -1384,3 +1408,5 @@ class X509(object):",
                "         \"\"\"",
                "-        return self._get_name(_lib.X509_get_issuer_name)",
                "+        name = self._get_name(_lib.X509_get_issuer_name)",
                "+        self._issuer_invalidator.add(name)",
                "+        return name",
                "@@ -1395,3 +1421,4 @@ class X509(object):",
                "         \"\"\"",
                "-        return self._set_name(_lib.X509_set_issuer_name, issuer)",
                "+        self._set_name(_lib.X509_set_issuer_name, issuer)",
                "+        self._issuer_invalidator.clear()",
                "@@ -1409,3 +1436,5 @@ class X509(object):",
                "         \"\"\"",
                "-        return self._get_name(_lib.X509_get_subject_name)",
                "+        name = self._get_name(_lib.X509_get_subject_name)",
                "+        self._subject_invalidator.add(name)",
                "+        return name",
                "@@ -1420,3 +1449,4 @@ class X509(object):",
                "         \"\"\"",
                "-        return self._set_name(_lib.X509_set_subject_name, subject)",
                "+        self._set_name(_lib.X509_set_subject_name, subject)",
                "+        self._subject_invalidator.clear()",
                "@@ -1693,4 +1723,3 @@ class X509StoreContext(object):",
                "         _cert = _lib.X509_dup(_x509)",
                "-        pycert = X509.__new__(X509)",
                "-        pycert._x509 = _ffi.gc(_cert, _lib.X509_free)",
                "+        pycert = X509._from_raw_x509_ptr(_cert)",
                "         return X509StoreContextError(errors, pycert)",
                "@@ -1757,5 +1786,3 @@ def load_certificate(type, buffer):",
                "-    cert = X509.__new__(X509)",
                "-    cert._x509 = _ffi.gc(x509, _lib.X509_free)",
                "-    return cert",
                "+    return X509._from_raw_x509_ptr(x509)"
            ],
            "changed_files": [
                "src/OpenSSL/SSL.py",
                "src/OpenSSL/crypto.py"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "709": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "17.4.0",
                "17.5.0",
                "18.0.0",
                "19.0.0",
                "19.1.0",
                "20.0.0",
                "20.0.1",
                "21.0.0",
                "22.0.0",
                "22.1.0",
                "23.0.0",
                "23.1.0",
                "23.1.1",
                "23.2.0",
                "23.3.0",
                "24.0.0",
                "24.1.0"
            ],
            "matched_rules": [
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 709",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "c3697ad289dc011692591246e8d6d341f37da298",
            "repository": "https://github.com/pyca/pyopenssl",
            "timestamp": 1511183972,
            "hunks": 11,
            "message": "fix errors with latest flake8 (#710) * fix errors with latest flake8 * Also fix the macOS builds * fix? * allow urllib3 to fail for now",
            "diff": [
                "diff --git a/.travis.yml b/.travis.yml",
                "index d03d6f8..c76dc45 100644",
                "--- a/.travis.yml",
                "+++ b/.travis.yml",
                "@@ -90,2 +90,6 @@ matrix:",
                "   - env: TOXENV=pypy-cryptographyMaster",
                "+  # TODO: undo this once upstream fixes their tests",
                "+  - python: \"3.5\"",
                "+    env: TOXENV=py35-urllib3Master",
                "+",
                "@@ -96,3 +100,3 @@ install:",
                "       if [[ \"${OPENSSL}\" == \"1.1.0\" ]]; then",
                "-        brew install openssl@1.1",
                "+        brew upgrade openssl@1.1",
                "       else",
                "@@ -102,3 +106,3 @@ install:",
                "       python get-pip.py --user",
                "-      pip install --user virtualenv",
                "+      python -m pip install --user virtualenv",
                "     else",
                "diff --git a/examples/simple/server.py b/examples/simple/server.py",
                "index 9cce9e0..d25feb1 100644",
                "--- a/examples/simple/server.py",
                "+++ b/examples/simple/server.py",
                "@@ -75,3 +75,3 @@ while 1:",
                "         )",
                "-    except:",
                "+    except Exception:",
                "         break",
                "diff --git a/src/OpenSSL/SSL.py b/src/OpenSSL/SSL.py",
                "index 75d080a..667131b 100644",
                "--- a/src/OpenSSL/SSL.py",
                "+++ b/src/OpenSSL/SSL.py",
                "@@ -309,6 +309,6 @@ class _NpnSelectHelper(_CallbackExceptionHelper):",
                "                 while instr:",
                "-                    l = indexbytes(instr, 0)",
                "-                    proto = instr[1:l + 1]",
                "+                    length = indexbytes(instr, 0)",
                "+                    proto = instr[1:length + 1]",
                "                     protolist.append(proto)",
                "-                    instr = instr[l + 1:]",
                "+                    instr = instr[length + 1:]",
                "@@ -1082,3 +1082,3 @@ class Context(object):",
                "                     _raise_current_error()",
                "-        except:",
                "+        except Exception:",
                "             _lib.sk_X509_NAME_free(name_stack)",
                "diff --git a/tests/test_crypto.py b/tests/test_crypto.py",
                "index 22a5c88..5642120 100644",
                "--- a/tests/test_crypto.py",
                "+++ b/tests/test_crypto.py",
                "@@ -1848,3 +1848,3 @@ WpOdIpB8KksUTCzV591Nr1wd",
                "         name.C = 'AU'",
                "-        name.O = 'Unit Tests'",
                "+        name.OU = 'Unit Tests'",
                "         cert.set_subject(name)",
                "@@ -1852,3 +1852,3 @@ WpOdIpB8KksUTCzV591Nr1wd",
                "             cert.get_subject().get_components() ==",
                "-            [(b'C', b'AU'), (b'O', b'Unit Tests')])",
                "+            [(b'C', b'AU'), (b'OU', b'Unit Tests')])",
                "@@ -1884,3 +1884,3 @@ WpOdIpB8KksUTCzV591Nr1wd",
                "         name.C = 'AU'",
                "-        name.O = 'Unit Tests'",
                "+        name.OU = 'Unit Tests'",
                "         cert.set_issuer(name)",
                "@@ -1888,3 +1888,3 @@ WpOdIpB8KksUTCzV591Nr1wd",
                "             cert.get_issuer().get_components() ==",
                "-            [(b'C', b'AU'), (b'O', b'Unit Tests')])",
                "+            [(b'C', b'AU'), (b'OU', b'Unit Tests')])"
            ],
            "changed_files": [
                ".travis.yml",
                "examples/simple/server.py",
                "src/OpenSSL/SSL.py",
                "tests/test_crypto.py"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "710": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "17.4.0",
                "17.5.0",
                "18.0.0",
                "19.0.0",
                "19.1.0",
                "20.0.0",
                "20.0.1",
                "21.0.0",
                "22.0.0",
                "22.1.0",
                "23.0.0",
                "23.1.0",
                "23.1.1",
                "23.2.0",
                "23.3.0",
                "24.0.0",
                "24.1.0"
            ],
            "matched_rules": [
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 710",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "f724786613f90eb6e6ea26f4dbe17a1cda238d1e",
            "repository": "https://github.com/pyca/pyopenssl",
            "timestamp": 1511858714,
            "hunks": 1,
            "message": "Pin pytest until we drop 2.6 (#721)",
            "diff": [
                "diff --git a/setup.py b/setup.py",
                "index 13188ef..937d556 100755",
                "--- a/setup.py",
                "+++ b/setup.py",
                "@@ -104,3 +104,5 @@ if __name__ == \"__main__\":",
                "                 \"pretend\",",
                "-                \"pytest>=3.0.1\",",
                "+                # pytest 3.3 doesn't support Python 2.6 anymore.",
                "+                # Remove this pin once we drop Python 2.6 too.",
                "+                \"pytest>=3.0.1,<3.3.0\",",
                "             ],"
            ],
            "changed_files": [
                "setup.py"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "721": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "17.5.0",
                "18.0.0",
                "19.0.0",
                "19.1.0",
                "20.0.0",
                "20.0.1",
                "21.0.0",
                "22.0.0",
                "22.1.0",
                "23.0.0",
                "23.1.0",
                "23.1.1",
                "23.2.0",
                "23.3.0",
                "24.0.0",
                "24.1.0"
            ],
            "matched_rules": [
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 721",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "e61e2025237c571ee5ee8dc1735381252f5c5abf",
            "repository": "https://github.com/pyca/pyopenssl",
            "timestamp": 1511320882,
            "hunks": 1,
            "message": "Require urllib3 tests to pass; fixes #712 (#716)",
            "diff": [
                "diff --git a/.travis.yml b/.travis.yml",
                "index c76dc45..9dc734c 100644",
                "--- a/.travis.yml",
                "+++ b/.travis.yml",
                "@@ -90,5 +90,2 @@ matrix:",
                "   - env: TOXENV=pypy-cryptographyMaster",
                "-  # TODO: undo this once upstream fixes their tests",
                "-  - python: \"3.5\"",
                "-    env: TOXENV=py35-urllib3Master"
            ],
            "changed_files": [
                ".travis.yml"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "712": "",
                "716": ""
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "17.5.0",
                "18.0.0",
                "19.0.0",
                "19.1.0",
                "20.0.0",
                "20.0.1",
                "21.0.0",
                "22.0.0",
                "22.1.0",
                "23.0.0",
                "23.1.0",
                "23.1.1",
                "23.2.0",
                "23.3.0",
                "24.0.0",
                "24.1.0"
            ],
            "matched_rules": [
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 712, 716",
                    "relevance": 2
                }
            ]
        }
    ]
}
