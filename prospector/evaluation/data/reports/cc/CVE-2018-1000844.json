{
    "advisory_record": {
        "cve_id": "CVE-2018-1000844",
        "description": "Square Open Source Retrofit version Prior to commit 4a693c5aeeef2be6c7ecf80e7b5ec79f6ab59437 contains a XML External Entity (XXE) vulnerability in JAXB that can result in An attacker could use this to remotely read files from the file system or to perform SSRF.. This vulnerability appears to have been fixed in After commit 4a693c5aeeef2be6c7ecf80e7b5ec79f6ab59437.",
        "reserved_timestamp": 1541376000,
        "published_timestamp": 1664814119,
        "updated_timestamp": 1664814119,
        "repository_url": null,
        "references": {
            "": 82,
            "https://github.com/square/retrofit/pull/2735": 4,
            "https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax": 2,
            "https://www.owasp.org/index.php/XML_External_Entity_(XXE)_Prevention_Cheat_Sheet#JAXB_Unmarshaller": 2,
            "commit::4a693c5aeeef2be6c7ecf80e7b5ec79f6ab59437": 2,
            "https://github.com/features/actions": 1,
            "https://github.com/features/packages": 1,
            "https://github.com/features/security": 1,
            "https://github.com/features/codespaces": 1,
            "https://github.com/features/copilot": 1,
            "https://github.com/features/code-review": 1,
            "https://github.com/features/issues": 1,
            "https://github.com/features/discussions": 1,
            "https://github.com/features": 1,
            "https://docs.github.com": 1,
            "https://skills.github.com": 1,
            "https://github.blog": 1,
            "https://github.com/enterprise": 1,
            "https://github.com/team": 1,
            "https://github.com/enterprise/startups": 1,
            "https://github.com/solutions/industries/healthcare": 1,
            "https://github.com/solutions/industries/financial-services": 1,
            "https://github.com/solutions/industries/manufacturing": 1,
            "https://github.com/solutions/ci-cd": 1,
            "https://github.com/solutions/devops": 1,
            "https://github.com/solutions/devsecops": 1,
            "https://resources.github.com/learn/pathways": 1,
            "https://resources.github.com": 1,
            "https://github.com/customer-stories": 1,
            "https://partner.github.com": 1,
            "https://github.com/readme": 1,
            "https://github.com/topics": 1,
            "https://github.com/trending": 1,
            "https://github.com/collections": 1,
            "https://github.com/enterprise/advanced-security": 1,
            "https://github.com/pricing": 1,
            "https://docs.github.com/terms": 1,
            "https://docs.github.com/privacy": 1,
            "https://github.co/hiddenchars": 1,
            "commit::97057aaae42e54bfbee8acfa8af7dcf37e812342": 1,
            "https://github.com/square/retrofit/pull/2735#event-1579508950": 1,
            "https://github.com": 1,
            "https://docs.github.com/site-policy/github-terms/github-terms-of-service": 1,
            "https://docs.github.com/site-policy/privacy-policies/github-privacy-statement": 1,
            "https://github.com/security": 1,
            "https://www.githubstatus.com/": 1,
            "https://docs.github.com/": 1,
            "https://support.github.com?tags=dotcom-footer": 1
        },
        "affected_products": [
            "Retrofit",
            "Open",
            "Source",
            "Entity",
            "SSRF",
            "XXE",
            "External",
            "Square",
            "n/a",
            "XML"
        ],
        "versions": {
            "status": "affected",
            "version": "n/a"
        },
        "files": [
            "SSRF",
            "XXE",
            "XML",
            "JAXB"
        ],
        "keywords": [
            "retrofit",
            "result",
            "attacker",
            "file",
            "jaxb",
            "square",
            "commit",
            "entity",
            "ssrf",
            "source",
            "vulnerability",
            "appear",
            "contain",
            "external",
            "system",
            "perform",
            "read",
            "version",
            "open"
        ],
        "files_extension": [],
        "has_fixing_commit": true
    },
    "commits": [
        {
            "commit_id": "97057aaae42e54bfbee8acfa8af7dcf37e812342",
            "repository": "https://github.com/square/retrofit",
            "timestamp": 1523987954,
            "hunks": 0,
            "message": "Merge pull request #2735 from square/jwilson.0417.lock_down_jaxb Lock down JAXB. Don't load remote entities.",
            "diff": [],
            "changed_files": [],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {
                "2735": "Update retrofit, converter-gson and retrofit-mock to version 2.6.0 square/pagerduty-incidents#27 Critical security issue in com.squareup.retrofit2:retrofit:2.2.0 plivo/plivo-java#269"
            },
            "cve_refs": [],
            "twins": [],
            "tags": [
                "2.10.0",
                "2.11.0",
                "2.8.2",
                "2.9.0",
                "parent-2.5.0",
                "parent-2.6.0",
                "parent-2.6.1",
                "parent-2.6.2",
                "parent-2.6.3",
                "parent-2.6.4",
                "parent-2.7.0",
                "parent-2.7.1",
                "parent-2.7.2",
                "parent-2.8.0",
                "parent-2.8.1"
            ],
            "matched_rules": [
                {
                    "id": "XREF_GH",
                    "message": "The commit and the advisory (including referenced pages) mention the same github issue: 2735",
                    "relevance": 32
                },
                {
                    "id": "COMMIT_IN_REFERENCE",
                    "message": "This commit is mentioned 1 times in the references.",
                    "relevance": 64
                },
                {
                    "id": "SEC_KEYWORDS_IN_LINKED_GH",
                    "message": "The github issue 2735 contains some security-related terms: security",
                    "relevance": 4
                },
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: jaxb",
                    "relevance": 4
                },
                {
                    "id": "GITHUB_ISSUE_IN_MESSAGE",
                    "message": "The commit message references some github issue: 2735",
                    "relevance": 2
                }
            ]
        },
        {
            "commit_id": "4a693c5aeeef2be6c7ecf80e7b5ec79f6ab59437",
            "repository": "https://github.com/square/retrofit",
            "timestamp": 1523987719,
            "hunks": 1,
            "message": "Lock down JAXB. Don't load remote entities. XML is subject to XXE attacks. https://www.owasp.org/index.php/XML_External_Entity_(XXE)_Prevention_Cheat_Sheet#JAXB_Unmarshaller",
            "diff": [
                "diff --git a/retrofit-converters/jaxb/src/main/java/retrofit2/converter/jaxb/JaxbResponseConverter.java b/retrofit-converters/jaxb/src/main/java/retrofit2/converter/jaxb/JaxbResponseConverter.java",
                "index 1b0666b5..469b863d 100644",
                "--- a/retrofit-converters/jaxb/src/main/java/retrofit2/converter/jaxb/JaxbResponseConverter.java",
                "+++ b/retrofit-converters/jaxb/src/main/java/retrofit2/converter/jaxb/JaxbResponseConverter.java",
                "@@ -35,2 +35,6 @@ final class JaxbResponseConverter<T> implements Converter<ResponseBody, T> {",
                "     this.type = type;",
                "+",
                "+    // Prevent XML External Entity attacks (XXE).",
                "+    xmlInputFactory.setProperty(XMLInputFactory.IS_SUPPORTING_EXTERNAL_ENTITIES, false);",
                "+    xmlInputFactory.setProperty(XMLInputFactory.SUPPORT_DTD, false);",
                "   }"
            ],
            "changed_files": [
                "retrofit-converters/jaxb/src/main/java/retrofit2/converter/jaxb/JaxbResponseConverter.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "2.10.0",
                "2.11.0",
                "2.8.2",
                "2.9.0",
                "parent-2.5.0",
                "parent-2.6.0",
                "parent-2.6.1",
                "parent-2.6.2",
                "parent-2.6.3",
                "parent-2.6.4",
                "parent-2.7.0",
                "parent-2.7.1",
                "parent-2.7.2",
                "parent-2.8.0",
                "parent-2.8.1"
            ],
            "matched_rules": [
                {
                    "id": "COMMIT_IN_REFERENCE",
                    "message": "This commit is mentioned 2 times in the references.",
                    "relevance": 64
                },
                {
                    "id": "RELEVANT_WORDS_IN_MESSAGE",
                    "message": "The commit message contains some relevant words: XXE, XML",
                    "relevance": 8
                },
                {
                    "id": "CHANGES_RELEVANT_CODE",
                    "message": "The commit modifies code containing relevant filename or methods: XXE, XML",
                    "relevance": 8
                },
                {
                    "id": "CHANGES_RELEVANT_FILES",
                    "message": "The commit changes some relevant files: retrofit-converters/jaxb/src/main/java/retrofit2/converter/jaxb/JaxbResponseConverter.java",
                    "relevance": 8
                },
                {
                    "id": "SEC_KEYWORDS_IN_MESSAGE",
                    "message": "The commit message contains some security-related keywords: xxe",
                    "relevance": 4
                },
                {
                    "id": "ADV_KEYWORDS_IN_MSG",
                    "message": "The commit message and the advisory description contain the following keywords: entity, external, jaxb",
                    "relevance": 4
                },
                {
                    "id": "ADV_KEYWORDS_IN_FILES",
                    "message": "An advisory keyword is contained in the changed files: jaxb",
                    "relevance": 4
                }
            ]
        },
        {
            "commit_id": "ce787ed52be1eb881e5375aaf14100c1800e4037",
            "repository": "https://github.com/square/retrofit",
            "timestamp": 1522546073,
            "hunks": 7,
            "message": "Add support for creating failed test call instances with any exception.",
            "diff": [
                "diff --git a/retrofit-mock/src/main/java/retrofit2/mock/Calls.java b/retrofit-mock/src/main/java/retrofit2/mock/Calls.java",
                "index 42947a95..f0e9affb 100644",
                "--- a/retrofit-mock/src/main/java/retrofit2/mock/Calls.java",
                "+++ b/retrofit-mock/src/main/java/retrofit2/mock/Calls.java",
                "@@ -44,3 +44,16 @@ public final class Calls {",
                "+  /** Creates a failed {@link Call} from {@code failure}. */",
                "   public static <T> Call<T> failure(IOException failure) {",
                "+    // TODO delete this overload in Retrofit 3.0.",
                "+    return new FakeCall<>(null, failure);",
                "+  }",
                "+",
                "+  /**",
                "+   * Creates a failed {@link Call} from {@code failure}.",
                "+   * <p>",
                "+   * Note: When invoking {@link Call#execute() execute()} on the returned {@link Call}, if",
                "+   * {@code failure} is a {@link RuntimeException}, {@link Error}, or {@link IOException} subtype",
                "+   * it is thrown directly. Otherwise it is \"sneaky thrown\" despite not being declared.",
                "+   */",
                "+  public static <T> Call<T> failure(Throwable failure) {",
                "     return new FakeCall<>(null, failure);",
                "@@ -54,3 +67,3 @@ public final class Calls {",
                "     private final Response<T> response;",
                "-    private final IOException error;",
                "+    private final Throwable error;",
                "     private final AtomicBoolean canceled = new AtomicBoolean();",
                "@@ -58,3 +71,3 @@ public final class Calls {",
                "-    FakeCall(@Nullable Response<T> response, @Nullable IOException error) {",
                "+    FakeCall(@Nullable Response<T> response, @Nullable Throwable error) {",
                "       if ((response == null) == (error == null)) {",
                "@@ -76,3 +89,8 @@ public final class Calls {",
                "       }",
                "-      throw error;",
                "+      throw FakeCall.<Error>sneakyThrow2(error);",
                "+    }",
                "+",
                "+    @SuppressWarnings(\"unchecked\") // Intentionally abusing this feature.",
                "+    private static <T extends Throwable> T sneakyThrow2(Throwable t) throws T {",
                "+      throw (T) t;",
                "     }",
                "@@ -133,6 +151,4 @@ public final class Calls {",
                "           delegate = callable.call();",
                "-        } catch (IOException e) {",
                "-          delegate = failure(e);",
                "         } catch (Exception e) {",
                "-          throw new IllegalStateException(\"Callable threw unrecoverable exception\", e);",
                "+          delegate = failure(e);",
                "         }"
            ],
            "changed_files": [
                "retrofit-mock/src/main/java/retrofit2/mock/Calls.java"
            ],
            "message_reference_content": [],
            "jira_refs": {},
            "ghissue_refs": {},
            "cve_refs": [],
            "twins": [],
            "tags": [
                "2.10.0",
                "2.11.0",
                "2.8.2",
                "2.9.0",
                "parent-2.5.0",
                "parent-2.6.0",
                "parent-2.6.1",
                "parent-2.6.2",
                "parent-2.6.3",
                "parent-2.6.4",
                "parent-2.7.0",
                "parent-2.7.1",
                "parent-2.7.2",
                "parent-2.8.0",
                "parent-2.8.1"
            ],
            "matched_rules": []
        }
    ]
}
